import{_ as p,r as o,o as c,c as l,a as n,b as s,d as t,e}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"sharding-jdbc-ä½¿ç”¨æ•™ç¨‹å’Œæ¨¡å‹ç»“æ„",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#sharding-jdbc-ä½¿ç”¨æ•™ç¨‹å’Œæ¨¡å‹ç»“æ„","aria-hidden":"true"},"#"),s(" sharding-jdbc ä½¿ç”¨æ•™ç¨‹å’Œæ¨¡å‹ç»“æ„")],-1),r=n("br",null,null,-1),d={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},k=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),m=n("p",null,"æœ¬æ–‡çš„å®—æ—¨åœ¨äºé€šè¿‡ç®€å•å¹²å‡€å®è·µçš„æ–¹å¼æ•™ä¼šè¯»è€…ï¼Œå¿«é€Ÿ Easy çš„ä½¿ç”¨ä¸Š sharding-jdbc è¿™ä¸ªç¬¨é‡çš„å¤§å®¶ä¼™ï¼",-1),v={href:"https://shardingsphere.apache.org/index_zh.html",target:"_blank",rel:"noopener noreferrer"},b=n("p",null,"æœ¬æ–‡æ¶‰åŠçš„å·¥ç¨‹ï¼š",-1),h={href:"https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-shardingjdbc",target:"_blank",rel:"noopener noreferrer"},g={href:"https://shardingsphere.apache.org/index_zh.html",target:"_blank",rel:"noopener noreferrer"},y=e(`<h2 id="ä¸€ã€è·¯ç”±æœ¬è´¨" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€è·¯ç”±æœ¬è´¨" aria-hidden="true">#</a> ä¸€ã€è·¯ç”±æœ¬è´¨</h2><p>åˆ†åº“åˆ†è¡¨çš„æœ¬è´¨æ˜¯æ•°æ®çš„æ•£åˆ—ï¼Œåˆ†æ‘Šæ•°æ®åº“èµ„æºå‹åŠ›ã€‚å¦‚æŠŠåŸæœ¬åœ¨ä¸€å°æœºå™¨ä¸Šçš„æ•°æ®åº“å­˜æ”¾1000ä¸‡æ•°æ®ï¼Œåˆ†æ‘Šåˆ°nå°æœºä¸Šï¼Œæ‹†åˆ†è¿™1000ä¸‡çš„æ•°æ®å’Œåç»­çš„å¢é‡ã€‚è®©æ¯ä¸ªæ•°æ®åº“èµ„æºæ¥åˆ†æ‘ŠåŸæœ¬éœ€è¦ä¸€å°æ•°æ®åº“æ‰€æä¾›çš„æœåŠ¡ã€‚</p><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-shardingjdbc-01.png?raw=true" width="600px"></div><ul><li>å½“ä½¿ç”¨åˆ†åº“åˆ†è¡¨ä»¥åï¼Œå¹¶ç¡®å®šå¦‚ä½¿ç”¨<code>ç”¨æˆ·ID</code>ä½œä¸ºè·¯ç”±åˆ†ç‰‡é”®ã€‚é‚£ä¹ˆæ‰€åšçš„CRUDæ“ä½œï¼Œéƒ½æ˜¯éœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªç”¨æˆ·IDï¼Œå¹¶æ ¹æ®IDåšè·¯ç”±åº“è¡¨è®¡ç®—ã€‚</li><li>åœ¨å¤§å‚ä¸­ï¼Œå¼€å‘é¡¹ç›®ã€‚å¹¶ä¸ä¼šè¯´ç›®å‰è¿™ä¸ªä¸šåŠ¡éœ€æ±‚è§„æ¨¡ä¸å¤§ï¼Œå°±ä¸ä½¿ç”¨åˆ†åº“åˆ†è¡¨ï¼Œè€Œæ˜¯åˆ†åº“åˆ†è¡¨éƒ½æ˜¯éå¸¸æˆç†Ÿçš„æ–¹æ¡ˆï¼Œå¹¶ä¸ä¼šå› ä¸ºä½¿ç”¨äº†å°±é™ä½å¾ˆå¤§çš„å¼€å‘æ•ˆç‡ã€‚æ‰€ä»¥åŸºæœ¬å°±æ˜¯é»˜è®¤å°±ä½¿ç”¨äº†ã€‚</li><li>é‚£ä¹ˆä½¿ç”¨äº†åˆ†åº“åˆ†è¡¨ï¼Œå°±ä¼šå¾ˆå ç”¨èµ„æºå—ã€‚ä¹Ÿä¸ä¼šï¼Œå› ä¸ºåˆšå¼€å§‹ä¸šåŠ¡ä½“é‡ä¸å¤§çš„æ—¶å€™ï¼Œéƒ½æ˜¯è™šæ‹Ÿæœºäº¤å‰ä½¿ç”¨ï¼Œä½ çš„1å°ç‰©ç†æœºè™šå‡ºæ¥10ä¸ªè™šæ‹Ÿæœºï¼Œå¤§å®¶äº¤å‰ä½¿ç”¨ä¸»å¤‡ã€‚è¿™æ ·ä½ åªæ˜¯ä½¿ç”¨äº†åˆ†åº“åˆ†è¡¨ï¼Œä½†åº“è¡¨çš„å®é™…èµ„æºæ²¡å ç”¨é‚£ä¹ˆå¤šã€‚</li></ul><h2 id="äºŒã€ä½¿ç”¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#äºŒã€ä½¿ç”¨æ¡ˆä¾‹" aria-hidden="true">#</a> äºŒã€ä½¿ç”¨æ¡ˆä¾‹</h2><ul><li>jdk 1.8 +</li><li>ShardingSphere 5.3+</li></ul><div class="language-pom line-numbers-mode" data-ext="pom"><pre class="language-pom"><code>&lt;!-- https://mvnrepository.com/artifact/org.apache.shardingsphere/shardingsphere-jdbc-core --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;
    &lt;artifactId&gt;shardingsphere-jdbc-core&lt;/artifactId&gt;
    &lt;version&gt;5.4.1&lt;/version&gt;
&lt;/dependency&gt;
 &lt;!-- https://mvnrepository.com/artifact/org.yaml/snakeyaml --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.yaml&lt;/groupId&gt;
    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;
    &lt;version&gt;1.33&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å› ä¸ºéœ€è¦è§£æ yaml ä½†é»˜è®¤çš„ SpringBoot æä¾›ç‰ˆæœ¬ä¸æ”¯æŒ shardingsphere-jdbc-core ä½¿ç”¨ã€‚</li></ul><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-shardingjdbc-02.png?raw=true" width="850px"></div><ul><li>å·¥ç¨‹ä¸­ï¼Œæä¾›äº† docker é…ç½®æ•°æ®åº“ç¯å¢ƒæ“ä½œï¼Œå¹¶æä¾›äº†å¯¹åº”çš„å»ºè¡¨æµ‹è¯•è¯­å¥ã€‚å¦‚æœä½ æœ¬æœºå·²ç»å®‰è£…äº†æ•°æ®åº“ï¼Œé‚£ä¹ˆåªåšåº“è¡¨è¯­å¥å¯¼å…¥ä»¥åŠ yml é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯å°±å¯ä»¥ã€‚</li><li>sharding-jdbc-dev.yaml é…ç½®äº†è¯¦ç»†çš„åˆ†åº“åˆ†è¡¨è·¯ç”±ä¿¡æ¯ï¼Œåœ¨ algorithms ä¸‹é…ç½®çš„æ˜¯åº“è¡¨çš„è·¯ç”±ç®—æ³•ã€‚è¿™é‡Œçš„ç®—æ³•è¦æ ¹æ®å®é™…è‡ªå·±ä½¿ç”¨ä¸­åº“è¡¨æ•°é‡æ¥è®¾ç½®&amp;è®¾è®¡ï¼Œé¿å…å‘ç”Ÿè¾ƒå¤§çš„æ•°æ®åç§»ã€‚</li><li>é…ç½®å®Œ sharding-jdbc-dev.yaml éœ€è¦åœ¨ application-dev.yml ä¸­é…ç½®ä¸Š sharding-jdbc-dev.yaml è·¯å¾„ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®åŠ è½½ã€‚</li><li>å¦‚æœä½ è¿˜éœ€è¦å®šä¹‰å‡ºè‡ªå·±ç‰¹å®šçš„è·¯ç”±ç®—æ³•ï¼Œå®ƒè¿˜æ”¯æŒè‡ªå·±å†™ä¸ªå®ç°ç±»çš„æ–¹å¼å¤„ç†ã€‚</li></ul><h3 id="_2-ç®—æ³•é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-ç®—æ³•é…ç½®" aria-hidden="true">#</a> 2. ç®—æ³•é…ç½®</h3><p><strong>sharding/sharding-jdbc-dev.yaml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># https://shardingsphere.apache.org/index_zh.html</span>
<span class="token key atrule">mode</span><span class="token punctuation">:</span>
  <span class="token comment"># è¿è¡Œæ¨¡å¼ç±»å‹ã€‚å¯é€‰é…ç½®ï¼šå†…å­˜æ¨¡å¼ Memoryã€å•æœºæ¨¡å¼ Standaloneã€é›†ç¾¤æ¨¡å¼ Cluster - ç›®å‰ä¸ºå•æœºæ¨¡å¼</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> Standalone

<span class="token key atrule">dataSources</span><span class="token punctuation">:</span>
  <span class="token key atrule">ds_0</span><span class="token punctuation">:</span>
    <span class="token key atrule">dataSourceClassName</span><span class="token punctuation">:</span> com.zaxxer.hikari.HikariDataSource
    <span class="token key atrule">driverClassName</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">jdbcUrl</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>13306/xfg_dev_tech_db_00<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull&amp;serverTimezone=UTC&amp;useSSL=true</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">connectionTimeoutMilliseconds</span><span class="token punctuation">:</span> <span class="token number">30000</span>
    <span class="token key atrule">idleTimeoutMilliseconds</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">maxLifetimeMilliseconds</span><span class="token punctuation">:</span> <span class="token number">1800000</span>
    <span class="token key atrule">maxPoolSize</span><span class="token punctuation">:</span> <span class="token number">15</span>
    <span class="token key atrule">minPoolSize</span><span class="token punctuation">:</span> <span class="token number">5</span>

  <span class="token key atrule">ds_1</span><span class="token punctuation">:</span>
    <span class="token key atrule">dataSourceClassName</span><span class="token punctuation">:</span> com.zaxxer.hikari.HikariDataSource
    <span class="token key atrule">driverClassName</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">jdbcUrl</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>13306/xfg_dev_tech_db_01<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull&amp;serverTimezone=UTC&amp;useSSL=true</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">connectionTimeoutMilliseconds</span><span class="token punctuation">:</span> <span class="token number">30000</span>
    <span class="token key atrule">idleTimeoutMilliseconds</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">maxLifetimeMilliseconds</span><span class="token punctuation">:</span> <span class="token number">1800000</span>
    <span class="token key atrule">maxPoolSize</span><span class="token punctuation">:</span> <span class="token number">15</span>
    <span class="token key atrule">minPoolSize</span><span class="token punctuation">:</span> <span class="token number">5</span>

<span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token tag">!SHARDING</span>
    <span class="token comment"># åº“çš„è·¯ç”±</span>
    <span class="token key atrule">defaultDatabaseStrategy</span><span class="token punctuation">:</span>
      <span class="token key atrule">standard</span><span class="token punctuation">:</span>
        <span class="token key atrule">shardingColumn</span><span class="token punctuation">:</span> user_id
        <span class="token key atrule">shardingAlgorithmName</span><span class="token punctuation">:</span> database_inline
    <span class="token comment"># è¡¨çš„è·¯ç”±</span>
    <span class="token key atrule">tables</span><span class="token punctuation">:</span>
      <span class="token key atrule">user_order</span><span class="token punctuation">:</span>
        <span class="token key atrule">actualDataNodes</span><span class="token punctuation">:</span> ds_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>0..1<span class="token punctuation">}</span>.user_order_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>0..3<span class="token punctuation">}</span>
        <span class="token key atrule">tableStrategy</span><span class="token punctuation">:</span>
          <span class="token key atrule">standard</span><span class="token punctuation">:</span>
            <span class="token key atrule">shardingColumn</span><span class="token punctuation">:</span> user_id
            <span class="token key atrule">shardingAlgorithmName</span><span class="token punctuation">:</span> user_order_inline
    <span class="token comment"># è·¯ç”±ç®—æ³•</span>
    <span class="token key atrule">shardingAlgorithms</span><span class="token punctuation">:</span>
      <span class="token comment"># åº“-è·¯ç”±ç®—æ³• 2æ˜¯ä¸¤ä¸ªåº“ï¼Œåº“çš„æ•°é‡ã€‚åº“çš„æ•°é‡ç”¨å“ˆå¸Œæ¨¡2æ¥è®¡ç®—ã€‚</span>
      <span class="token key atrule">database_inline</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> INLINE
        <span class="token key atrule">props</span><span class="token punctuation">:</span>
          <span class="token key atrule">algorithm-expression</span><span class="token punctuation">:</span> ds_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>Math.abs(user_id.hashCode()) % 2<span class="token punctuation">}</span>

      <span class="token comment"># è¡¨-è·¯ç”±ç®—æ³• 4æ˜¯ä¸€ä¸ªåº“é‡Œï¼Œè¡¨çš„æ•°é‡ã€‚4 - 1 ä¸ºäº†è·å¾— 011 è¿™æ ·çš„äºŒè¿›åˆ¶å€¼ã€‚ä¸æ¨è user_order_$-&gt;{Math.abs(user_id.hashCode()) % 2} ä½œä¸ºè¡¨çš„è·¯ç”±</span>
      <span class="token key atrule">user_order_inline</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> INLINE
        <span class="token key atrule">props</span><span class="token punctuation">:</span>
          <span class="token key atrule">algorithm-expression</span><span class="token punctuation">:</span> user_order_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>(user_id.hashCode() ^ (user_id.hashCode()) <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> 16) &amp; (4 <span class="token punctuation">-</span> 1)<span class="token punctuation">}</span>

<span class="token key atrule">props</span><span class="token punctuation">:</span>
  <span class="token comment"># æ˜¯å¦åœ¨æ—¥å¿—ä¸­æ‰“å° SQLã€‚</span>
  <span class="token comment"># æ‰“å° SQL å¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½ç³»ç»Ÿé—®é¢˜ã€‚æ—¥å¿—å†…å®¹åŒ…å«ï¼šé€»è¾‘ SQLï¼ŒçœŸå® SQL å’Œ SQL è§£æç»“æœã€‚</span>
  <span class="token comment"># å¦‚æœå¼€å¯é…ç½®ï¼Œæ—¥å¿—å°†ä½¿ç”¨ Topic ShardingSphere-SQLï¼Œæ—¥å¿—çº§åˆ«æ˜¯ INFOã€‚ false</span>
  <span class="token key atrule">sql-show</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment"># æ˜¯å¦åœ¨æ—¥å¿—ä¸­æ‰“å°ç®€å•é£æ ¼çš„ SQLã€‚false</span>
  <span class="token key atrule">sql-simple</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment"># ç”¨äºè®¾ç½®ä»»åŠ¡å¤„ç†çº¿ç¨‹æ± çš„å¤§å°ã€‚æ¯ä¸ª ShardingSphereDataSource ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼ŒåŒä¸€ä¸ª JVM çš„ä¸åŒæ•°æ®æºä¸å…±äº«çº¿ç¨‹æ± ã€‚</span>
  <span class="token key atrule">executor-size</span><span class="token punctuation">:</span> <span class="token number">20</span>
  <span class="token comment"># æŸ¥è¯¢è¯·æ±‚åœ¨æ¯ä¸ªæ•°æ®åº“å®ä¾‹ä¸­æ‰€èƒ½ä½¿ç”¨çš„æœ€å¤§è¿æ¥æ•°ã€‚1</span>
  <span class="token key atrule">max-connections-size-per-query</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token comment"># åœ¨ç¨‹åºå¯åŠ¨å’Œæ›´æ–°æ—¶ï¼Œæ˜¯å¦æ£€æŸ¥åˆ†ç‰‡å…ƒæ•°æ®çš„ç»“æ„ä¸€è‡´æ€§ã€‚</span>
  <span class="token key atrule">check-table-metadata-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token comment"># åœ¨ç¨‹åºå¯åŠ¨å’Œæ›´æ–°æ—¶ï¼Œæ˜¯å¦æ£€æŸ¥é‡å¤è¡¨ã€‚false</span>
  <span class="token key atrule">check-duplicate-table-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>modeï¼šè¿è¡Œæ¨¡å¼ï¼Œé»˜è®¤å°±å•æœºæ¨¡å¼ã€‚</li><li>dataSourcesï¼šæ•°æ®åº“è¿æ¥ä¿¡æ¯ã€‚</li><li>rulesï¼šè·¯ç”±ç®—æ³•ã€‚defaultDatabaseStrategy åº“çš„è·¯ç”±ã€tables è¡¨çš„è·¯ç”±ã€‚ä¹‹ååœ¨ shardingAlgorithms ä¸­é…ç½®å…·ä½“çš„è·¯ç”±ç®—æ³•ã€‚è¿™é‡Œçš„åç§°éƒ½æ˜¯å…³è”çš„ï¼Œä¸è¦é…ç½®é”™ã€‚</li><li>propsï¼šä¸€äº›å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ˜¯å¦æ‰“å°æ—¥å¿—ç­‰ã€‚</li></ul><h3 id="_3-é…ç½®å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#_3-é…ç½®å¼•å…¥" aria-hidden="true">#</a> 3. é…ç½®å¼•å…¥</h3><p><strong>application-dev.yml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> org.apache.shardingsphere.driver.ShardingSphereDriver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>shardingsphere<span class="token punctuation">:</span>classpath<span class="token punctuation">:</span>sharding/sharding<span class="token punctuation">-</span>jdbc<span class="token punctuation">-</span>dev.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å’Œä¹‹å‰çš„ä¸€äº› sharding ç‰ˆæœ¬ä¸åŒï¼Œè¿™é‡Œæ˜¯éœ€è¦ä½¿ç”¨å…·ä½“çš„ ShardingSphereDriver å’Œ url åœ°å€ï¼Œæ‰èƒ½åŠ è½½ä¸Šæˆ‘ä»¬é…ç½®çš„è·¯ç”±ä¿¡æ¯ã€‚</li></ul><h2 id="ä¸‰ã€æµ‹è¯•éªŒè¯" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æµ‹è¯•éªŒè¯" aria-hidden="true">#</a> ä¸‰ã€æµ‹è¯•éªŒè¯</h2><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-shardingjdbc-03.png?raw=true" width="850px"></div>`,21),_=n("li",null,"åŸºäºå·¥ç¨‹ä¸­ docs/dev-ops/mysql/sql åˆ›å»ºåº“è¡¨ã€‚å·²ç»æä¾›äº†åº“åã€è¡¨å’Œæµ‹è¯•æ•°æ®ã€‚",-1),f={href:"https://apps.apple.com/us/app/sequel-ace/id1518036000?ls=1",target:"_blank",rel:"noopener noreferrer"},S=e(`<h3 id="_1-å†™å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-å†™å…¥æ•°æ®" aria-hidden="true">#</a> 1. å†™å…¥æ•°æ®</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserOrderPO</span> userOrderPO <span class="token operator">=</span> <span class="token class-name">UserOrderPO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userName</span><span class="token punctuation">(</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span><span class="token string">&quot;xfg_&quot;</span> <span class="token operator">+</span> <span class="token class-name">RandomStringUtils</span><span class="token punctuation">.</span><span class="token function">randomAlphabetic</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userMobile</span><span class="token punctuation">(</span><span class="token string">&quot;+86 13521408***&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sku</span><span class="token punctuation">(</span><span class="token string">&quot;13811216&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">skuName</span><span class="token punctuation">(</span><span class="token string">&quot;ã€Šæ‰‹å†™MyBatisï¼šæ¸è¿›å¼æºç å®è·µã€‹&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orderId</span><span class="token punctuation">(</span><span class="token class-name">RandomStringUtils</span><span class="token punctuation">.</span><span class="token function">randomNumeric</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">quantity</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">unitPrice</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">discountAmount</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">tax</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">totalAmount</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orderDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orderStatus</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">isDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ipv4</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ipv6</span><span class="token punctuation">(</span><span class="token string">&quot;2001:0db8:85a3:0000:0000:8a2e:0370:7334&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">extData</span><span class="token punctuation">(</span><span class="token string">&quot;{\\&quot;device\\&quot;: {\\&quot;machine\\&quot;: \\&quot;IPhone 14 Pro\\&quot;, \\&quot;location\\&quot;: \\&quot;shanghai\\&quot;}}&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userOrderDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>userOrderPO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æµ‹è¯•æ•°æ®å†™å…¥ï¼Œä½ å¯ä»¥å†™å…¥1000æ¡æ•°æ®ï¼Œè§‚å¯Ÿæ•£åˆ—æ•ˆæœã€‚å¹¶å¯ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè°ƒè¯•ä¿®æ”¹ sharding-jdbc-dev.yaml æ–‡ä»¶å¯¹åº“è¡¨è·¯ç”±çš„è®¡ç®—æ–¹å¼ã€‚</li></ul><h3 id="_2-æŸ¥è¯¢æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2-æŸ¥è¯¢æ•°æ®" aria-hidden="true">#</a> 2. æŸ¥è¯¢æ•°æ®</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_selectByUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserOrderPO</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userOrderDao<span class="token punctuation">.</span><span class="token function">selectByUserId</span><span class="token punctuation">(</span><span class="token string">&quot;xfg_PrmgwQ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æŸ¥è¯¢çš„ç”¨æˆ·IDæ˜¯å·²ç»å†™å…¥åˆ°æ•°æ®åº“è¡¨é‡Œçš„æ•°æ®ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ä¼šæ ¹æ®ç”¨æˆ·IDç»§ç»­è·¯ç”±è®¡ç®—ã€‚</li></ul><h3 id="_3-æ•£åˆ—ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_3-æ•£åˆ—ç®—æ³•" aria-hidden="true">#</a> 3. æ•£åˆ—ç®—æ³•</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_idx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> user_id <span class="token operator">=</span> <span class="token string">&quot;xfg_&quot;</span> <span class="token operator">+</span> <span class="token class-name">RandomStringUtils</span><span class="token punctuation">.</span><span class="token function">randomAlphabetic</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœ {}&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8),q=n("li",null,"ä½ å¯ä»¥å°è¯•éªŒè¯å’Œç¼–å†™æ–°çš„æ•£åˆ—ç®—æ³•ï¼Œæœ€ç»ˆç›®çš„éƒ½æ˜¯è®©æ•°æ®å°½å¯èƒ½æ•£åˆ—åˆ°åº“è¡¨ã€‚",-1),x={href:"https://bugstack.cn/md/algorithm/logic/math/2022-11-05-fibonacci.html",target:"_blank",rel:"noopener noreferrer"};function j(D,I){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",d,[s("https://bugstack.cn"),t(a)])]),k,m,n("p",null,[s("ä¹‹æ‰€ä»¥è¯´ç¬¨é‡ï¼Œæ˜¯å› ä¸º "),n("a",v,[s("Apache ShardingSphere"),t(a)]),s(" ä¸åªæ˜¯ç®€å•æ„ä¹‰ä¸Šçš„è·¯ç”±ç»„ä»¶ï¼Œè€Œæ˜¯ä¸€æ¬¾åˆ†å¸ƒå¼ SQL äº‹åŠ¡å’ŒæŸ¥è¯¢å¼•æ“ï¼Œå¯é€šè¿‡æ•°æ®åˆ†ç‰‡ã€å¼¹æ€§ä¼¸ç¼©ã€åŠ å¯†ç­‰èƒ½åŠ›å¯¹ä»»æ„æ•°æ®åº“è¿›è¡Œå¢å¼ºã€‚åŒæ—¶å®ƒåˆåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œè¡ç”Ÿå‡ºäº†å¾ˆå¤šçš„ç‰ˆæœ¬ï¼Œä»¥åŠå¯¹åº”äº†ä¸åŒçš„ä½¿ç”¨æ–¹å¼ã€‚å¹¶åœ¨ ShardingSphere 5.3 ä»¥ååˆåšäº†ä¸å°çš„æ¶æ„è°ƒæ•´ã€‚æ‰€ä»¥å¾ˆå¤šä¼™ä¼´åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œç»å¸¸æ˜¯æ‰¾äº†ä¸€ä¸Šåˆçš„èµ„æ–™ï¼Œåˆ°ä¸‹åˆä¸‹ç­è¿˜æ²¡å¯¹æ¥ä¸Šã€‚")]),b,n("ul",null,[n("li",null,[s("xfg-dev-tech-shardingjdbcï¼š"),n("a",h,[s("https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-shardingjdbc"),t(a)])]),n("li",null,[s("å®˜ç½‘ï¼š"),n("a",g,[s("https://shardingsphere.apache.org/index_zh.html"),t(a)])])]),y,n("ul",null,[_,n("li",null,[s("æ— è®ºä½ ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œéƒ½å¯ä»¥å®‰è£…MySql å¹¶ä½¿ç”¨å¯è§†åŒ–å·¥å…·é“¾æ¥ã€‚è¿™é‡Œå°å‚…å“¥ç”¨çš„æ˜¯ "),n("a",f,[s("Sequel Ace"),t(a)])])]),S,n("ul",null,[q,n("li",null,[s("æ­¤å¤–ï¼Œå…³äºç®—æ³•çš„å¥½åï¼Œå¯ä»¥åŸºäº"),n("a",x,[s("é›ªå´©æµ‹è¯•"),t(a)]),s("è®¡ç®—")])])])}const N=p(i,[["render",j],["__file","sharding-jdbc.html.vue"]]);export{N as default};
