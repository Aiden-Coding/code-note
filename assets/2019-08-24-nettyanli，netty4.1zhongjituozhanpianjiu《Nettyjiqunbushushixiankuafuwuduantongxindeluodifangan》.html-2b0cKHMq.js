import{_ as e,r as o,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-3RcBQnkC.js";const u={},i=n("h1",{id:"nettyæ¡ˆä¾‹-netty4-1ä¸­çº§æ‹“å±•ç¯‡ä¹ã€Šnettyé›†ç¾¤éƒ¨ç½²å®ç°è·¨æœåŠ¡ç«¯é€šä¿¡çš„è½åœ°æ–¹æ¡ˆã€‹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#nettyæ¡ˆä¾‹-netty4-1ä¸­çº§æ‹“å±•ç¯‡ä¹ã€Šnettyé›†ç¾¤éƒ¨ç½²å®ç°è·¨æœåŠ¡ç«¯é€šä¿¡çš„è½åœ°æ–¹æ¡ˆã€‹","aria-hidden":"true"},"#"),s(" nettyæ¡ˆä¾‹ï¼Œnetty4.1ä¸­çº§æ‹“å±•ç¯‡ä¹ã€ŠNettyé›†ç¾¤éƒ¨ç½²å®ç°è·¨æœåŠ¡ç«¯é€šä¿¡çš„è½åœ°æ–¹æ¡ˆã€‹")],-1),k=n("br",null,null,-1),r={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=p('<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><h2 id="å‰è¨€ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#å‰è¨€ä»‹ç»" aria-hidden="true">#</a> å‰è¨€ä»‹ç»</h2><p><img src="https://bugstack.cn/assets/images/pic-content/2019/09/netty-2-09-3.png" alt="å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ"></p><p>Nettyçš„æ€§èƒ½éå¸¸å¥½ï¼Œåœ¨ä¸€äº›å°å‹ç”¨æˆ·ä½“é‡çš„socketæœåŠ¡å†…ï¼Œä»…éƒ¨ç½²å•å°æœºå™¨å°±å¯ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚ä½†å½“é‡åˆ°ä¸€äº›ä¸­å¤§å‹ç”¨æˆ·ä½“é‡çš„æœåŠ¡æ—¶ï¼Œå°±éœ€è¦è€ƒè™‘è®²NettyæŒ‰ç…§é›†ç¾¤æ–¹å¼éƒ¨ç½²ï¼Œä»¥æ›´å¥½çš„æ»¡è¶³ä¸šåŠ¡è¯‰æ±‚ã€‚ä½†Nettyéƒ¨ç½²é›†ç¾¤åéƒ½ä¼šé‡åˆ°è·¨æœåŠ¡ç«¯æ€ä¹ˆé€šä¿¡ï¼Œä¹Ÿå°±æ˜¯æœ‰é›†ç¾¤æœåŠ¡Xå’ŒYï¼Œç”¨æˆ·Aé“¾æ¥æœåŠ¡Xï¼Œç”¨æˆ·Bé“¾æ¥æœåŠ¡Yï¼Œé‚£ä¹ˆä»–ä»¬éƒ½ä¸åœ¨ä¸€ä¸ªæœåŠ¡å†…æ€ä¹ˆé€šä¿¡ï¼Ÿæœ¬ç« èŠ‚å°†ä»‹ç»ä¸€ç§å®ç°æ–¹å¼æ¡ˆä¾‹ï¼Œä»¥æ»¡è¶³è·¨æœåŠ¡ä¹‹é—´çš„ç”¨æˆ·é€šä¿¡ã€‚ä½†å®é™…åœºæ™¯ä¸­éœ€è¦è¿›è¡Œä¸€äº›æ‰©å±•æ€§æ”¹é€ ï¼Œæ¡ˆä¾‹ä»…å°†æ ¸å¿ƒä¸»å¹²æ€è·¯åšä»¥å®ç°ï¼Œåªæ˜¯ä¸€ç§æ€è·¯æŒ‡å¯¼ï¼Œå¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨äºä¸šåŠ¡å¼€å‘ã€‚</p><p><strong>æœ¬ç« çŸ¥è¯†ç‚¹</strong></p><ul><li>è·¨æœåŠ¡ä¹‹é—´æ¡ˆä¾‹é‡‡ç”¨redisçš„å‘å¸ƒå’Œè®¢é˜…è¿›è¡Œä¼ é€’æ¶ˆæ¯ï¼Œå¦‚æœä½ æ˜¯å¤§å‹æœåŠ¡å¯ä»¥ä½¿ç”¨zookeeper</li><li>ç”¨æˆ·Aåœ¨å‘é€æ¶ˆæ¯ç»™ç”¨æˆ·Bæ—¶å€™ï¼Œéœ€è¦ä¼ é€’Bçš„channeIdï¼Œä»¥ç”¨äºæœåŠ¡ç«¯è¿›è¡ŒæŸ¥æ‰¾channeIdæ‰€å±æ˜¯å¦è‡ªå·±çš„æœåŠ¡å†…</li><li>å•å°æœºå™¨ä¹Ÿå¯ä»¥å¯åŠ¨å¤šä¸ªNettyæœåŠ¡ï¼Œç¨‹åºå†…ä¼šè‡ªåŠ¨å¯»æ‰¾å¯ç”¨ç«¯å£</li></ul><h2 id="ç¯å¢ƒå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒå‡†å¤‡" aria-hidden="true">#</a> ç¯å¢ƒå‡†å¤‡</h2>',7),v=n("li",null,"jdk1.8ã€jdk1.7ä»¥ä¸‹åªèƒ½éƒ¨åˆ†æ”¯æŒnettyã€‘",-1),m=n("li",null,"Netty4.1.36.Finalã€netty3.x 4.x 5æ¯æ¬¡çš„å˜åŒ–è¾ƒå¤§ï¼Œæ¥å£ç±»åä¹Ÿéšç€å˜åŒ–ã€‘",-1),b=n("li",null,"NetAssist ç½‘ç»œè°ƒè¯•åŠ©æ‰‹ï¼Œå¯ä»¥ä»ç½‘ä¸Šä¸‹è½½ä¹Ÿå¯ä»¥è”ç³»æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | å…³æ³¨å›å¤ä½ çš„é‚®ç®±",-1),g={href:"https://github.com/MicrosoftArchive/redis/tags",target:"_blank",rel:"noopener noreferrer"},y=p(`<h2 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹" aria-hidden="true">#</a> ä»£ç ç¤ºä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>rpc<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">09</span>
â””â”€â”€ src
    â””â”€â”€ main
    â”‚   â”œâ”€â”€ java
    â”‚   â”‚   â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty
    â”‚   â”‚        â”œâ”€â”€ domain
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">EasyResult</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">MsgAgreement</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">ServerInfo</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â””â”€â”€ <span class="token class-name">UserChannelInfo</span><span class="token punctuation">.</span>java	
    â”‚   â”‚        â”œâ”€â”€ redis
    â”‚   â”‚        â”‚   â”œâ”€â”€ config
    â”‚   â”‚        â”‚   â”‚	 â”œâ”€â”€ <span class="token class-name">PublisherConfig</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”‚   â””â”€â”€ <span class="token class-name">ReceiverConfig</span><span class="token punctuation">.</span>java	
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">AbstractReceiver</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">MsgAgreementReceiver</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">Publisher</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â””â”€â”€ <span class="token class-name">RedisUtil</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”œâ”€â”€ server
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">MyServerHandler</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â””â”€â”€ <span class="token class-name">NettyServer</span><span class="token punctuation">.</span>java	
    â”‚   â”‚        â”œâ”€â”€ service
    â”‚   â”‚        â”‚   â””â”€â”€ <span class="token class-name">ExtServerService</span><span class="token punctuation">.</span>java	
    â”‚   â”‚        â”œâ”€â”€ util
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â”œâ”€â”€ <span class="token class-name">MsgUtil</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â”‚   â””â”€â”€ <span class="token class-name">NetUtil</span><span class="token punctuation">.</span>java	
    â”‚   â”‚        â”œâ”€â”€ web
    â”‚   â”‚        â”‚	  â””â”€â”€ <span class="token class-name">NettyController</span><span class="token punctuation">.</span>java
    â”‚   â”‚        â””â”€â”€ <span class="token class-name">Application</span><span class="token punctuation">.</span>java
    â”‚   â”œâ”€â”€ resources	
    â”‚   â”‚   â””â”€â”€ application<span class="token punctuation">.</span>yml
    â”‚   â””â”€â”€ webapp	
    â”‚       â”œâ”€â”€ res		
    â”‚       â””â”€â”€ <span class="token constant">WEB</span><span class="token operator">-</span><span class="token constant">INF</span>
    â”‚        	â””â”€â”€ index<span class="token punctuation">.</span>jsp		
    â””â”€â”€ test
         â””â”€â”€ java
             â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>test
                 â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¼”ç¤ºè®²è§£éƒ¨åˆ†é‡ç‚¹ä»£ç å—ï¼Œå®Œæ•´ä»£ç ä¸‹è½½ï¼Œå…³æ³¨å…¬ä¼—å·ï¼›bugstackè™«æ´æ ˆ | å›å¤ï¼šnettyæ¡ˆä¾‹æºç </strong></p><blockquote><p>domain/MsgAgreement.java | å®šä¹‰ä¿¡æ¯ä¼ è¾“åè®®ï¼Œè¿™ä¸ªçœ‹ä¼¼ç®€å•ä½†éå¸¸é‡è¦ï¼Œæ¯ä¸€ä¸ªé€šä¿¡çš„æ ¹æœ¬å°±æ˜¯å®šä¹‰ä¼ è¾“åè®®ä¿¡æ¯</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ¶ˆæ¯åè®®
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›å…³æ³¨è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgAgreement</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> toChannelId<span class="token punctuation">;</span> <span class="token comment">//å‘é€ç»™æŸäººï¼ŒæŸäººchannelId</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>     <span class="token comment">//æ¶ˆæ¯å†…å®¹</span>

    <span class="token keyword">public</span> <span class="token class-name">MsgAgreement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">MsgAgreement</span><span class="token punctuation">(</span><span class="token class-name">String</span> toChannelId<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>toChannelId <span class="token operator">=</span> toChannelId<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getToChannelId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> toChannelId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setToChannelId</span><span class="token punctuation">(</span><span class="token class-name">String</span> toChannelId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>toChannelId <span class="token operator">=</span> toChannelId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>redis/config/PublisherConfig.java | redisæ¶ˆæ¯å‘å¸ƒè€…ï¼Œé›†æˆä¸SpringBootçš„é…ç½®æ–¹å¼</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å‘å¸ƒè€…
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PublisherConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisMessageTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setDefaultSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FastJsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>redis/config/ReceiverConfig.java | redisæ¶ˆæ¯çš„è®¢é˜…è€…ï¼Œé›†æˆä¸SpringBootçš„é…ç½®æ–¹å¼ã€‚å¯ä»¥è®¢é˜…å¤šä¸ªä¸»é¢˜ï¼Œæœ¬ç« èŠ‚åªè®¢é˜…ä¸€ä¸ªã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è®¢é˜…è€…
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiverConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisMessageListenerContainer</span> <span class="token function">container</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> connectionFactory<span class="token punctuation">,</span> <span class="token class-name">MessageListenerAdapter</span> msgAgreementListenerAdapter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisMessageListenerContainer</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisMessageListenerContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        container<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        container<span class="token punctuation">.</span><span class="token function">addMessageListener</span><span class="token punctuation">(</span>msgAgreementListenerAdapter<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PatternTopic</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty-push-msgAgreement&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> container<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MessageListenerAdapter</span> <span class="token function">msgAgreementListenerAdapter</span><span class="token punctuation">(</span><span class="token class-name">MsgAgreementReceiver</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MessageListenerAdapter</span><span class="token punctuation">(</span>receiver<span class="token punctuation">,</span> <span class="token string">&quot;receiveMessage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>redis/MsgAgreementReceiver.java | å®ç°æŠ½è±¡ç±»ç”¨äºæ¥æ”¶è®¢é˜…åˆ°çš„æ¶ˆæ¯ï¼Œæ¥æ”¶æ¶ˆæ¯åè¿›è¡Œä¸šåŠ¡å¤„ç†</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgAgreementReceiver</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractReceiver</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MsgAgreementReceiver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveMessage</span><span class="token punctuation">(</span><span class="token class-name">Object</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ¥æ”¶åˆ°PUSHæ¶ˆæ¯ï¼š{}&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MsgAgreement</span> msgAgreement <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">MsgAgreement</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> toChannelId <span class="token operator">=</span> msgAgreement<span class="token punctuation">.</span><span class="token function">getToChannelId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>cacheChannel<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>toChannelId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> channel<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span><span class="token class-name">MsgUtil</span><span class="token punctuation">.</span><span class="token function">obj2Json</span><span class="token punctuation">(</span>msgAgreement<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>redis/RedisUtil.java | redisæ“ä½œå·¥å…·ç±»ï¼Œå¸®åŠ©å­˜å‚¨æ•°æ®ã€‚ä»¥ä¸‹æ˜¯å°†é“¾æ¥åˆ°æœåŠ¡çš„ç”¨æˆ·ä¿¡æ¯å­˜æ”¾åˆ°redisæ–¹ä¾¿å¯ä»¥åœ¨æ¯ä¸ªæœåŠ¡ç«¯éƒ½èƒ½çœ‹åˆ°è¿™ä»½ç”¨æˆ·é“¾æ¥æ•°æ®ã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›å…³æ³¨è·å–å­¦ä¹ æºç ï½
 * Create by fuzhengwei on 2019
 */</span>
<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">&quot;redisUtil&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisUtil</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> redisTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pushObj</span><span class="token punctuation">(</span><span class="token class-name">UserChannelInfo</span> userChannelInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty-2-09-user&quot;</span><span class="token punctuation">,</span> userChannelInfo<span class="token punctuation">.</span><span class="token function">getChannelId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>userChannelInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserChannelInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">popList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty-2-09-user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> values<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserChannelInfo</span><span class="token punctuation">&gt;</span></span> userChannelInfoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> strJson <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            userChannelInfoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>strJson<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserChannelInfo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> userChannelInfoList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">String</span> channelId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty-2-09-user&quot;</span><span class="token punctuation">,</span>channelId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty-2-09-user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>server/MyServerHandler.java | å¤„ç†æ¥æ”¶åˆ°çš„ä¿¡æ¯ï¼Œå°¤å…¶åœ¨channelReadä¸­ï¼Œå°†æ¥å—è€…ä¸æ˜¯æœ¬æœåŠ¡ç«¯çš„ç”¨æˆ·ï¼Œè¿›è¡Œå…¨å±€push</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›å…³æ³¨è·å–å­¦ä¹ æºç ï½
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServerHandler</span> <span class="token keyword">extends</span> <span class="token class-name">ChannelInboundHandlerAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MyServerHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">ExtServerService</span> extServerService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyServerHandler</span><span class="token punctuation">(</span><span class="token class-name">ExtServerService</span> extServerService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>extServerService <span class="token operator">=</span> extServerService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * å½“å®¢æˆ·ç«¯ä¸»åŠ¨é“¾æ¥æœåŠ¡ç«¯çš„é“¾æ¥åï¼Œè¿™ä¸ªé€šé“å°±æ˜¯æ´»è·ƒçš„äº†ã€‚ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹äº†é€šä¿¡é€šé“å¹¶ä¸”å¯ä»¥ä¼ è¾“æ•°æ®
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelActive</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">SocketChannel</span> channel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SocketChannel</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é“¾æ¥æŠ¥å‘Šå¼€å§‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é“¾æ¥æŠ¥å‘Šä¿¡æ¯ï¼šæœ‰ä¸€å®¢æˆ·ç«¯é“¾æ¥åˆ°æœ¬æœåŠ¡ç«¯ã€‚channelIdï¼š&quot;</span> <span class="token operator">+</span> channel<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é“¾æ¥æŠ¥å‘ŠIP:&quot;</span> <span class="token operator">+</span> channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é“¾æ¥æŠ¥å‘ŠPort:&quot;</span> <span class="token operator">+</span> channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é“¾æ¥æŠ¥å‘Šå®Œæ¯•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä¿å­˜ç”¨æˆ·ä¿¡æ¯</span>
        <span class="token class-name">UserChannelInfo</span> userChannelInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserChannelInfo</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> channel<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        extServerService<span class="token punctuation">.</span><span class="token function">getRedisUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pushObj</span><span class="token punctuation">(</span>userChannelInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>cacheChannel<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> channel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é€šçŸ¥å®¢æˆ·ç«¯é“¾æ¥å»ºç«‹æˆåŠŸ</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;é€šçŸ¥å®¢æˆ·ç«¯é“¾æ¥å»ºç«‹æˆåŠŸ&quot;</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span><span class="token class-name">MsgUtil</span><span class="token punctuation">.</span><span class="token function">buildMsg</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * å½“å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€æœåŠ¡ç«¯çš„é“¾æ¥åï¼Œè¿™ä¸ªé€šé“å°±æ˜¯ä¸æ´»è·ƒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„å…³é—­äº†é€šä¿¡é€šé“å¹¶ä¸”ä¸å¯ä»¥ä¼ è¾“æ•°æ®
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelInactive</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å®¢æˆ·ç«¯æ–­å¼€é“¾æ¥&quot;</span> <span class="token operator">+</span> ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        extServerService<span class="token punctuation">.</span><span class="token function">getRedisUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>cacheChannel<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelRead</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">Object</span> objMsgJsonStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ¥æ”¶msgæ¶ˆæ¯{ä¸ä¸Šä¸€ç« èŠ‚ç›¸æ¯”ï¼Œæ­¤å¤„å·²ç»ä¸éœ€è¦è‡ªå·±è¿›è¡Œè§£ç }</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ¥æ”¶åˆ°æ¶ˆæ¯å†…å®¹ï¼š&quot;</span> <span class="token operator">+</span> objMsgJsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">MsgAgreement</span> msgAgreement <span class="token operator">=</span> <span class="token class-name">MsgUtil</span><span class="token punctuation">.</span><span class="token function">json2Obj</span><span class="token punctuation">(</span>objMsgJsonStr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> toChannelId <span class="token operator">=</span> msgAgreement<span class="token punctuation">.</span><span class="token function">getToChannelId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ¤æ–­æ¥æ”¶æ¶ˆæ¯ç”¨æˆ·æ˜¯å¦åœ¨æœ¬æœåŠ¡ç«¯</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>cacheChannel<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>toChannelId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            channel<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span><span class="token class-name">MsgUtil</span><span class="token punctuation">.</span><span class="token function">obj2Json</span><span class="token punctuation">(</span>msgAgreement<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å¦‚æœä¸ºNULLåˆ™æ¥æ”¶æ¶ˆæ¯çš„ç”¨æˆ·ä¸åœ¨æœ¬æœåŠ¡ç«¯ï¼Œéœ€è¦pushæ¶ˆæ¯ç»™å…¨å±€</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ¥æ”¶æ¶ˆæ¯çš„ç”¨æˆ·ä¸åœ¨æœ¬æœåŠ¡ç«¯ï¼ŒPUSHï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        extServerService<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msgAgreement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æŠ“ä½å¼‚å¸¸ï¼Œå½“å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œå¯ä»¥åšä¸€äº›ç›¸åº”çš„å¤„ç†ï¼Œæ¯”å¦‚æ‰“å°æ—¥å¿—ã€å…³é—­é“¾æ¥
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exceptionCaught</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        extServerService<span class="token punctuation">.</span><span class="token function">getRedisUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>cacheChannel<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚å¸¸ä¿¡æ¯ï¼š\\r\\n&quot;</span> <span class="token operator">+</span> cause<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>util/CacheUtil.java | ç¼“å­˜å¿…è¦ä¿¡æ¯ï¼Œç”¨äºä¸šåŠ¡æµç¨‹å¤„ç†</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›å…³æ³¨è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CacheUtil</span> <span class="token punctuation">{</span>

    <span class="token comment">// ç¼“å­˜channel</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Channel</span><span class="token punctuation">&gt;</span></span> cacheChannel <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Channel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ç¼“å­˜æœåŠ¡ä¿¡æ¯</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">ServerInfo</span><span class="token punctuation">&gt;</span></span> serverInfoMap <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">ServerInfo</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ç¼“å­˜æœåŠ¡ç«¯</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">NettyServer</span><span class="token punctuation">&gt;</span></span> serverMap <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">NettyServer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>web/NettyController.java | æ¥å£å¤„ç†æ§åˆ¶ç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ“ä½œæœåŠ¡ç«¯æ–¹æ³•ï¼ŒåŒ…æ‹¬å¯åŠ¨NettyæœåŠ¡ã€è·å–ç”¨æˆ·ä¿¡æ¯ç­‰</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * è™«æ´ç¾¤ï¼šâ‘ ç¾¤5398358 â‘¡ç¾¤5360692
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">NettyController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤çº¿ç¨‹æ± </span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${server.port}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> serverPort<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ExtServerService</span> extServerService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisUtil</span> redisUtil<span class="token punctuation">;</span>
    <span class="token comment">//NettyæœåŠ¡ç«¯</span>
    <span class="token keyword">private</span> <span class="token class-name">NettyServer</span> nettyServer<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;serverPort&quot;</span><span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/openNettyServer&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyResult</span> <span class="token function">openNettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token class-name">NetUtil</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å¯åŠ¨NettyæœåŠ¡ï¼Œè·å–å¯ç”¨ç«¯å£ï¼š{}&quot;</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            nettyServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NettyServer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InetSocketAddress</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">,</span> extServerService<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Channel</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>nettyServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Channel</span> channel <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;netty server open error channel is null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>channel<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å¯åŠ¨NettyæœåŠ¡ï¼Œå¾ªç¯ç­‰å¾…å¯åŠ¨...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverInfoMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ServerInfo</span><span class="token punctuation">(</span><span class="token class-name">NetUtil</span><span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> nettyServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å¯åŠ¨NettyæœåŠ¡ï¼Œå®Œæˆï¼š{}&quot;</span><span class="token punctuation">,</span> channel<span class="token punctuation">.</span><span class="token function">localAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">EasyResult</span><span class="token punctuation">.</span><span class="token function">buildSuccessResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;å¯åŠ¨NettyæœåŠ¡å¤±è´¥&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">EasyResult</span><span class="token punctuation">.</span><span class="token function">buildErrResult</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/closeNettyServer&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyResult</span> <span class="token function">closeNettyServer</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å…³é—­NettyæœåŠ¡å¼€å§‹ï¼Œç«¯å£ï¼š{}&quot;</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">NettyServer</span> nettyServer <span class="token operator">=</span> <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> nettyServer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token class-name">EasyResult</span><span class="token punctuation">.</span><span class="token function">buildSuccessResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            nettyServer<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverInfoMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å…³é—­NettyæœåŠ¡å®Œæˆï¼Œç«¯å£ï¼š{}&quot;</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">EasyResult</span><span class="token punctuation">.</span><span class="token function">buildSuccessResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;å…³é—­NettyæœåŠ¡å¤±è´¥ï¼Œç«¯å£ï¼š{}&quot;</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">EasyResult</span><span class="token punctuation">.</span><span class="token function">buildErrResult</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/queryNettyServerList&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServerInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryNettyServerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServerInfo</span><span class="token punctuation">&gt;</span></span> serverInfos <span class="token operator">=</span> <span class="token class-name">CacheUtil</span><span class="token punctuation">.</span>serverInfoMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢æœåŠ¡ç«¯åˆ—è¡¨ã€‚{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>serverInfos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> serverInfos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢æœåŠ¡ç«¯åˆ—è¡¨å¤±è´¥ã€‚&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/queryUserChannelInfoList&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserChannelInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUserChannelInfoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å¼€å§‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserChannelInfo</span><span class="token punctuation">&gt;</span></span> userChannelInfoList <span class="token operator">=</span> redisUtil<span class="token punctuation">.</span><span class="token function">popList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å®Œæˆã€‚listï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>userChannelInfoList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> userChannelInfoList<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>resources/application.yml | åŸºç¡€é…ç½®ï¼Œåœ¨æˆ‘ä»¬å¯åŠ¨æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œå¦‚æœåªæœ‰ä¸€å°æœºå™¨æ¨¡æ‹Ÿï¼Œé‚£ä¹ˆéœ€è¦æ”¹å˜server.portç«¯å£ï½›8080ã€8081ï½</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>server<span class="token operator">:</span>
  port<span class="token operator">:</span> <span class="token number">8080</span>

spring<span class="token operator">:</span>
  mvc<span class="token operator">:</span>
    view<span class="token operator">:</span>
      prefix<span class="token operator">:</span> <span class="token operator">/</span><span class="token constant">WEB</span><span class="token operator">-</span><span class="token constant">INF</span><span class="token operator">/</span>
      suffix<span class="token operator">:</span> <span class="token punctuation">.</span>jsp
  redis<span class="token operator">:</span>
    host<span class="token operator">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
    port<span class="token operator">:</span> <span class="token number">6379</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>index.jsp | é¡µé¢æ“ä½œï¼Œæ§åˆ¶å’Œå±•ç¤ºçš„ä¸€äº›å†…å®¹</p></blockquote><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>&lt;%--
  è™«æ´æ ˆï¼šhttps://bugstack.cn
  å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
  Create by fuzhengwei on 2019
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | ä¸“é¢˜æ¡ˆä¾‹å¼€å‘ï¼Œå…³æ³¨å–æºç  | bugstack.cn ä»˜æ”¿å§”<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>res/js/themes/default/easyui.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>res/js/themes/icon.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>res/js/jquery.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>res/js/jquery.easyui.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
util <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">formatDate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> row<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      date<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> date<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&#39;yyyy-MM-dd HH:mm:ss&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">margin</span><span class="token punctuation">:</span>20px 0<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>easyui-datagrid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localhost:\${serverPort} | NettyæœåŠ¡ç«¯<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>700px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>250px</span><span class="token punctuation">&quot;</span></span></span>
			<span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rownumbers:true,singleSelect:true,url:&#39;/queryNettyServerList&#39;,method:&#39;get&#39;,toolbar:toolbar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;ip&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>IP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;port&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç«¯å£<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;openDate&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å¯åŠ¨æ—¶é—´<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
		<span class="token keyword">var</span> toolbar <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
			<span class="token literal-property property">text</span><span class="token operator">:</span><span class="token string">&#39;å¯åŠ¨&#39;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">iconCls</span><span class="token operator">:</span><span class="token string">&#39;icon-open&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">handler</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			    $<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/openNettyServer&#39;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                               <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                  $<span class="token punctuation">.</span>messager<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;æ¶ˆæ¯æç¤º&#39;</span><span class="token punctuation">,</span>
                                        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;å¯åŠ¨æˆåŠŸï¼Œè¯·ç¨ååˆ·æ–°é¡µé¢ï¼&#39;</span>
                                  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                   <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;#easyui-datagrid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">datagrid</span><span class="token punctuation">(</span><span class="token string">&#39;reload&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                               <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                                   $<span class="token punctuation">.</span>messager<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                       <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Error&#39;</span><span class="token punctuation">,</span>
                                       <span class="token literal-property property">msg</span><span class="token operator">:</span> res<span class="token punctuation">.</span>msg
                                   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                               <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
			<span class="token literal-property property">text</span><span class="token operator">:</span><span class="token string">&#39;å…³é—­&#39;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">iconCls</span><span class="token operator">:</span><span class="token string">&#39;icon-close&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">handler</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			     <span class="token comment">//å¯ä»¥è‡ªå·±æ·»åŠ å®ç°</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/&gt;</span></span>
	<span class="token comment">&lt;!-- server-user --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>easyui-datagrid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>localhost:\${serverPort} | ç”¨æˆ·é“¾æ¥ä¿¡æ¯<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>700px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>250px</span><span class="token punctuation">&quot;</span></span></span>
    			<span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rownumbers:true,singleSelect:true,url:&#39;/queryUserChannelInfoList&#39;,method:&#39;get&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
    			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
    				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;ip&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>IP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;port&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç«¯å£<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;channelId&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç”¨æˆ·ID<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field:&#39;linkDate&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é“¾æ¥æ—¶é—´<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> æµ‹è¯•ç»“æœ</h2><blockquote><p>å¯åŠ¨RedisæœåŠ¡ | æ¡ˆä¾‹ä¸­ä½¿ç”¨windwosç‰ˆæœ¬</p></blockquote><p><img src="https://bugstack.cn/assets/images/pic-content/2019/09/netty-2-09-1.png" alt="å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ"></p><blockquote><p>å¯åŠ¨2æ¬¡SpringBootï¼Œæ¨¡æ‹ŸNettyé›†ç¾¤[ä¸åŒç«¯å£8080ã€8081] | Plugins/spring-boot/run åŒå‡»å¯åŠ¨</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">29.649</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>a<span class="token punctuation">.</span>c<span class="token punctuation">.</span>c<span class="token punctuation">.</span></span>C</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token class-name">Tomcat</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>localhost<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token operator">/</span><span class="token punctuation">]</span>       <span class="token operator">:</span> <span class="token class-name">Initializing</span> <span class="token class-name">Spring</span> <span class="token class-name">FrameworkServlet</span> &#39;dispatcherServlet&#39;
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">29.649</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>s<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span>DispatcherServlet</span>        <span class="token operator">:</span> <span class="token class-name">FrameworkServlet</span> &#39;dispatcherServlet&#39;<span class="token operator">:</span> initialization started
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">29.681</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>s<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span>DispatcherServlet</span>        <span class="token operator">:</span> <span class="token class-name">FrameworkServlet</span> &#39;dispatcherServlet&#39;<span class="token operator">:</span> initialization completed in <span class="token number">32</span> ms
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">31.350</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢æœåŠ¡ç«¯åˆ—è¡¨ã€‚<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">31.371</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å¼€å§‹
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">31.380</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å®Œæˆã€‚listï¼š<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">22.864</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> å¯åŠ¨<span class="token class-name">Netty</span>æœåŠ¡ï¼Œè·å–å¯ç”¨ç«¯å£ï¼š<span class="token number">7398</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">22.879</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>pool<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>thread<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>NettyServer</span>  <span class="token operator">:</span> itstack<span class="token operator">-</span>demo<span class="token operator">-</span>netty server start done<span class="token punctuation">.</span> <span class="token punctuation">{</span>å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆï¼Œè·å–æºç <span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">22.880</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> å¯åŠ¨<span class="token class-name">Netty</span>æœåŠ¡ï¼Œå®Œæˆï¼š<span class="token operator">/</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">7398</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">23.612</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢æœåŠ¡ç«¯åˆ—è¡¨ã€‚<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;ip&quot;</span><span class="token operator">:</span><span class="token string">&quot;10.13.28.13&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;openDate&quot;</span><span class="token operator">:</span><span class="token number">1567314262880</span><span class="token punctuation">,</span><span class="token string">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">7398</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">23.634</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>io<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å¼€å§‹
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">23.636</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>io<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å®Œæˆã€‚listï¼š<span class="token punctuation">[</span><span class="token punctuation">]</span>
é“¾æ¥æŠ¥å‘Šå¼€å§‹
é“¾æ¥æŠ¥å‘Šä¿¡æ¯ï¼šæœ‰ä¸€å®¢æˆ·ç«¯é“¾æ¥åˆ°æœ¬æœåŠ¡ç«¯ã€‚channelIdï¼š<span class="token number">3</span>a2d5cee
é“¾æ¥æŠ¥å‘Š<span class="token constant">IP</span><span class="token operator">:</span><span class="token number">10.13</span><span class="token number">.28</span><span class="token number">.13</span>
é“¾æ¥æŠ¥å‘Š<span class="token class-name">Port</span><span class="token operator">:</span><span class="token number">7398</span>
é“¾æ¥æŠ¥å‘Šå®Œæ¯•
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">42.704</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢æœåŠ¡ç«¯åˆ—è¡¨ã€‚<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;ip&quot;</span><span class="token operator">:</span><span class="token string">&quot;10.13.28.13&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;openDate&quot;</span><span class="token operator">:</span><span class="token number">1567314262880</span><span class="token punctuation">,</span><span class="token string">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">7398</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">42.738</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å¼€å§‹
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">42.755</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span>NettyController</span>       <span class="token operator">:</span> æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯å®Œæˆã€‚listï¼š<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;channelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;39d45ff7&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ip&quot;</span><span class="token operator">:</span><span class="token string">&quot;10.13.28.13&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;linkDate&quot;</span><span class="token operator">:</span><span class="token number">1567314278944</span><span class="token punctuation">,</span><span class="token string">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">7397</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;channelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ip&quot;</span><span class="token operator">:</span><span class="token string">&quot;10.13.28.13&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;linkDate&quot;</span><span class="token operator">:</span><span class="token number">1567314280442</span><span class="token punctuation">,</span><span class="token string">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">7398</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">25.545</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>    container<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>d<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span>MsgAgreementReceiver</span>   <span class="token operator">:</span> æ¥æ”¶åˆ°<span class="token constant">PUSH</span>æ¶ˆæ¯ï¼š<span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">26.107</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>    container<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>d<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span>MsgAgreementReceiver</span>   <span class="token operator">:</span> æ¥æ”¶åˆ°<span class="token constant">PUSH</span>æ¶ˆæ¯ï¼š<span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">27.025</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>    container<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>d<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span>MsgAgreementReceiver</span>   <span class="token operator">:</span> æ¥æ”¶åˆ°<span class="token constant">PUSH</span>æ¶ˆæ¯ï¼š<span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">27.545</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>    container<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>d<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span>MsgAgreementReceiver</span>   <span class="token operator">:</span> æ¥æ”¶åˆ°<span class="token constant">PUSH</span>æ¶ˆæ¯ï¼š<span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">28.559</span>  <span class="token constant">INFO</span> <span class="token number">8952</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>    container<span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>i<span class="token punctuation">.</span>d<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span>MsgAgreementReceiver</span>   <span class="token operator">:</span> æ¥æ”¶åˆ°<span class="token constant">PUSH</span>æ¶ˆæ¯ï¼š<span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å¯åŠ¨2ä¸ªä»¥ä¸Šçš„NetAssiståˆ†åˆ«é“¾æ¥åˆ°ä¸åŒçš„æœåŠ¡ç«¯ï¼Œä»¥æ¨¡æ‹Ÿæµ‹è¯•è·¨æœåŠ¡é€šä¿¡ï¼Œæœ€ååœ¨å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ä¼ é€’ç»™å¦å¤–ä¸€ä¸ªä¸åœ¨æœ¬æœåŠ¡ç«¯çš„å®¢æˆ·ç«¯ã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token punctuation">{</span><span class="token string">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;hi! I&#39;m å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨&amp;è·å–æºç ã€‚* æ¥è‡ªAæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘BæœåŠ¡ç«¯é‡Œç”¨æˆ·å‘é€ä¿¡æ¯ã€‚[ç»“å°¾æ¢è¡Œï¼Œç”¨äºå¤„ç†åŠåŒ…ç²˜åŒ…]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;toChannelId&quot;</span><span class="token operator">:</span><span class="token string">&quot;3a2d5cee&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>æœ€ç»ˆè¿è¡Œæ•ˆæœ</p></blockquote><p><img src="https://bugstack.cn/assets/images/pic-content/2019/09/netty-2-09-2.png" alt="å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ"></p><p>å¾®ä¿¡æœç´¢ã€Œ<strong>bugstackè™«æ´æ ˆ</strong>ã€å…¬ä¼—å·ï¼Œå…³æ³¨åå›å¤ã€Œ<strong>Nettyä¸“é¢˜æ¡ˆä¾‹</strong>ã€è·å–æœ¬æ–‡æºç &amp;æ›´å¤šåŸåˆ›ä¸“é¢˜æ¡ˆä¾‹ï¼</p>`,33);function h(q,f){const a=o("ExternalLinkIcon");return c(),l("div",null,[i,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),k,s("åšå®¢ï¼š"),n("a",r,[s("https://bugstack.cn"),t(a)])]),d,n("ol",null,[v,m,b,n("li",null,[s("redisæœåŠ¡ç«¯ï¼Œæ¡ˆä¾‹é‡‡ç”¨windowsç‰ˆæœ¬ï¼ŒæŒ‰éœ€ä»å®˜ç½‘"),n("a",g,[s("ä¸‹è½½å³å¯"),t(a)])])]),y])}const S=e(u,[["render",h],["__file","2019-08-24-nettyanliï¼Œnetty4.1zhongjituozhanpianjiuã€ŠNettyjiqunbushushixiankuafuwuduantongxindeluodifanganã€‹.html.vue"]]);export{S as default};
