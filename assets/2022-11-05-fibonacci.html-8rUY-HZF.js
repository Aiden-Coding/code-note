import{_ as e,r as o,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"ã€Šç¨‹åºå‘˜æ•°å­¦-æ–æ³¢é‚£å¥‘ã€‹â€”â€”-ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ–æ³¢é‚£å¥‘æ•£åˆ—-åšæ•°æ®åº“è·¯ç”±ç®—æ³•",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ã€Šç¨‹åºå‘˜æ•°å­¦-æ–æ³¢é‚£å¥‘ã€‹â€”â€”-ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ–æ³¢é‚£å¥‘æ•£åˆ—-åšæ•°æ®åº“è·¯ç”±ç®—æ³•","aria-hidden":"true"},"#"),s(" ã€Šç¨‹åºå‘˜æ•°å­¦ï¼šæ–æ³¢é‚£å¥‘ã€‹â€”â€” ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ–æ³¢é‚£å¥‘æ•£åˆ—ï¼Œåšæ•°æ®åº“è·¯ç”±ç®—æ³•ï¼Ÿ")],-1),r=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("br",null,null,-1),m={href:"https://github.com/fuzhengwei/java-algorithms",target:"_blank",rel:"noopener noreferrer"},v=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),b=n("h2",{id:"ä¸€ã€å…³äºæ–æ³¢é‚£å¥‘",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ä¸€ã€å…³äºæ–æ³¢é‚£å¥‘","aria-hidden":"true"},"#"),s(" ä¸€ã€å…³äºæ–æ³¢é‚£å¥‘")],-1),h=n("p",null,[n("code",null,"æ–æ³¢é‚£å¥‘çš„å†å²")],-1),g={href:"https://en.wikipedia.org/wiki/Fibonacci_number#History",target:"_blank",rel:"noopener noreferrer"},f=p('<div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-01.png?raw=true" width="550px"></div><p>æ–æ³¢é‚£å¥‘æ•°åˆ—å¯ä»¥ç”±é€’å½’å…³ç³»å®šä¹‰</p><p>F0 = 0ï¼ŒF1 = 1ï¼ŒFn = Fn-1 + Fn-2</p><table><thead><tr><th style="text-align:center;">F0</th><th style="text-align:center;">F1</th><th style="text-align:center;">F2</th><th style="text-align:center;">F3</th><th style="text-align:center;">F4</th><th style="text-align:center;">F5</th><th style="text-align:center;">F6</th><th style="text-align:center;">F7</th><th style="text-align:center;">F8</th><th style="text-align:center;">F9</th><th style="text-align:center;">F10</th><th style="text-align:center;">F11</th><th style="text-align:center;">F12</th><th style="text-align:center;">F13</th><th style="text-align:center;">F14</th><th style="text-align:center;">F15</th><th style="text-align:center;">F16</th><th style="text-align:center;">F17</th><th style="text-align:center;">F18</th><th style="text-align:center;">F19</th></tr></thead><tbody><tr><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">1</td><td style="text-align:center;">2</td><td style="text-align:center;">3</td><td style="text-align:center;">5</td><td style="text-align:center;">8</td><td style="text-align:center;">13</td><td style="text-align:center;">21</td><td style="text-align:center;">34</td><td style="text-align:center;">55</td><td style="text-align:center;">89</td><td style="text-align:center;">144</td><td style="text-align:center;">233</td><td style="text-align:center;">377</td><td style="text-align:center;">610</td><td style="text-align:center;">987</td><td style="text-align:center;">1597</td><td style="text-align:center;">2584</td><td style="text-align:center;">4181</td></tr></tbody></table><ul><li>ä» F2 å¼€å§‹ä»»æ„ä¸€ä½éƒ½æ˜¯å‰ä¸¤ä½ä¹‹å’Œã€‚</li><li>ä» F2 å¼€å§‹ä»»æ„ä¸€ä½ä¸å‰ä¸€ä½ç›¸æ¯”çš„æ¯”å€¼ï¼Œéƒ½æ— é™è¶‹è¿‘äº (âˆš<em>5</em> - 1)/2 = 0.618 å› æ­¤åŸºäºé»„é‡‘åˆ†å‰²çš„è®¡ç®—åº”ç”¨ï¼Œä¹Ÿè¢«ç§°ä¸ºæ–æ³¢é‚£å¥‘åº”ç”¨ã€‚</li></ul><p>é‚£è¿™ä¸ªå°±æ˜¯æ–æ³¢é‚£å¥‘çš„åŸºæœ¬å®šä¹‰å’Œç‰¹æ€§ï¼Œå¹¶ä¸”åŸºäºè¿™æ ·çš„ç‰¹æ€§åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ–æ³¢é‚£å¥‘å¸¸ç”¨äºï¼›ä¼ªéšæœºæ•°ç”Ÿæˆã€AVLäºŒå‰æ ‘ã€æœ€å¤§å…¬çº¦æ•°ã€åˆå¹¶æ’åºç®—æ³•ç­‰ã€‚</p><p>è€Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜ğŸ‘¨ğŸ»â€ğŸ’»åŒ…æ‹¬å°å‚…å“¥æœ€å¼€å§‹æ„è¯†åˆ°æ–æ³¢é‚£å¥‘çš„åº”ç”¨åˆ™æ¥è‡ªäºï¼ŒJava æºç  ThreadLocal ä¸­ HASH_INCREMENT = <code>0x61c88647</code> è¿™æ ·ä¸€ä¸ªå¸¸é‡çš„å®šä¹‰ã€‚å› ä¸ºè¿™ç”¨ä½œæ•°æ®æ•£åˆ—çš„ç‰¹æ®Šå€¼ <code>0x61c88647</code> å°±æ˜¯åŸºäºé»„é‡‘åˆ†å‰²ç‚¹è®¡ç®—å¾—æ¥çš„ï¼Œå…¬å¼ï¼š<code> (1L &lt;&lt; 32) - (long) ((1L &lt;&lt; 32) * (Math.sqrt(5) - 1))/2</code> ã€‚</p>',7),w={href:"https://bugstack.cn/md/java/interview/2020-09-23-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC12%E7%AF%87%E3%80%8A%E9%9D%A2%E8%AF%95%E5%AE%98%EF%BC%8CThreadLocal%20%E4%BD%A0%E8%A6%81%E8%BF%99%E4%B9%88%E9%97%AE%EF%BC%8C%E6%88%91%E5%B0%B1%E6%8C%82%E4%BA%86%EF%BC%81%E3%80%8B.html",target:"_blank",rel:"noopener noreferrer"},y={href:"https://en.wikipedia.org/wiki/Avalanche_effect",target:"_blank",rel:"noopener noreferrer"},_=n("strong",null,"ä¸¥æ ¼çš„é›ªå´©æ ‡å‡†ï¼ˆSACï¼‰",-1),x=n("h2",{id:"äºŒã€æ–æ³¢é‚£å¥‘è®¡ç®—",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#äºŒã€æ–æ³¢é‚£å¥‘è®¡ç®—","aria-hidden":"true"},"#"),s(" äºŒã€æ–æ³¢é‚£å¥‘è®¡ç®—")],-1),I={href:"https://en.wikipedia.org/wiki/Fibonacci_number#Closed-form_expression",target:"_blank",rel:"noopener noreferrer"},C={href:"https://github.com/fuzhengwei/java-algorithms",target:"_blank",rel:"noopener noreferrer"},F=p(`<h3 id="_1-å¾ªç¯è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_1-å¾ªç¯è®¡ç®—" aria-hidden="true">#</a> 1. å¾ªç¯è®¡ç®—</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> currentVal <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> previousVal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> iterationsCounter <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>iterationsCounter <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        currentVal <span class="token operator">+=</span> previousVal<span class="token punctuation">;</span>
        previousVal <span class="token operator">=</span> currentVal <span class="token operator">-</span> previousVal<span class="token punctuation">;</span>
        iterationsCounter <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> currentVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-é€’å½’è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_2-é€’å½’è®¡ç®—" aria-hidden="true">#</a> 2. é€’å½’è®¡ç®—</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">fibonacciRecursion</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">fibonacciRecursion</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacciRecursion</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-æ¯”å¥ˆå…¬å¼" tabindex="-1"><a class="header-anchor" href="#_3-æ¯”å¥ˆå…¬å¼" aria-hidden="true">#</a> 3. æ¯”å¥ˆå…¬å¼</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">fibonacciClosedForm</span><span class="token punctuation">(</span><span class="token keyword">long</span> position<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> maxPosition <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>position <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> position <span class="token operator">&gt;</span> maxPosition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;Can&#39;t handle position smaller than 1 or greater than 75&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">double</span> sqrt <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> phi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> sqrt<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>phi<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> sqrt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-02.png?raw=true" width="550px"></div><ul><li><strong>å°é—­å¼è¡¨è¾¾å¼</strong>ï¼šä¸ç”±å…·æœ‰å¸¸æ•°ç³»æ•°çš„çº¿æ€§é€’å½’å®šä¹‰çš„æ¯ä¸ªåºåˆ—ä¸€æ ·ï¼Œæ–æ³¢é‚£å¥‘æ•°å…·æœ‰å°é—­å½¢å¼çš„è¡¨è¾¾å¼ã€‚å®ƒè¢«ç§°ä¸ºæ¯”å¥ˆå…¬å¼ï¼Œä»¥æ³•å›½æ•°å­¦å®¶é›…å…‹Â·è²åˆ©æ™®Â·ç›ä¸½Â·æ¯”å†…å‘½åï¼Œå°½ç®¡äºšä¼¯æ‹‰ç½•Â·å¾·Â·è«å¼—å’Œä¸¹å°¼å°”Â·ä¼¯åŠªåˆ©å·²ç»çŸ¥é“å®ƒã€‚</li></ul><h2 id="ä¸‰ã€æ•£åˆ—å‡½æ•°åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æ•£åˆ—å‡½æ•°åˆ†ç±»" aria-hidden="true">#</a> ä¸‰ã€æ•£åˆ—å‡½æ•°åˆ†ç±»</h2><p>æ•£åˆ—å‡½æ•°ï¼ˆè‹±è¯­ï¼šHash functionï¼‰åˆç§°æ•£åˆ—ç®—æ³•ã€å“ˆå¸Œå‡½æ•°ï¼Œæ˜¯ä¸€ç§å°†ä»»æ„å¤§å°çš„æ•°æ®æ˜ å°„åˆ°å›ºå®šå¤§å°å€¼çš„è®¡ç®—æ–¹å¼ã€‚æ•£åˆ—å‡½æ•°è®¡ç®—ç»“æœè¢«ç§°ä¸ºæ•£åˆ—å€¼ã€æ•£åˆ—ç ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ HashMap ä¸­å“ˆå¸Œæ¡¶çš„ç´¢å¼•ä»¥åŠæ•°æ®åº“ä¸­åº“è¡¨çš„è·¯ç”±ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚åœ¨ Java ä¸­å¯¹æ•°æ®çš„æ•£åˆ—ç®—æ³•ï¼šHashMap ç”¨åˆ°çš„æ˜¯ä¸€æ¬¡æ‰°åŠ¨å‡½æ•°ä¸‹çš„å“ˆå¸Œæ•£åˆ—ã€ThreadLocal ç”¨åˆ°çš„æ–æ³¢é‚£å¥‘æ•£åˆ—ã€‚è€Œé€šå¸¸æ•°æ®åº“è·¯ç”±ç»„ä»¶ç”¨åˆ°çš„æ˜¯æ•´æ•°æ¨¡é™¤æ³•æ•£åˆ—ï¼Œè¿™ä¹Ÿæ˜¯å®è·µä¸­æœ€ç®€å•å’Œæœ€å¸¸ç”¨çš„æ–¹æ³•ä¹‹ä¸€ã€‚</p>`,11),M={href:"https://en.wikipedia.org/wiki/Hash_function",target:"_blank",rel:"noopener noreferrer"},j=p(`<div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-03.png?raw=true" width="750px"></div><h3 id="_1-é™¤æ³•æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_1-é™¤æ³•æ•£åˆ—" aria-hidden="true">#</a> 1. é™¤æ³•æ•£åˆ—</h3><p>åœ¨ç”¨æ¥è®¾è®¡æ•£åˆ—å‡½æ•°çš„é™¤æ³•æ•£åˆ—æ³•ä¸­ï¼Œé€šè¿‡å– K é™¤ä»¥ M çš„ä½™æ•°ï¼Œå°†å…³é”®å­— K æ˜ å°„åˆ° M ä¸ªæ§½ä¸­çš„æŸä¸€ä¸ªä½ç½®ä¸Šï¼Œå³æ•£åˆ—å‡½æ•°ä¸ºï¼šh(K) = K mod M è¡¨æ ¼å¤§å°é€šå¸¸æ˜¯ 2 çš„å¹‚ã€‚</p><p>å¦å¤–é™¤æ³•æ•£åˆ—çš„ä¸€ä¸ªæ˜¾ç€ç¼ºç‚¹æ˜¯é™¤æ³•åœ¨å¤§å¤šæ•°ç°ä»£æ¶æ„ï¼ˆåŒ…æ‹¬ x86ï¼‰ä¸Šéƒ½æ˜¯å¾®ç¼–ç¨‹çš„ï¼Œå¹¶ä¸”å¯èƒ½æ¯”ä¹˜æ³•æ…¢ 10 å€ã€‚</p><h3 id="_2-ä¹˜æ³•æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_2-ä¹˜æ³•æ•£åˆ—" aria-hidden="true">#</a> 2. ä¹˜æ³•æ•£åˆ—</h3><p>ä¹˜æ³•æ•£åˆ—æ³•æ•´ä½“åŒ…å«ä¸¤æ­¥ï¼š</p><ul><li>ç”¨å…³é”®å­—kä¹˜ä¸Šå¸¸æ•°<code>A(0&lt;A&lt;1)</code>ï¼Œå¹¶å»é™¤kAçš„å°æ•°éƒ¨åˆ†</li><li>ç”¨mä¹˜ä»¥è¿™ä¸ªå€¼ï¼Œå†å–ç»“æœçš„åº•<code>floor</code> å…¬å¼ï¼š <code>h(K)=Math.floor[m(aK mod 1)]</code></li></ul><p><strong>æ­¥éª¤</strong>ï¼š</p><ul><li>å‡è®¾æŸè®¡ç®—æœºçš„å­—é•¿ä¸º ww ä½ï¼Œè€Œ kk æ­£å¥½å¯å®¹äºä¸€ä¸ªå­—ä¸­<code>(k&lt;2wk&lt;2w)</code></li><li>ç°åœ¨é€‰å–èŒƒå›´<code>[0ï¼Œ2w]</code>å†…çš„ä»»æ„æ•°å€¼ ssï¼ŒkÃ—skÃ—s å³å¯ç”¨<code>R1Â·2w+R0R1Â·2w+R0</code>æ¥è¡¨ç¤º</li><li>å› æ­¤<code>(kÂ·A)mod1=kÂ·s/2w(kÂ·A)mod1=kÂ·s/2w</code>å°±æ˜¯å°†<code>kÃ—skÃ—s</code>æ•´ä½“å‘å³å¹³ç§» ww ä½ï¼Œæ­¤æ—¶R0R0å³ä¸ºå°æ•°éƒ¨åˆ†</li><li>å†ä¹˜ä»¥ 2m2m ç›¸å½“äºå·¦ç§» mm ä½ï¼Œæ•£åˆ—å€¼<code> h(k)h(k)</code> ä¸º R0R0 çš„å‰ m ä½ã€‚</li></ul><p>ä¹˜æ³•æ•£åˆ—åªéœ€è¦å•ä¸ªæ•´æ•°ä¹˜æ³•å’Œå³ç§»ï¼Œä½¿å…¶æˆä¸ºè®¡ç®—é€Ÿåº¦æœ€å¿«çš„å“ˆå¸Œå‡½æ•°ä¹‹ä¸€ã€‚ä½†ä¹˜æ³•æ•£åˆ—å¯èƒ½ä¼šåœ¨å˜æ›´è®¡ç®—å› å­åï¼Œè¾ƒé«˜å€¼çš„è¾“å…¥ä½ä¸ä¼šå½±å“è¾ƒä½å€¼çš„è¾“å‡ºä½ï¼Œé—®é¢˜ä½“ç°åœ¨å…ƒç´ åˆ†æ•£ä¸å‡ï¼Œä¸æ»¡è¶³ä¸¥æ ¼çš„é›ªå´©æ ‡å‡†ã€‚æ‰€ä»¥é€šå¸¸åœ¨ä¼šè¿›è¡Œå¼‚æˆ–æ“ä½œ</p><p>ä¹˜æ³•æ•£åˆ—å®¹æ˜“å—åˆ°å¯¼è‡´æ‰©æ•£ä¸è‰¯çš„â€œå¸¸è§é”™è¯¯â€çš„å½±å“â€”â€”è¾ƒé«˜å€¼çš„è¾“å…¥ä½ä¸ä¼šå½±å“è¾ƒä½å€¼çš„è¾“å‡ºä½ã€‚åœ¨ä¹˜æ³•æ­¥éª¤å¯¹æ­¤è¿›è¡Œæ ¡æ­£ä¹‹å‰ï¼Œè¾“å…¥ä¸Šçš„å˜æ¢å°†ä¿ç•™çš„æœ€é«˜ä½çš„è·¨åº¦å‘ä¸‹ç§»åŠ¨ï¼Œå¹¶å°†å®ƒä»¬å¼‚æˆ–æˆ–åŠ åˆ°é”®ä¸Šã€‚æ‰€ä»¥åœ¨è¾“å…¥ä¸Šçš„å˜æ¢å°†ä¿ç•™çš„æœ€é«˜ä½çš„è·¨åº¦å‘ä¸‹ç§»åŠ¨ï¼Œå¹¶å°†å®ƒä»¬å¼‚æˆ–æ“ä½œæˆ–è€…åŠ åˆ°é”®ä¸Šã€‚ä¾‹å¦‚ HashMap çš„æ‰°åŠ¨å‡½æ•°ã€‚</p><h3 id="_3-æ–æ³¢é‚£å¥‘æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_3-æ–æ³¢é‚£å¥‘æ•£åˆ—" aria-hidden="true">#</a> 3. æ–æ³¢é‚£å¥‘æ•£åˆ—</h3><p>å…¶å®æ–æ³¢é‚£å¥‘æ•£åˆ—æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„ä¹˜æ³•æ•£åˆ—ï¼Œåªä¸è¿‡å®ƒçš„ä¹˜æ³•å› å­é€‰æ‹©çš„æ˜¯ä¸€ä¸ªé»„é‡‘åˆ†å‰²æ¯”ä¾‹å€¼ï¼Œæ‰€ä»¥å«åšæ–æ³¢é‚£å¥‘æ•£åˆ—ã€‚</p><p>æ–æ³¢é‚£å¥‘æ•£åˆ—çš„ç‰¹æ€§åœ¨äºå°†â€œå¤§æ•°æ˜ å°„åˆ°å°æ•°â€çš„è®¡ç®—ç»“æœåœ¨è¡¨ç©ºé—´ä¸Šæ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œä¸”è®¡ç®—æ»¡è¶³ä¹˜æ³•æ•£åˆ—æ•ˆç‡é«˜ã€‚<strong>é‚£ä¸ºä»€ä¹ˆå¹¶ä¸èƒ½ä½¿ç”¨å®ƒä½œä¸ºæ•°æ®åº“è·¯ç”±ç®—æ³•å‘¢ï¼Ÿ</strong></p><h2 id="å››ã€é›ªå´©æ ‡å‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#å››ã€é›ªå´©æ ‡å‡†æµ‹è¯•" aria-hidden="true">#</a> å››ã€é›ªå´©æ ‡å‡†æµ‹è¯•</h2><p>åœ¨æ•°æ®åº“è·¯ç”±å®ç°æ–¹é¢ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨æ•´æ•°æ¨¡é™¤æ³•æ•£åˆ—æ±‚æ¨¡çš„æ–¹å¼è¿›è¡Œå…ƒç´ çš„ç´¢å¼•è®¡ç®—ã€‚é‚£æ—¢ç„¶ä¹˜æ³•æ•£åˆ—æ•ˆç‡é«˜ï¼Œæ–æ³¢é‚£å¥‘æ•£åˆ—åˆ†æ•£å‡åŒ€ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨è¿™æ ·çš„æ–¹å¼å¤„ç†æ•°æ®åº“è·¯ç”±ç®—æ³•å‘¢ï¼Ÿ</p><p>åœ¨æ£€ç´¢çš„èµ„æ–™ä¸­å¹¶æ²¡æœ‰ä¸€ä¸ªä¸“é—¨çš„æ–‡ç« æ¥è¯´æ˜è¿™ä¸€äº‹é¡¹ï¼Œè¿™ä¹Ÿå¯¼è‡´å¾ˆå¤šåœ¨å­¦ä¹ è¿‡ HashMapã€ThreadLocal æºç çš„ç ”å‘äººå‘˜å°è¯•æŠŠè¿™ä¸¤ç§æºç ä¸­çš„ä¹˜æ³•æ•£åˆ—ç®—æ³•æ¬åˆ°æ•°æ®åº“è·¯ç”±ç®—æ³•ä¸­ä½¿ç”¨ã€‚åœ¨ä¿è¯æ¯æ¬¡æ‰©å®¹æ•°æ®åº“è¡¨éƒ½æ˜¯2çš„æ¬¡å¹‚çš„æƒ…å†µä¸‹ï¼Œå¹¶æ²¡æœ‰å‡ºç°ä»€ä¹ˆæ ·çš„é—®é¢˜ã€‚é‚£ä¹ˆå¯¹äºè¿™æ ·æƒ…å†µä¸‹ï¼Œæ˜¯å¦éšè—ç€ä»€ä¹ˆæ½œåœ¨çš„é£é™©å‘¢ï¼Ÿ</p><p>é‚£ä¹ˆä¸ºäº†è¯å®æ–æ³¢é‚£å¥‘æ•£åˆ—æ˜¯å¦å¯ä»¥ç”¨åœ¨æ•°æ®åº“è·¯ç”±æ•£åˆ—ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ <strong>ä¸¥æ ¼é›ªå´©æ ‡å‡†(SAC)</strong> è¿›è¡ŒéªŒè¯æµ‹è¯•ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯<strong>ä¸¥æ ¼é›ªå´©æ ‡å‡†( SAC )</strong> ï¼Œåœ¨å¯†ç å­¦ä¸­ï¼Œé›ªå´©æ•ˆåº”æ˜¯å¯†ç ç®—æ³•çš„ç†æƒ³å±æ€§ï¼Œé€šå¸¸æ˜¯åˆ†ç»„å¯†ç å’Œå¯†ç æ•£åˆ—å‡½æ•°ï¼Œå…¶ä¸­å¦‚æœè¾“å…¥å‘ç”Ÿè½»å¾®å˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œç¿»è½¬å•ä¸ªä½ï¼‰ï¼Œè¾“å‡ºä¼šå‘ç”Ÿæ˜¾ç€å˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œ50%è¾“å‡ºä½ç¿»è½¬ï¼‰</p><p>SAC å»ºç«‹åœ¨å®Œæ•´æ€§å’Œé›ªå´©çš„æ¦‚å¿µä¹‹ä¸Šï¼Œç”± Webster å’Œ Tavares äº 1985 å¹´å¼•å…¥ã€‚SAC çš„é«˜é˜¶æ¦‚æ‹¬æ¶‰åŠå¤šä¸ªè¾“å…¥ä½ã€‚æ»¡è¶³æœ€é«˜é˜¶ SAC çš„æœ€å¤§éçº¿æ€§å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºâ€œå®Œå…¨éçº¿æ€§â€å‡½æ•°ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå½“æˆ‘ä»¬å¯¹æ•°æ®åº“ä»8åº“32è¡¨æ‰©å®¹åˆ°16åº“32è¡¨çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®æ€»é‡éƒ½åº”è¯¥ä»¥50%çš„æ•°é‡è¿›è¡Œå‡å°‘ã€‚è¿™æ ·æ‰æ˜¯åˆç†çš„ã€‚</p><p>å¥½ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥åšä¸‹é›ªå´©æµ‹è¯•ï¼›</p><ol><li>å‡†å¤‡10ä¸‡ä¸ªå•è¯ç”¨ä½œæ ·æœ¬æ•°æ®ã€‚</li><li>å¯¹æ¯”æµ‹è¯•é™¤æ³•æ•£åˆ—ã€ä¹˜æ³•æ•£åˆ—ã€æ–æ³¢é‚£å¥‘æ•£åˆ—ã€‚</li><li>åŸºäºæ¡ä»¶1ã€2ï¼Œå¯¹æ•°æ®é€šè¿‡ä¸åŒçš„æ•£åˆ—ç®—æ³•åˆ†ä¸¤æ¬¡è·¯ç”±åˆ°8åº“32è¡¨å’Œ16åº“32è¡¨ä¸­ï¼ŒéªŒè¯æ¯ä¸ªåŒºé—´å†…æ•°æ®çš„å˜åŒ–æ•°é‡ï¼Œæ˜¯å¦åœ¨50%å·¦å³ã€‚</li><li>å‡†å¤‡ä¸€ä¸ª excel è¡¨ï¼Œæ¥åšæ•°æ®çš„ç»Ÿè®¡è®¡ç®—ã€‚</li></ol><p><strong>æµ‹è¯•ä»£ç </strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token keyword">int</span> dbCount<span class="token punctuation">,</span> <span class="token keyword">int</span> tbCount<span class="token punctuation">,</span> <span class="token class-name">Long</span> hashIncrementVal<span class="token punctuation">,</span> <span class="token keyword">int</span> hashType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> dbCount <span class="token operator">*</span> tbCount<span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;åº“æ•°ï¼š&quot;</span> <span class="token operator">+</span> dbCount <span class="token operator">+</span> <span class="token string">&quot; è¡¨æ•°ï¼š&quot;</span> <span class="token operator">+</span> tbCount <span class="token operator">+</span> <span class="token string">&quot; æ€»å€¼ï¼š&quot;</span> <span class="token operator">+</span> size <span class="token operator">+</span> <span class="token string">&quot; å¹‚å€¼ï¼š&quot;</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">int</span> <span class="token constant">HASH_INCREMENT</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> hashIncrementVal <span class="token operator">?</span> size <span class="token operator">:</span> hashIncrementVal<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; é»„é‡‘åˆ†å‰²ï¼š&quot;</span> <span class="token operator">+</span> <span class="token constant">HASH_INCREMENT</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> size <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token constant">HASH_INCREMENT</span> <span class="token operator">/</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> words <span class="token operator">=</span> <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readWordList</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/fuzhengwei/1024/github/java-algorithms/logic/src/main/java/math/fibonacci/103976ä¸ªè‹±è¯­å•è¯åº“.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; å•è¯æ€»æ•°ï¼š&quot;</span> <span class="token operator">+</span> words<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>hashType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ•£åˆ—ï¼šæ–æ³¢é‚£å¥‘æ•£åˆ—  int idx = (size - 1) &amp; (word.hashCode() * HASH_INCREMENT + HASH_INCREMENT);</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                idx <span class="token operator">=</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">HASH_INCREMENT</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token comment">// æ•£åˆ—ï¼šå“ˆå¸Œæ•£åˆ— + æ‰°åŠ¨å‡½æ•°</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                idx <span class="token operator">=</span> <span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token comment">// æ•£åˆ—ï¼šå“ˆå¸Œæ•£åˆ—</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                idx <span class="token operator">=</span> <span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">/* ^ (word.hashCode() &gt;&gt;&gt; 16)*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token comment">// æ•£åˆ—ï¼šæ•´æ•°æ±‚æ¨¡</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                idx <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> size<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      
        <span class="token comment">// è®¡ç®—è·¯ç”±ç´¢å¼•</span>
        <span class="token keyword">int</span> dbIdx <span class="token operator">=</span> idx <span class="token operator">/</span> tbCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> tbIdx <span class="token operator">=</span> idx <span class="token operator">-</span> tbCount <span class="token operator">*</span> <span class="token punctuation">(</span>dbIdx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token comment">// ä¿å­˜è·¯ç”±ç»“æœ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>dbIdx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> dbCountMap <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>dbIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>dbCountMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>tbIdx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dbCountMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tbIdx<span class="token punctuation">,</span> dbCountMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tbIdx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                dbCountMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tbIdx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> dbCountMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dbCountMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tbIdx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>dbIdx<span class="token punctuation">,</span> dbCountMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ•´ä¸ªæ–¹æ³•çš„ç›®çš„åœ¨äºå¾—å‡ºä¸åŒçš„å“ˆå¸Œç®—æ³•ï¼Œå¯¹10ä¸‡ä¸ªå•è¯æ•£åˆ—åˆ°æŒ‡å®šçš„åˆ†åº“åˆ†è¡¨ä¸­ï¼Œæ‰€ä½“ç°çš„ç»“æœã€‚</li></ul><h3 id="_1-æ–æ³¢é‚£å¥‘æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_1-æ–æ³¢é‚£å¥‘æ•£åˆ—" aria-hidden="true">#</a> 1. æ–æ³¢é‚£å¥‘æ•£åˆ—</h3><h4 id="_1-1-æœ€å°é»„é‡‘åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#_1-1-æœ€å°é»„é‡‘åˆ†å‰²" aria-hidden="true">#</a> 1.1 æœ€å°é»„é‡‘åˆ†å‰²</h4><p>æ–æ³¢é‚£å¥‘æ•£åˆ—ä¹Ÿæ˜¯ä¹˜æ³•æ•£åˆ—çš„ä¸€ç§ä½“ç°å½¢å¼ï¼Œåªä¸è¿‡å®ƒé€‰æ‹©äº†ä¸€ä¸ªé»„é‡‘åˆ†å‰²ç‚¹ä½œä¸ºä¹˜ç§¯å› å­ã€‚ä¾‹å¦‚ ThreadLocal ä¸­çš„ <code>0x61c88647</code>ã€‚ä½†å¦‚æœè¯´æˆ‘ä»¬åªæ˜¯æŒ‰ç…§ä¸€ä¸ªæŒ‡å®šèŒƒå›´é•¿åº¦å†…åšé»„é‡‘åˆ†å‰²è®¡ç®—ï¼Œå¹¶æ‹¿è¿™ä¸ªç»“æœå½“æˆä¹˜æ³•æ•£åˆ—çš„å› å­ï¼Œé‚£ä¹ˆ10ä¸‡å•è¯å°†ä¸ä¼šå‡åŒ€çš„æ•£åˆ—åˆ°8ä¸ªåº“ï¼Œ32å¼ è¡¨å†…ã€‚å¦‚å›¾ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_hashFunction_0_hash_null</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> fibonacci<span class="token punctuation">.</span><span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>åº“æ•°ï¼š<span class="token number">8</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">256</span> å¹‚å€¼ï¼š<span class="token number">8.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">256</span> <span class="token operator">=</span> <span class="token number">8388607.99609375</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-04.png?raw=true" width="950px"></div>`,32),E={href:"https://bugstack.cn/md/algorithm/logic/math/2022-10-30-bits.html",target:"_blank",rel:"noopener noreferrer"},S=p(`<h4 id="_1-2-æœ€å¤§é»„é‡‘åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#_1-2-æœ€å¤§é»„é‡‘åˆ†å‰²" aria-hidden="true">#</a> 1.2 æœ€å¤§é»„é‡‘åˆ†å‰²</h4><p>åŸºäºæœ€å°é»„é‡‘åˆ†å‰²çš„è®¡ç®—ï¼Œæ˜¯æ²¡æ³•åšåˆ°å‡åŒ€æ•£åˆ—çš„ã€‚æ‰€ä»¥ä½ çœ‹åˆ°çš„ ThreadLocal é»˜è®¤å°±ç»™ä½ ä¸€ä¸ª <code>0x61c88647</code> è€Œä¸æ˜¯éšç€æ‰©å®¹é•¿åº¦å®æ—¶è®¡ç®—çš„åˆ‡å‰²å€¼ã€‚å¥½é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥ä¹Ÿä½¿ç”¨è¿™ä¸ªå€¼æ¥åšè®¡ç®—ï¼Œçœ‹çœ‹8åº“åˆ°16åº“åï¼Œæ•°æ®çš„é›ªå´©ç»“æœã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_hashFunction_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> fibonacci<span class="token punctuation">.</span><span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1L</span> <span class="token operator">&lt;&lt;</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åˆ†åˆ«æµ‹è¯• dbCount = 8ã€dbCount = 16</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>åº“æ•°ï¼š<span class="token number">8</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>

åº“æ•°ï¼š<span class="token number">16</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-05.png?raw=true" width="950px"></div><ul><li>ä»8åº“æ‰©åˆ°16åº“ä»¥åï¼Œæ»¡è¶³50%æ•°æ®å˜åŒ–çš„ï¼Œåªæœ‰2åº“2è¡¨å’Œ3åº“20è¡¨ã€‚å…¶ä»–æ•°æ®å˜åŒ–éƒ½ä¸æ»¡è¶³ä¸¥æ ¼çš„é›ªå´©æµ‹è¯•ã€‚</li></ul><h4 id="_1-3-ä»»æ„æ‰©å®¹åº“è¡¨" tabindex="-1"><a class="header-anchor" href="#_1-3-ä»»æ„æ‰©å®¹åº“è¡¨" aria-hidden="true">#</a> 1.3 ä»»æ„æ‰©å®¹åº“è¡¨</h4><p>é€šå¸¸æƒ…å†µä¸‹åšåˆ†åº“åˆ†è¡¨ä¼šè€ƒè™‘åˆ°ä»¥åçš„æ‰©å®¹æ“ä½œï¼Œé‚£å¦‚æœè¯´æŒ‰ç…§2çš„æ¬¡å¹‚æ‰©å®¹ç¬¬ä¸€æ¬¡æ˜¯8åº“32è¡¨ï¼Œä¹‹åæ˜¯16åº“32è¡¨ï¼Œåœ¨ä¹‹å32åº“32è¡¨ã€‚é‚£ä¹ˆè¿™æ ·æ‰©å®¹ä¸‹å»ï¼Œå…¶å®æ˜¯æ‰›ä¸ä½çš„ã€‚æ‰€ä»¥å¤§å¤šæ•°æ—¶å€™å¸Œæœ›æ˜¯ä»8åº“æ‰©åˆ°9åº“ï¼Œè€Œä¸æ˜¯ä¸€ä¸‹ç¿»å€ã€‚é‚£æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹9åº“32è¡¨ï¼Œæ–æ³¢é‚£å¥‘æ•£åˆ—çš„åˆ†æ•£æ•ˆæœã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> fibonacci<span class="token punctuation">.</span><span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1L</span> <span class="token operator">&lt;&lt;</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>åº“æ•°ï¼š<span class="token number">9</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-06.png?raw=true" width="950px"></div><ul><li>å› ä¸º9åº“ä¸æ»¡è¶³2çš„æ¬¡å¹‚ï¼Œä¹Ÿå°±æ²¡æ³•ç›´æ¥ä¹˜æ³•æ•£åˆ—ã€‚æ‰€ä»¥ç›¸å½“äºæ–æ³¢é‚£å¥‘æ•£åˆ—å¤±æ•ˆäº†ã€‚è¿™å¦‚æœæ˜¯çº¿ä¸Šçš„ç”Ÿäº§ç¯å¢ƒï¼Œå°†å‘ç”Ÿç¾éš¾æ€§çš„äº‹æ•…ã€‚</li></ul><h3 id="_2-æ•´æ•°æ±‚æ¨¡æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_2-æ•´æ•°æ±‚æ¨¡æ•£åˆ—" aria-hidden="true">#</a> 2. æ•´æ•°æ±‚æ¨¡æ•£åˆ—</h3><h4 id="_2-1-åŸºç¡€æ•£åˆ—è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_2-1-åŸºç¡€æ•£åˆ—è®¡ç®—" aria-hidden="true">#</a> 2.1 åŸºç¡€æ•£åˆ—è®¡ç®—</h4><p>æ•´æ•°æ±‚æ¨¡ä»¥æ•°æ®åº“è¡¨æ€»æ•°ä¸ºé™¤æ•°ï¼Œä¸å“ˆå¸Œå€¼çš„ç»å¯¹å€¼è¿›è¡Œé™¤æ³•æ•£åˆ—è®¡ç®—ã€‚ä¸€èˆ¬åœ¨æ•°æ®åº“è·¯ç”±ä¸­éå¸¸å¸¸ç”¨ã€‚å¦å¤–å¦‚æœæ ¹æ®ç”¨æˆ·IDåšæ•£åˆ—è·¯ç”±ï¼Œä½†ç”±äºIDé•¿åº¦æ³¢åŠ¨èŒƒå›´è¾ƒå¤§ï¼Œåˆ™å¯ä»¥æŒ‰ç…§æŒ‡å®šé•¿åº¦ç»Ÿä¸€åˆ‡å‰²åä½¿ç”¨ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_hashFunction_3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> fibonacci<span class="token punctuation">.</span><span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åˆ†åˆ«æµ‹è¯• dbCount = 8ã€dbCount = 16</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>åº“æ•°ï¼š<span class="token number">8</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>

åº“æ•°ï¼š<span class="token number">16</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-07.png?raw=true" width="950px"></div><ul><li>åœ¨ä½¿ç”¨é™¤æ³•æ•£åˆ—æ–¹å¼åï¼Œæ»¡è¶³50%æ•°æ®å˜åŒ–çš„æœ‰5ä¸ªè¡¨ã€‚çœ‹ç€å¹¶ä¸å¤šï¼Œä½†è¿™ç›¸å½“äºæ˜¯æ–æ³¢é‚£å¥‘æ•£åˆ—ä¸‹çš„3å€ã€‚åŒæ—¶å…¶ä»–è¡¨æ•°æ®æ¥è¿‘50%çš„ä¹Ÿè¦å¤§äºæ–æ³¢é‚£å¥‘æ•£åˆ—ã€‚</li></ul><h4 id="_2-2-ä»»æ„æ‰©å®¹è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_2-2-ä»»æ„æ‰©å®¹è®¡ç®—" aria-hidden="true">#</a> 2.2 ä»»æ„æ‰©å®¹è®¡ç®—</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»»æ„ä»8åº“æ‰©å®¹åˆ°9åº“ï¼Œçœ‹çœ‹æ•°æ®çš„å˜åŒ–ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_hashFunction_3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> fibonacci<span class="token punctuation">.</span><span class="token function">hashFunction</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>åº“æ•°ï¼š<span class="token number">9</span> è¡¨æ•°ï¼š<span class="token number">32</span> æ€»å€¼ï¼š<span class="token number">512</span> å¹‚å€¼ï¼š<span class="token number">9.0</span> é»„é‡‘åˆ†å‰²ï¼š<span class="token number">2147483647</span><span class="token operator">/</span><span class="token number">512</span> <span class="token operator">=</span> <span class="token number">4194303.998046875</span> å•è¯æ€»æ•°ï¼š<span class="token number">103976</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div align="center"><img src="https://bugstack.cn/images/article/algorithm/logic/fibonacci-08.png?raw=true" width="950px"></div><ul><li>103976 / (9 * 32) â‰ˆ 361ï¼Œé‚£ä¹ˆä¹Ÿå°±è¯´æ‰©å®¹åçš„æ•°æ®ï¼ŒåŸºæœ¬åœ¨361èŒƒå›´æ³¢åŠ¨ï¼Œå°±æ»¡è¶³äº†å‡åŒ€æ•£åˆ—çš„ç›®çš„ã€‚æ‰€ä»¥åœ¨æ•°æ®åº“æ•£åˆ—ç®—æ³•ä¸­ï¼Œé™¤æ³•æ•£åˆ—æ˜¯è¾ƒé è°±ä¸”ç¨³å®šçš„ã€‚</li></ul><h2 id="äº”ã€å¸¸è§é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#äº”ã€å¸¸è§é¢è¯•é¢˜" aria-hidden="true">#</a> äº”ã€å¸¸è§é¢è¯•é¢˜</h2><ul><li>æ•£åˆ—ç®—æ³•æœ‰å“ªäº›ç§ï¼Ÿ</li><li>HashMapã€ThreadLocalã€æ•°æ®åº“è·¯ç”±éƒ½æ˜¯ç”¨äº†ä»€ä¹ˆæ•£åˆ—ç®—æ³•ï¼Ÿ</li><li>ä¹˜æ³•æ•£åˆ—ä¸ºä»€ä¹ˆè¦ç”¨2çš„å¹‚å€¼ä½œä¸ºæ¯æ¬¡çš„æ‰©å®¹æ¡ä»¶ï¼Ÿ</li><li>ä½ æœ‰äº†è§£è¿‡ <code>0x61c88647</code> æ˜¯æ€ä¹ˆè®¡ç®—çš„å—ï¼Ÿ</li><li>æ–æ³¢é‚£å¥‘æ•£åˆ—çš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><hr>`,30),A={href:"https://en.wikipedia.org/wiki/The_Fibonacci_Association",target:"_blank",rel:"noopener noreferrer"},q={href:"https://en.wikipedia.org/wiki/Hash_function",target:"_blank",rel:"noopener noreferrer"},H={href:"https://en.wikipedia.org/wiki/Fibonacci_number#Mathematics",target:"_blank",rel:"noopener noreferrer"},T={href:"https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8",target:"_blank",rel:"noopener noreferrer"},z={href:"https://en.wikipedia.org/wiki/Avalanche_effect",target:"_blank",rel:"noopener noreferrer"},B={href:"https://probablydance.com/2018/06/16/fibonacci-hashing-the-optimization-that-the-world-forgot-or-a-better-alternative-to-integer-modulo/",target:"_blank",rel:"noopener noreferrer"},R={href:"https://en.wikipedia.org/wiki/Fibonacci_number#Relation_to_the_golden_ratio",target:"_blank",rel:"noopener noreferrer"},L={href:"https://book.huihoo.com/data-structures-and-algorithms-with-object-oriented-design-patterns-in-c++/html/page214.html",target:"_blank",rel:"noopener noreferrer"};function N(V,K){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),t(a)]),d,s("æºç ï¼š"),n("a",m,[s("https://github.com/fuzhengwei/java-algorithms"),t(a)])]),v,b,h,n("p",null,[s("æ–æ³¢é‚£å¥‘æ•°åˆ—å‡ºç°åœ¨"),n("a",g,[s("å°åº¦æ•°å­¦"),t(a)]),s("ä¸­ï¼Œä¸æ¢µæ–‡éŸµå¾‹æœ‰å…³ã€‚åœ¨æ¢µè¯­è¯—æ­Œä¼ ç»Ÿä¸­ï¼Œäººä»¬å¯¹åˆ—ä¸¾æ‰€æœ‰æŒç»­æ—¶é—´ä¸º 2 å•ä½çš„é•¿ (L) éŸ³èŠ‚ä¸ 1 å•ä½æŒç»­æ—¶é—´çš„çŸ­ (S) éŸ³èŠ‚å¹¶åˆ—çš„æ¨¡å¼å¾ˆæ„Ÿå…´è¶£ã€‚ç”¨ç»™å®šçš„æ€»æŒç»­æ—¶é—´è®¡ç®—è¿ç»­ L å’Œ S çš„ä¸åŒæ¨¡å¼ä¼šäº§ç”Ÿæ–æ³¢é‚£å¥‘æ•°ï¼šæŒç»­æ—¶é—´må•ä½çš„æ¨¡å¼æ•°é‡æ˜¯F(m + 1)ã€‚")]),f,n("p",null,[s("é‚£ä¹ˆæ—¢ç„¶ "),n("a",w,[s("ThreadLocal æ˜¯åŸºäºæ–æ³¢é‚£å¥‘æ•£åˆ—è®¡ç®—çš„ä¸‹æ ‡ç´¢å¼•"),t(a)]),s("ï¼Œé‚£ä¸ºå•¥æ•°æ®åº“è·¯ç”±ç®—æ³•ä¸èƒ½ä½¿ç”¨åŒæ ·çš„æ–¹å¼è®¡ç®—æ•£åˆ—ç´¢å¼•å‘¢ï¼Ÿå› ä¸ºé€šè¿‡éªŒè¯å¯ä»¥å¾—çŸ¥ï¼Œæ–æ³¢é‚£å¥‘æ•£åˆ—å¹¶ä¸æ»¡è¶³"),n("a",y,[_,t(a)]),s("ã€‚æ¥ä¸‹æ¥å°å‚…å“¥å°±å¸¦ç€å¤§å®¶ä¸€èµ·æ¥ä½¿ç”¨æ•°æ®éªŒè¯ä¸‹ã€‚")]),x,n("p",null,[s("æ–æ³¢é‚£å¥‘æ•°åˆ—å¯ä»¥é€šè¿‡å¾ªç¯ã€é€’å½’ä»¥åŠ"),n("a",I,[s("å°é—­å¼è¡¨è¾¾å¼ï¼ˆæ¯”å¥ˆå…¬å¼ï¼‰"),t(a)]),s(" çš„æ–¹å¼è¿›è¡Œè®¡ç®—ã€‚è¯»è€…å¯åœ¨å•å…ƒæµ‹è¯•ä¸­éªŒè¯ï¼š"),n("a",C,[s("https://github.com/fuzhengwei/java-algorithms"),t(a)])]),F,n("p",null,[s("æ¥ä¸‹æ¥å°±ç»™å¤§å®¶ä»‹ç»è¿™å‡ ç§å¸¸ç”¨çš„æ•£åˆ—ç®—æ³•ï¼Œå…¶ä»–æ›´å¤šæ•£åˆ—å¯ä»¥å‚è€ƒ "),n("a",M,[s("HashFunction"),t(a)])]),j,n("ul",null,[n("li",null,[s("å¦‚æœä½ çš„æ–æ³¢é‚£å¥‘æ•£åˆ—å€¼æ˜¯æ ¹æ®åº“è¡¨çš„å€¼è¿›è¡Œé»„é‡‘åˆ‡å‰²çš„ï¼Œé‚£ä¹ˆåœ¨æœ€åˆçš„åº“è¡¨èŒƒå›´è¾ƒå°çš„é˜¶æ®µï¼Œå°†æœ‰éƒ¨åˆ†åŒºåŸŸæ— æ³•ä½¿ç”¨ã€‚è¿™æ˜¯å› ä¸ºå¾—åˆ°çš„é»„é‡‘åˆ†å‰²ç‚¹çš„äºŒè¿›åˆ¶å€¼æ²¡æ³•è¦†ç›–æ•´ä¸ªåŒºåŸŸï¼Œä¹Ÿå°±åšä¸åˆ°åˆé€‚çš„ä¹˜æ³•æ•£åˆ—è®¡ç®—ã€‚å‚è€ƒï¼š"),n("a",E,[s("https://bugstack.cn/md/algorithm/logic/math/2022-10-30-bits.html"),t(a)]),s(" - ã€Šç¨‹åºå‘˜æ•°å­¦ï¼šä½è¿ç®—ã€‹")])]),S,n("ul",null,[n("li",null,[s("The Fibonacci Associationï¼š"),n("a",A,[s("https://en.wikipedia.org/wiki/The_Fibonacci_Association"),t(a)])]),n("li",null,[s("å“ˆå¸Œå‡½æ•°ï¼š"),n("a",q,[s("https://en.wikipedia.org/wiki/Hash_function"),t(a)])]),n("li",null,[s("æ–æ³¢é‚£å¥‘æ•°ï¼š"),n("a",H,[s("https://en.wikipedia.org/wiki/Fibonacci_number#Mathematics"),t(a)])]),n("li",null,[s("æ•£åˆ—å‡½æ•°ï¼š"),n("a",T,[s("https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8"),t(a)])]),n("li",null,[s("é›ªå´©æ•ˆåº”ï¼š"),n("a",z,[s("https://en.wikipedia.org/wiki/Avalanche_effect"),t(a)])]),n("li",null,[s("Fibonacci Hashing: The Optimization that the World Forgot (or: a Better Alternative to Integer Modulo)ï¼š"),n("a",B,[s("https://probablydance.com/2018/06/16/fibonacci-hashing-the-optimization-that-the-world-forgot-or-a-better-alternative-to-integer-modulo/"),t(a)])]),n("li",null,[s("æ–æ³¢é‚£å¥‘æ•°ï¼š"),n("a",R,[s("https://en.wikipedia.org/wiki/Fibonacci_number#Relation_to_the_golden_ratio"),t(a)])]),n("li",null,[s("C++ ä¸­å…·æœ‰é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼çš„æ•°æ®ç»“æ„å’Œç®—æ³•ï¼š"),n("a",L,[s("https://book.huihoo.com/data-structures-and-algorithms-with-object-oriented-design-patterns-in-c++/html/page214.html"),t(a)])])])])}const W=e(i,[["render",N],["__file","2022-11-05-fibonacci.html.vue"]]);export{W as default};
