import{_ as p,r as e,o,c,a as n,b as s,d as t,e as l}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"ã€Šmybatis-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬8ç« -æŠŠåå°„ç”¨åˆ°å‡ºç¥å…¥åŒ–",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ã€Šmybatis-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬8ç« -æŠŠåå°„ç”¨åˆ°å‡ºç¥å…¥åŒ–","aria-hidden":"true"},"#"),s(" ã€ŠMybatis æ‰‹æ’¸ä¸“æ ã€‹ç¬¬8ç« ï¼šæŠŠåå°„ç”¨åˆ°å‡ºç¥å…¥åŒ–")],-1),k=n("br",null,null,-1),r={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("br",null,null,-1),m={href:"https://mp.weixin.qq.com/s/FNgAruzgFebXZiOk0XZT4A",target:"_blank",rel:"noopener noreferrer"},v=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),b=n("iframe",{id:"B-Video",src:"//player.bilibili.com/player.html?aid=898907420&bvid=BV1gN4y1L7NR&cid=789356841&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"480"}," ",-1),g=n("h2",{id:"ä¸€ã€å‰è¨€",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ä¸€ã€å‰è¨€","aria-hidden":"true"},"#"),s(" ä¸€ã€å‰è¨€")],-1),y=n("p",null,[n("code",null,"ä¸ºä»€ä¹ˆï¼Œè¯»ä¸æ‡‚æ¡†æ¶æºç ï¼Ÿ")],-1),h=n("p",null,"æˆ‘ä»¬éƒ½çŸ¥é“ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œå¦‚æœæƒ³å­¦ä¹ åˆ°æ›´æ·±å±‚æ¬¡çš„æŠ€æœ¯ï¼Œå°±éœ€è¦é˜…è¯»å¤§é‡çš„æ¡†æ¶æºç ï¼Œå­¦ä¹ è¿™äº›æ¡†æ¶æºç ä¸­çš„å¼€å‘å¥—è·¯å’Œè®¾è®¡æ€æƒ³ï¼Œä»è€Œæå‡è‡ªå·±çš„ç¼–ç¨‹èƒ½åŠ›ã€‚",-1),f=n("p",null,"äº‹å¤§å®¶éƒ½æ¸…æ¥šï¼Œä½†åœ¨å®æ“ä¸Šï¼Œå¾ˆå¤šç å†œæ ¹æœ¬æ²¡æ³•é˜…è¯»æ¡†æ¶æºç ã€‚é¦–å…ˆä¸€ä¸ªéå¸¸å¤§çš„é—®é¢˜æ˜¯ï¼Œé¢å¯¹å¦‚æ­¤åºå¤§çš„æ¡†æ¶æºç ï¼Œä¸çŸ¥é“ä»å“ªä¸‹æ‰‹ã€‚ä¸å¹³å¸¸çš„ä¸šåŠ¡éœ€æ±‚å¼€å‘ç›¸æ¯”ï¼Œæ¡†æ¶æºç ä¸­è¿ç”¨äº†å¤§é‡çš„è®¾è®¡åŸåˆ™å’Œè®¾è®¡æ¨¡å¼å¯¹ç³»ç»ŸåŠŸèƒ½è¿›è¡Œè§£è€¦å’Œå®ç°ï¼Œä¹Ÿä½¿ç”¨äº†ä¸å°‘å¦‚åå°„ã€ä»£ç†ã€å­—èŠ‚ç ç­‰ç›¸å…³æŠ€æœ¯ã€‚",-1),w=n("p",null,"å½“ä½ è¿˜ä»¥ä¸ºæ˜¯å¹³å¸¸çš„ä¸šåŠ¡éœ€æ±‚ä¸­çš„å®ä¾‹åŒ–å¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œå»æ‰¾å¯»æºç ä¸­çš„æµç¨‹æ—¶ï¼Œå¯èƒ½æ ¹æœ¬å°±æ‰¾ä¸åˆ°å®ƒæ˜¯ä½•æ—¶å‘èµ·è°ƒç”¨çš„ã€æ€ä¹ˆè¿›è¡Œä¼ å‚ã€åœ¨å“ªå¤„ç†èµ‹å€¼çš„ç­‰ä¸€è¿ä¸²çš„é—®é¢˜ï¼Œéƒ½æŠŠä¸€ä¸ªå¥½ç å†œåŠé€€åœ¨å¼€å§‹å­¦ä¹ çš„è·¯ä¸Šã€‚",-1),j=n("h2",{id:"äºŒã€ç›®æ ‡",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#äºŒã€ç›®æ ‡","aria-hidden":"true"},"#"),s(" äºŒã€ç›®æ ‡")],-1),q={href:"https://mp.weixin.qq.com/s/smohXRphj-FejvrP-FOgBw",target:"_blank",rel:"noopener noreferrer"},O=l(`<p><img src="https://bugstack.cn/images/article/spring/mybatis-220506-01.png" alt="å›¾ 8-1 æ•°æ®æºæ± åŒ–é…ç½®è·å–"></p><ul><li>ä¹Ÿå°±æ˜¯ <code>props.getProperty(&quot;driver&quot;)</code>ã€<code>props.getProperty(&quot;url&quot;)</code> ç­‰å±æ€§ï¼Œéƒ½æ˜¯é€šè¿‡æ‰‹åŠ¨ç¼–ç çš„æ–¹å¼è·å–çš„ã€‚</li><li>é‚£å…¶å®åƒ driverã€urlã€usernameã€password ä¸éƒ½æ˜¯æ ‡å‡†çš„å›ºå®šå­—æ®µå—ï¼Œè¿™æ ·è·å–æœ‰ä»€ä¹ˆä¸å¯¹çš„ã€‚å¦‚æœæŒ‰ç…§æˆ‘ä»¬ç°åœ¨çš„ç†è§£æ¥è¯´ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸å¯¹ï¼Œä½†å…¶å®é™¤äº†è¿™äº›å­—æ®µä»¥å¤–ï¼Œå¯èƒ½è¿˜æœ‰æ—¶å€™ä¼šé…ç½®ä¸€äº›æ‰©å±•å­—æ®µï¼Œé‚£ä¹ˆæ€ä¹ˆè·å–å‘¢ï¼Œæ€»ä¸èƒ½æ¯æ¬¡éƒ½æ˜¯ç¡¬ç¼–ç ã€‚</li><li>æ‰€ä»¥å¦‚æœä½ æœ‰é˜…è¯» Mybatis çš„æºç ï¼Œä¼šå‘ç°è¿™é‡Œä½¿ç”¨äº† Mybatis è‡ªå·±å®ç°çš„å…ƒå¯¹è±¡åå°„å·¥å…·ç±»ï¼Œå¯ä»¥å®Œæˆä¸€ä¸ªå¯¹è±¡çš„å±æ€§çš„åå°„å¡«å……ã€‚è¿™å—çš„å·¥å…·ç±»å«åš MetaObject å¹¶æä¾›ç›¸åº”çš„ï¼›å…ƒå¯¹è±¡ã€å¯¹è±¡åŒ…è£…å™¨ã€å¯¹è±¡å·¥å‚ã€å¯¹è±¡åŒ…è£…å·¥å‚ä»¥åŠ Reflector åå°„å™¨çš„ä½¿ç”¨ã€‚é‚£ä¹ˆæœ¬ç« èŠ‚æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹åå°„å·¥å…·åŒ…çš„å†…å®¹ï¼Œå› ä¸ºéšç€æˆ‘ä»¬åç»­çš„å¼€å‘ï¼Œä¹Ÿä¼šæœ‰å¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦ä½¿ç”¨åå°„å™¨ä¼˜é›…çš„å¤„ç†æˆ‘ä»¬çš„å±æ€§ä¿¡æ¯ã€‚<strong>è¿™ä¹Ÿèƒ½ä¸ºä½ æ·»åŠ ä¸€äº›å…³äºåå°„çš„å¼ºå¤§çš„ä½¿ç”¨ï¼</strong></li></ul><h2 id="ä¸‰ã€è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€è®¾è®¡" aria-hidden="true">#</a> ä¸‰ã€è®¾è®¡</h2><p>å¦‚æœè¯´æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ‰€æä¾›çš„å±æ€§è¿›è¡Œç»Ÿä¸€çš„è®¾ç½®å’Œè·å–å€¼çš„æ“ä½œï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠå½“å‰è¿™ä¸ªè¢«å¤„ç†çš„å¯¹è±¡è¿›è¡Œè§£è€¦ï¼Œæå–å‡ºå®ƒæ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶æŒ‰ç…§ä¸åŒçš„ç±»å‹è¿›è¡Œåå°„å¤„ç†ï¼Œä»è€ŒåŒ…è£…æˆä¸€ä¸ªå·¥å…·åŒ…ã€‚å¦‚å›¾ 8-2 æ‰€ç¤º</p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220506-02.png" alt="å›¾ 8-2 å¯¹è±¡å±æ€§åå°„å¤„ç†"></p><ul><li>å…¶å®æ•´ä¸ªè®¾è®¡è¿‡ç¨‹éƒ½ä»¥å›´ç»•å¦‚ä½•æ‹†è§£å¯¹è±¡å¹¶æä¾›åå°„æ“ä½œä¸ºä¸»ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªå¯¹è±¡æ¥è¯´ï¼Œå®ƒæ‰€åŒ…æ‹¬çš„æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°ã€å¯¹è±¡çš„å±æ€§ã€å¯¹è±¡çš„æ–¹æ³•ã€‚è€Œå¯¹è±¡çš„æ–¹æ³•å› ä¸ºéƒ½æ˜¯è·å–å’Œè®¾ç½®å€¼çš„æ“ä½œï¼Œæ‰€ä»¥åŸºæœ¬éƒ½æ˜¯getã€setå¤„ç†ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™äº›æ–¹æ³•åœ¨å¯¹è±¡æ‹†è§£çš„è¿‡ç¨‹ä¸­éœ€è¦æ‘˜å–å‡ºæ¥è¿›è¡Œä¿å­˜ã€‚</li><li>å½“çœŸæ­£çš„å¼€å§‹æ“ä½œæ—¶ï¼Œåˆ™ä¼šä¾èµ–äºå·²ç»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œå±æ€§å¤„ç†ã€‚è€Œè¿™äº›å¤„ç†è¿‡ç¨‹å®é™…éƒ½æ˜¯åœ¨ä½¿ç”¨ JDK æ‰€æä¾›çš„åå°„è¿›è¡Œæ“ä½œçš„ï¼Œè€Œåå°„è¿‡ç¨‹ä¸­çš„æ–¹æ³•åç§°ã€å…¥å‚ç±»å‹éƒ½å·²ç»è¢«æˆ‘ä»¬æ‹†è§£å’Œå¤„ç†äº†ï¼Œæœ€ç»ˆä½¿ç”¨çš„æ—¶å€™ç›´æ¥è°ƒç”¨å³å¯ã€‚</li></ul><h2 id="å››ã€å®ç°" tabindex="-1"><a class="header-anchor" href="#å››ã€å®ç°" aria-hidden="true">#</a> å››ã€å®ç°</h2><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>mybatis<span class="token operator">-</span>step<span class="token operator">-</span><span class="token number">07</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis
    â”‚           â”œâ”€â”€ binding
    â”‚           â”œâ”€â”€ builder
    â”‚           â”œâ”€â”€ datasource
    â”‚           â”‚   â”œâ”€â”€ druid
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ pooled
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">PooledConnection</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">PooledDataSource</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">PooledDataSourceFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">PoolState</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ unpooled
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">UnpooledDataSource</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">UnpooledDataSourceFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">DataSourceFactory</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ executor
    â”‚           â”œâ”€â”€ io
    â”‚           â”œâ”€â”€ mapping
    â”‚           â”œâ”€â”€ reflection
    â”‚           â”‚   â”œâ”€â”€ factory
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultObjectFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">ObjectFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ invoker
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">GetFieldInvoker</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">Invoker</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">MethodInvoker</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">SetFieldInvoker</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ property
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">PropertyNamer</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">PropertyTokenizer</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ wrapper
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BaseWrapper</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanWrapper</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">CollectionWrapper</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultObjectWrapperFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">MapWrapper</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">ObjectWrapper</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">ObjectWrapperFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MetaClass</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MetaObject</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">Reflector</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ session
    â”‚           â”œâ”€â”€ transaction
    â”‚           â””â”€â”€ type
    â””â”€â”€ test
        â”œâ”€â”€ java
        â”‚   â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span>dao
        â”‚       â”œâ”€â”€ dao
        â”‚       â”‚   â””â”€â”€ <span class="token class-name">IUserDao</span><span class="token punctuation">.</span>java
        â”‚       â”œâ”€â”€ po
        â”‚       â”‚   â””â”€â”€ <span class="token class-name">User</span><span class="token punctuation">.</span>java
        â”‚       â”œâ”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
        â”‚       â””â”€â”€ <span class="token class-name">ReflectionTest</span><span class="token punctuation">.</span>java
        â””â”€â”€ resources
            â”œâ”€â”€ mapper
            â”‚   â””â”€â”€<span class="token class-name">User_Mapper</span><span class="token punctuation">.</span>xml
            â””â”€â”€ mybatis<span class="token operator">-</span>config<span class="token operator">-</span>datasource<span class="token punctuation">.</span>xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å·¥ç¨‹æºç </strong>ï¼š<code>å…¬ä¼—å·ã€Œbugstackè™«æ´æ ˆã€ï¼Œå›å¤ï¼šæ‰‹å†™Mybatisï¼Œè·å–å®Œæ•´æºç </code></p><p>å…ƒå¯¹è±¡åå°„å·¥å…·ç±»ï¼Œå¤„ç†å¯¹è±¡çš„å±æ€§è®¾ç½®å’Œè·å–æ“ä½œæ ¸å¿ƒç±»ï¼Œå¦‚å›¾ 8-3 æ‰€ç¤º</p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220506-03.png" alt="å›¾ 8-3 æ‰€ç¤º å…ƒå¯¹è±¡åå°„å·¥å…·ç±»ï¼Œå¤„ç†å¯¹è±¡çš„å±æ€§è®¾ç½®å’Œè·å–æ“ä½œæ ¸å¿ƒç±»"></p><ul><li>ä»¥ Reflector åå°„å™¨ç±»å¤„ç†å¯¹è±¡ç±»ä¸­çš„ get/set å±æ€§ï¼ŒåŒ…è£…ä¸ºå¯è°ƒç”¨çš„ Invoker åå°„ç±»ï¼Œè¿™æ ·åœ¨å¯¹ get/set æ–¹æ³•åå°„è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨æ–¹æ³•åç§°è·å–å¯¹åº”çš„ Invoker å³å¯ <code>getGetInvoker(String propertyName)</code>ã€‚</li><li>æœ‰äº†åå°„å™¨çš„å¤„ç†ï¼Œä¹‹åå°±æ˜¯å¯¹åŸå¯¹è±¡çš„åŒ…è£…äº†ï¼Œç”± SystemMetaObject æä¾›åˆ›å»º MetaObject å…ƒå¯¹è±¡çš„æ–¹æ³•ï¼Œå°†æˆ‘ä»¬éœ€è¦å¤„ç†çš„å¯¹è±¡è¿›è¡Œæ‹†è§£å’Œ ObjectWrapper å¯¹è±¡åŒ…è£…å¤„ç†ã€‚å› ä¸ºä¸€ä¸ªå¯¹è±¡çš„ç±»å‹è¿˜éœ€è¦è¿›è¡Œä¸€æ¡ç»†èŠ‚çš„å¤„ç†ï¼Œä»¥åŠå±æ€§ä¿¡æ¯çš„æ‹†è§£ï¼Œä¾‹å¦‚ï¼š<code>ç­çº§[0].å­¦ç”Ÿ.æˆç»©</code> è¿™æ ·ä¸€ä¸ªç±»ä¸­çš„å…³è”ç±»çš„å±æ€§ï¼Œåˆ™éœ€è¦è¿›è¡Œé€’å½’çš„æ–¹å¼æ‹†è§£å¤„ç†åï¼Œæ‰èƒ½è®¾ç½®å’Œè·å–å±æ€§å€¼ã€‚</li><li>æœ€ç»ˆåœ¨ Mybatis å…¶ä»–çš„åœ°æ–¹å°±å¯ä»¥ï¼Œæœ‰éœ€è¦å±æ€§å€¼è®¾å®šæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨åˆ°åå°„å·¥å…·åŒ…è¿›è¡Œå¤„ç†äº†ã€‚è¿™é‡Œé¦–å½“å…¶å†²çš„æˆ‘ä»¬ä¼šæŠŠæ•°æ®æºæ± åŒ–ä¸­å…³äº Properties å±æ€§çš„å¤„ç†ä½¿ç”¨åå°„å·¥å…·ç±»è¿›è¡Œæ”¹é€ ã€‚<em>å‚è€ƒæœ¬ç« èŠ‚ä¸­å¯¹åº”çš„æºç ç±»</em></li></ul><h3 id="_2-åå°„è°ƒç”¨è€…" tabindex="-1"><a class="header-anchor" href="#_2-åå°„è°ƒç”¨è€…" aria-hidden="true">#</a> 2. åå°„è°ƒç”¨è€…</h3><p>å…³äºå¯¹è±¡ç±»ä¸­çš„å±æ€§å€¼è·å–å’Œè®¾ç½®å¯ä»¥åˆ†ä¸º Field å­—æ®µçš„ get/set è¿˜æœ‰æ™®é€šçš„ Method çš„è°ƒç”¨ï¼Œä¸ºäº†å‡å°‘ä½¿ç”¨æ–¹çš„è¿‡å¤šçš„å¤„ç†ï¼Œè¿™é‡Œå¯ä»¥æŠŠé›†ä¸­è°ƒç”¨è€…çš„å®ç°åŒ…è£…æˆè°ƒç”¨ç­–ç•¥ï¼Œç»Ÿä¸€æ¥å£ä¸åŒç­–ç•¥ä¸åŒçš„å®ç°ç±»ã€‚</p><p><strong>å®šä¹‰æ¥å£</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Invoker</span> <span class="token punctuation">{</span>

    <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ— è®ºä»»ä½•ç±»å‹çš„åå°„è°ƒç”¨ï¼Œéƒ½ç¦»ä¸å¼€å¯¹è±¡å’Œå…¥å‚ï¼Œåªè¦æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªå­—æ®µå’Œè¿”å›ç»“æœå®šä¹‰çš„é€šç”¨ï¼Œå°±å¯ä»¥åŒ…ä½ä¸åŒç­–ç•¥çš„å®ç°ç±»äº†ã€‚</li></ul><h4 id="_2-1-methodinvoker" tabindex="-1"><a class="header-anchor" href="#_2-1-methodinvoker" aria-hidden="true">#</a> 2.1 MethodInvoker</h4><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.invoker.MethodInvoker</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodInvoker</span> <span class="token keyword">implements</span> <span class="token class-name">Invoker</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Method</span> method<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æä¾›æ–¹æ³•åå°„è°ƒç”¨å¤„ç†ï¼Œæ„é€ å‡½æ•°ä¼šä¼ å…¥å¯¹åº”çš„æ–¹æ³•ç±»å‹ã€‚</li></ul><h4 id="_2-2-getfieldinvoker" tabindex="-1"><a class="header-anchor" href="#_2-2-getfieldinvoker" aria-hidden="true">#</a> 2.2 GetFieldInvoker</h4><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.invoker.GetFieldInvoker</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetFieldInvoker</span> <span class="token keyword">implements</span> <span class="token class-name">Invoker</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Field</span> field<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> field<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>getter æ–¹æ³•çš„è°ƒç”¨è€…å¤„ç†ï¼Œå› ä¸ºgetæ˜¯æœ‰è¿”å›å€¼çš„ï¼Œæ‰€ä»¥ç›´æ¥å¯¹ Field å­—æ®µæ“ä½œå®Œåç›´æ¥è¿”å›ç»“æœã€‚</li></ul><h4 id="_2-3-setfieldinvoker" tabindex="-1"><a class="header-anchor" href="#_2-3-setfieldinvoker" aria-hidden="true">#</a> 2.3 SetFieldInvoker</h4><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.invoker.SetFieldInvoker</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SetFieldInvoker</span> <span class="token keyword">implements</span> <span class="token class-name">Invoker</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Field</span> field<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>setter æ–¹æ³•çš„è°ƒç”¨è€…å¤„ç†ï¼Œå› ä¸ºsetåªæ˜¯è®¾ç½®å€¼ï¼Œæ‰€ä»¥è¿™é‡Œå°±åªè¿”å›ä¸€ä¸ª null å°±å¯ä»¥äº†ã€‚</li></ul><h3 id="_3-åå°„å™¨è§£è€¦å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3-åå°„å™¨è§£è€¦å¯¹è±¡" aria-hidden="true">#</a> 3. åå°„å™¨è§£è€¦å¯¹è±¡</h3><p>Reflector åå°„å™¨ä¸“é—¨ç”¨äºè§£è€¦å¯¹è±¡ä¿¡æ¯çš„ï¼Œåªæœ‰æŠŠä¸€ä¸ªå¯¹è±¡ä¿¡æ¯æ‰€å«å¸¦çš„å±æ€§ã€æ–¹æ³•ä»¥åŠå…³è”çš„ç±»éƒ½ä»¥æ­¤è§£æå‡ºæ¥ï¼Œæ‰èƒ½æ»¡è¶³åç»­å¯¹å±æ€§å€¼çš„è®¾ç½®å’Œè·å–ã€‚</p><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.Reflector</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Reflector</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> classCacheEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">EMPTY_STRING_ARRAY</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// çº¿ç¨‹å®‰å…¨çš„ç¼“å­˜</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Reflector</span><span class="token punctuation">&gt;</span></span> <span class="token constant">REFLECTOR_MAP</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">;</span>
    <span class="token comment">// get å±æ€§åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> readablePropertyNames <span class="token operator">=</span> <span class="token constant">EMPTY_STRING_ARRAY</span><span class="token punctuation">;</span>
    <span class="token comment">// set å±æ€§åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> writeablePropertyNames <span class="token operator">=</span> <span class="token constant">EMPTY_STRING_ARRAY</span><span class="token punctuation">;</span>
    <span class="token comment">// set æ–¹æ³•åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Invoker</span><span class="token punctuation">&gt;</span></span> setMethods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// get æ–¹æ³•åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Invoker</span><span class="token punctuation">&gt;</span></span> getMethods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set ç±»å‹åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> setTypes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// get ç±»å‹åˆ—è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> getTypes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ„é€ å‡½æ•°</span>
    <span class="token keyword">private</span> <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> defaultConstructor<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> caseInsensitivePropertyMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Reflector</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> clazz<span class="token punctuation">;</span>
        <span class="token comment">// åŠ å…¥æ„é€ å‡½æ•°</span>
        <span class="token function">addDefaultConstructor</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å…¥ getter</span>
        <span class="token function">addGetMethods</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å…¥ setter</span>
        <span class="token function">addSetMethods</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å…¥å­—æ®µ</span>
        <span class="token function">addFields</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        readablePropertyNames <span class="token operator">=</span> getMethods<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>getMethods<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeablePropertyNames <span class="token operator">=</span> setMethods<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>setMethods<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> propName <span class="token operator">:</span> readablePropertyNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            caseInsensitivePropertyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>propName<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">ENGLISH</span><span class="token punctuation">)</span><span class="token punctuation">,</span> propName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> propName <span class="token operator">:</span> writeablePropertyNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            caseInsensitivePropertyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>propName<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">ENGLISH</span><span class="token punctuation">)</span><span class="token punctuation">,</span> propName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// ... çœç•¥å¤„ç†æ–¹æ³•</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Reflector åå°„å™¨ç±»ä¸­æä¾›äº†å„ç±»å±æ€§ã€æ–¹æ³•ã€ç±»å‹ä»¥åŠæ„é€ å‡½æ•°çš„ä¿å­˜æ“ä½œï¼Œå½“è°ƒç”¨åå°„å™¨æ—¶ä¼šé€šè¿‡æ„é€ å‡½æ•°çš„å¤„ç†ï¼Œé€æ­¥ä»å¯¹è±¡ç±»ä¸­æ‹†è§£å‡ºè¿™äº›å±æ€§ä¿¡æ¯ï¼Œä¾¿äºåç»­åå°„ä½¿ç”¨ã€‚</li><li>è¯»è€…åœ¨å¯¹è¿™éƒ¨åˆ†æºç å­¦ä¹ æ—¶ï¼Œå¯ä»¥å‚è€ƒå¯¹åº”çš„ç±»å’Œè¿™é‡Œçš„å¤„ç†æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯ä¸€äº›å¯¹åå°„çš„æ“ä½œï¼Œè·å–å‡ºåŸºæœ¬çš„ç±»å‹ã€æ–¹æ³•ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œæ•´ç†å­˜æ”¾ã€‚</li></ul><h3 id="_4-å…ƒç±»åŒ…è£…åå°„å™¨" tabindex="-1"><a class="header-anchor" href="#_4-å…ƒç±»åŒ…è£…åå°„å™¨" aria-hidden="true">#</a> 4. å…ƒç±»åŒ…è£…åå°„å™¨</h3><p>Reflector åå°„å™¨ç±»æä¾›çš„æ˜¯æœ€åŸºç¡€çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¾ˆå¤šæ–¹æ³•ä¹Ÿéƒ½æ˜¯ç§æœ‰çš„ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„ä½¿ç”¨ï¼Œè¿˜éœ€è¦åšä¸€å±‚å…ƒç±»çš„åŒ…è£…ã€‚åœ¨å…ƒç±» MetaClass æä¾›å¿…è¦çš„åˆ›å»ºåå°„å™¨ä»¥åŠä½¿ç”¨åå°„å™¨è·å– get/set çš„ Invoker åå°„æ–¹æ³•ã€‚</p><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.MetaClass</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MetaClass</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Reflector</span> reflector<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">MetaClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>reflector <span class="token operator">=</span> <span class="token class-name">Reflector</span><span class="token punctuation">.</span><span class="token function">forClass</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MetaClass</span> <span class="token function">forClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MetaClass</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getGetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> reflector<span class="token punctuation">.</span><span class="token function">getGetablePropertyNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getSetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> reflector<span class="token punctuation">.</span><span class="token function">getSetablePropertyNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Invoker</span> <span class="token function">getGetInvoker</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> reflector<span class="token punctuation">.</span><span class="token function">getGetInvoker</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Invoker</span> <span class="token function">getSetInvoker</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> reflector<span class="token punctuation">.</span><span class="token function">getSetInvoker</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

		<span class="token comment">// ... æ–¹æ³•åŒ…è£…</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>MetaClass å…ƒç±»ç›¸å½“äºæ˜¯å¯¹æˆ‘ä»¬éœ€è¦å¤„ç†å¯¹è±¡çš„åŒ…è£…ï¼Œè§£è€¦ä¸€ä¸ªåŸå¯¹è±¡ï¼ŒåŒ…è£…å‡ºä¸€ä¸ªå…ƒç±»ã€‚è€Œè¿™äº›å…ƒç±»ã€å¯¹è±¡åŒ…è£…å™¨ä»¥åŠå¯¹è±¡å·¥å‚ç­‰ï¼Œå†ç»„åˆå‡ºä¸€ä¸ªå…ƒå¯¹è±¡ã€‚ç›¸å½“äºè¯´è¿™äº›å…ƒç±»å’Œå…ƒå¯¹è±¡éƒ½æ˜¯å¯¹æˆ‘ä»¬éœ€è¦æ“ä½œçš„åŸå¯¹è±¡è§£è€¦åçš„å°è£…ã€‚æœ‰äº†è¿™æ ·çš„æ“ä½œï¼Œå°±å¯ä»¥è®©æˆ‘ä»¬å¤„ç†æ¯ä¸€ä¸ªå±æ€§æˆ–è€…æ–¹æ³•äº†ã€‚</li></ul><h3 id="_5-å¯¹è±¡åŒ…è£…å™¨wrapper" tabindex="-1"><a class="header-anchor" href="#_5-å¯¹è±¡åŒ…è£…å™¨wrapper" aria-hidden="true">#</a> 5. å¯¹è±¡åŒ…è£…å™¨Wrapper</h3><p>å¯¹è±¡åŒ…è£…å™¨ç›¸å½“äºæ˜¯æ›´åŠ è¿›ä¸€æ­¥åå°„è°ƒç”¨åŒ…è£…å¤„ç†ï¼ŒåŒæ—¶ä¹Ÿä¸ºä¸åŒçš„å¯¹è±¡ç±»å‹æä¾›ä¸åŒçš„åŒ…è£…ç­–ç•¥ã€‚<em>æ¡†æ¶æºç éƒ½å–œæ¬¢ä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼Œä»æ¥ä¸æ˜¯ä¸€è¡Œè¡Œifelseçš„ä»£ç </em></p><p>åœ¨å¯¹è±¡åŒ…è£…å™¨æ¥å£ä¸­å®šä¹‰äº†æ›´åŠ æ˜ç¡®çš„éœ€è¦ä½¿ç”¨çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬å®šä¹‰å‡ºäº† get/set æ ‡å‡†çš„é€šç”¨æ–¹æ³•ã€è·å–get\\setå±æ€§åç§°å’Œå±æ€§ç±»å‹ï¼Œä»¥åŠæ·»åŠ å±æ€§ç­‰æ“ä½œã€‚</p><p><strong>å¯¹è±¡åŒ…è£…å™¨æ¥å£</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ObjectWrapper</span> <span class="token punctuation">{</span>

    <span class="token comment">// get</span>
    <span class="token class-name">Object</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">PropertyTokenizer</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// set</span>
    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">PropertyTokenizer</span> prop<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æŸ¥æ‰¾å±æ€§</span>
    <span class="token class-name">String</span> <span class="token function">findProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> useCamelCaseMapping<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å–å¾—getterçš„åå­—åˆ—è¡¨</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getGetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å–å¾—setterçš„åå­—åˆ—è¡¨</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getSetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//å–å¾—setterçš„ç±»å‹</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSetterType</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å–å¾—getterçš„ç±»å‹</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getGetterType</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ... çœç•¥</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åç»­æ‰€æœ‰å®ç°äº†å¯¹è±¡åŒ…è£…å™¨æ¥å£çš„å®ç°ç±»ï¼Œéƒ½éœ€è¦æä¾›è¿™äº›æ–¹æ³•å®ç°ï¼ŒåŸºæœ¬æœ‰äº†è¿™äº›æ–¹æ³•ï¼Œä¹Ÿå°±èƒ½éå¸¸å®¹æ˜“çš„å¤„ç†ä¸€ä¸ªå¯¹è±¡çš„åå°„æ“ä½œäº†ã€‚</li><li>æ— è®ºä½ æ˜¯è®¾ç½®å±æ€§ã€è·å–å±æ€§ã€æ‹¿åˆ°å¯¹åº”çš„å­—æ®µåˆ—è¡¨è¿˜æ˜¯ç±»å‹éƒ½æ˜¯å¯ä»¥æ»¡è¶³çš„ã€‚</li></ul><h3 id="_6-å…ƒå¯¹è±¡å°è£…" tabindex="-1"><a class="header-anchor" href="#_6-å…ƒå¯¹è±¡å°è£…" aria-hidden="true">#</a> 6. å…ƒå¯¹è±¡å°è£…</h3><p>åœ¨æœ‰äº†åå°„å™¨ã€å…ƒç±»ã€å¯¹è±¡åŒ…è£…å™¨ä»¥åï¼Œåœ¨ä½¿ç”¨å¯¹è±¡å·¥å‚å’ŒåŒ…è£…å·¥å‚ï¼Œå°±å¯ä»¥ç»„åˆå‡ºä¸€ä¸ªå®Œæ•´çš„å…ƒå¯¹è±¡æ“ä½œç±»äº†ã€‚å› ä¸ºæ‰€æœ‰çš„ä¸åŒæ–¹å¼çš„ä½¿ç”¨ï¼ŒåŒ…æ‹¬ï¼šåŒ…è£…å™¨ç­–ç•¥ã€åŒ…è£…å·¥ç¨‹ã€ç»Ÿä¸€çš„æ–¹æ³•å¤„ç†ï¼Œè¿™äº›éƒ½éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†æ–¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å…ƒå¯¹è±¡è¿›è¡Œç®¡ç†ã€‚</p><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.reflection.MetaObject</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MetaObject</span> <span class="token punctuation">{</span>
    <span class="token comment">// åŸå¯¹è±¡</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> originalObject<span class="token punctuation">;</span>
    <span class="token comment">// å¯¹è±¡åŒ…è£…å™¨</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectWrapper</span> objectWrapper<span class="token punctuation">;</span>
    <span class="token comment">// å¯¹è±¡å·¥å‚</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectFactory</span> objectFactory<span class="token punctuation">;</span>
    <span class="token comment">// å¯¹è±¡åŒ…è£…å·¥å‚</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectWrapperFactory</span> objectWrapperFactory<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">MetaObject</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">ObjectFactory</span> objectFactory<span class="token punctuation">,</span> <span class="token class-name">ObjectWrapperFactory</span> objectWrapperFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>originalObject <span class="token operator">=</span> object<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>objectFactory <span class="token operator">=</span> objectFactory<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapperFactory <span class="token operator">=</span> objectWrapperFactory<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token class-name">ObjectWrapper</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœå¯¹è±¡æœ¬èº«å·²ç»æ˜¯ObjectWrapperå‹ï¼Œåˆ™ç›´æ¥èµ‹ç»™objectWrapper</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapper <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ObjectWrapper</span><span class="token punctuation">)</span> object<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>objectWrapperFactory<span class="token punctuation">.</span><span class="token function">hasWrapperFor</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæœ‰åŒ…è£…å™¨,è°ƒç”¨ObjectWrapperFactory.getWrapperFor</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapper <span class="token operator">=</span> objectWrapperFactory<span class="token punctuation">.</span><span class="token function">getWrapperFor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæ˜¯Mapå‹ï¼Œè¿”å›MapWrapper</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapWrapper</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">)</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token class-name">Collection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæ˜¯Collectionå‹ï¼Œè¿”å›CollectionWrapper</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CollectionWrapper</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token punctuation">)</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// é™¤æ­¤ä»¥å¤–ï¼Œè¿”å›BeanWrapper</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapper</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MetaObject</span> <span class="token function">forObject</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">ObjectFactory</span> objectFactory<span class="token punctuation">,</span> <span class="token class-name">ObjectWrapperFactory</span> objectWrapperFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¤„ç†ä¸€ä¸‹null,å°†nullåŒ…è£…èµ·æ¥</span>
            <span class="token keyword">return</span> <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span><span class="token constant">NULL_META_OBJECT</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MetaObject</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> objectFactory<span class="token punctuation">,</span> objectWrapperFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// å–å¾—å€¼</span>
    <span class="token comment">// å¦‚ ç­çº§[0].å­¦ç”Ÿ.æˆç»©</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PropertyTokenizer</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyTokenizer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">MetaObject</span> metaValue <span class="token operator">=</span> <span class="token function">metaObjectForProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">getIndexedName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>metaValue <span class="token operator">==</span> <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span><span class="token constant">NULL_META_OBJECT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å¦‚æœä¸Šå±‚å°±æ˜¯nulläº†ï¼Œé‚£å°±ç»“æŸï¼Œè¿”å›null</span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// å¦åˆ™ç»§ç»­çœ‹ä¸‹ä¸€å±‚ï¼Œé€’å½’è°ƒç”¨getValue</span>
                <span class="token keyword">return</span> metaValue<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> objectWrapper<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è®¾ç½®å€¼</span>
    <span class="token comment">// å¦‚ ç­çº§[0].å­¦ç”Ÿ.æˆç»©</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PropertyTokenizer</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyTokenizer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">MetaObject</span> metaValue <span class="token operator">=</span> <span class="token function">metaObjectForProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">getIndexedName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>metaValue <span class="token operator">==</span> <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span><span class="token constant">NULL_META_OBJECT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> prop<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// don&#39;t instantiate child path if value is null</span>
                    <span class="token comment">// å¦‚æœä¸Šå±‚å°±æ˜¯ null äº†ï¼Œè¿˜å¾—çœ‹æœ‰æ²¡æœ‰å„¿å­ï¼Œæ²¡æœ‰é‚£å°±ç»“æŸ</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment">// å¦åˆ™è¿˜å¾— new ä¸€ä¸ªï¼Œå§”æ´¾ç»™ ObjectWrapper.instantiatePropertyValue</span>
                    metaValue <span class="token operator">=</span> objectWrapper<span class="token punctuation">.</span><span class="token function">instantiatePropertyValue</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> objectFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// é€’å½’è°ƒç”¨setValue</span>
            metaValue<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>prop<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ°äº†æœ€åä¸€å±‚äº†ï¼Œæ‰€ä»¥å§”æ´¾ç»™ ObjectWrapper.set</span>
            objectWrapper<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// ... çœç•¥</span>
<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>MetaObject å…ƒå¯¹è±¡ç®—æ˜¯æ•´ä¸ªæœåŠ¡çš„åŒ…è£…ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­æä¾›å„ç±»å¯¹è±¡çš„åŒ…è£…å™¨ç±»å‹çš„åˆ›å»ºã€‚ä¹‹åæä¾›äº†ä¸€äº›åŸºæœ¬çš„æ“ä½œå°è£…ï¼Œè¿™å›å°è£…åå°±æ›´è´´è¿‘å®é™…çš„ä½¿ç”¨äº†ã€‚</li><li>åŒ…æ‹¬è¿™é‡Œæä¾›çš„ getValue(String name) ã€setValue(String name, Object value) ç­‰ï¼Œå…¶ä¸­å½“ä¸€äº›å¯¹è±¡çš„ä¸­çš„å±æ€§ä¿¡æ¯ä¸æ˜¯ä¸€ä¸ªå±‚æ¬¡ï¼Œæ˜¯ <code>ç­çº§[0].å­¦ç”Ÿ.æˆç»©</code> è¿˜éœ€è¦è¢«æ‹†è§£åæ‰èƒ½è·å–åˆ°å¯¹åº”çš„å¯¹è±¡å’Œå±æ€§å€¼ã€‚</li><li>å½“æ‰€æœ‰çš„è¿™äº›å†…å®¹æä¾›å®Œæˆä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>SystemMetaObject#forObject</code> æä¾›å…ƒå¯¹è±¡çš„è·å–äº†ã€‚</li></ul><h3 id="_7-æ•°æ®æºå±æ€§è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#_7-æ•°æ®æºå±æ€§è®¾ç½®" aria-hidden="true">#</a> 7. æ•°æ®æºå±æ€§è®¾ç½®</h3><p>å¥½äº†ï¼Œç°åœ¨æœ‰äº†æˆ‘ä»¬å®ç°çš„å±æ€§åå°„æ“ä½œå·¥å…·åŒ…ï¼Œé‚£ä¹ˆå¯¹äºæ•°æ®æºä¸­å±æ€§ä¿¡æ¯çš„è®¾ç½®ï¼Œå°±å¯ä»¥æ›´åŠ ä¼˜é›…çš„æ“ä½œäº†ã€‚</p><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.datasource.unpooled.UnpooledDataSourceFactory</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UnpooledDataSourceFactory</span> <span class="token keyword">implements</span> <span class="token class-name">DataSourceFactory</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UnpooledDataSourceFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UnpooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setProperties</span><span class="token punctuation">(</span><span class="token class-name">Properties</span> props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MetaObject</span> metaObject <span class="token operator">=</span> <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span><span class="token function">forObject</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> key <span class="token operator">:</span> props<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> propertyName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> key<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">hasSetter</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> props<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Object</span> convertedValue <span class="token operator">=</span> <span class="token function">convertValue</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">,</span> propertyName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                metaObject<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">,</span> convertedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ä¹‹å‰æˆ‘ä»¬å¯¹äºæ•°æ®æºä¸­å±æ€§ä¿¡æ¯çš„è·å–éƒ½æ˜¯é‡‡ç”¨çš„ç¡¬ç¼–ç ï¼Œé‚£ä¹ˆè¿™å›åœ¨ setProperties æ–¹æ³•ä¸­åˆ™å¯ä»¥ä½¿ç”¨ SystemMetaObject.forObject(dataSource) è·å– DataSource çš„å…ƒå¯¹è±¡äº†ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡åå°„å°±èƒ½æŠŠæˆ‘ä»¬éœ€è¦çš„å±æ€§å€¼è®¾ç½®è¿›å»ã€‚</li><li>è¿™æ ·åœ¨æ•°æ®æº UnpooledDataSourceã€PooledDataSource ä¸­å°±å¯ä»¥æ‹¿åˆ°å¯¹åº”çš„å±æ€§å€¼ä¿¡æ¯äº†ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬é‚£ç§åœ¨2ä¸ªæ•°æ®æºçš„å®ç°ä¸­ç¡¬ç¼–ç æ“ä½œã€‚</li></ul><h2 id="äº”ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#äº”ã€æµ‹è¯•" aria-hidden="true">#</a> äº”ã€æµ‹è¯•</h2><p>æœ¬ç« èŠ‚çš„æµ‹è¯•ä¼šåˆ†ä¸º2éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æˆ‘ä»¬è¿™ä¸ªç« èŠ‚å®ç°çš„åå°„å™¨å·¥å…·ç±»çš„æµ‹è¯•ï¼Œå¦å¤–ä¸€æ–¹é¢æ˜¯æˆ‘ä»¬æŠŠåå°„å™¨å·¥å…·ç±»æ¥å…¥åˆ°æ•°æ®æºçš„ä½¿ç”¨ä¸­ï¼ŒéªŒè¯ä½¿ç”¨æ˜¯å¦é¡ºåˆ©ã€‚</p><h3 id="_1-äº‹å…ˆå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-äº‹å…ˆå‡†å¤‡" aria-hidden="true">#</a> 1. äº‹å…ˆå‡†å¤‡</h3><h4 id="_1-1-åˆ›å»ºåº“è¡¨" tabindex="-1"><a class="header-anchor" href="#_1-1-åˆ›å»ºåº“è¡¨" aria-hidden="true">#</a> 1.1 åˆ›å»ºåº“è¡¨</h4><p>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“åç§°ä¸º mybatis å¹¶åœ¨åº“ä¸­åˆ›å»ºè¡¨ user ä»¥åŠæ·»åŠ æµ‹è¯•æ•°æ®ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>
    <span class="token keyword">USER</span>
    <span class="token punctuation">(</span>
        id <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;è‡ªå¢ID&#39;</span><span class="token punctuation">,</span>
        userId <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ç”¨æˆ·ID&#39;</span><span class="token punctuation">,</span>
        userHead <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ç”¨æˆ·å¤´åƒ&#39;</span><span class="token punctuation">,</span>
        createTime <span class="token keyword">TIMESTAMP</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="token punctuation">,</span>
        updateTime <span class="token keyword">TIMESTAMP</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;æ›´æ–°æ—¶é—´&#39;</span><span class="token punctuation">,</span>
        userName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
    
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> userId<span class="token punctuation">,</span> userHead<span class="token punctuation">,</span> createTime<span class="token punctuation">,</span> updateTime<span class="token punctuation">,</span> userName<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;10001&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1_04&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-13 00:00:00&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-13 00:00:00&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å°å‚…å“¥&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-2-é…ç½®æ•°æ®æº" tabindex="-1"><a class="header-anchor" href="#_1-2-é…ç½®æ•°æ®æº" aria-hidden="true">#</a> 1.2 é…ç½®æ•°æ®æº</h4><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>development<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>development<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://127.0.0.1:3306/mybatis?useUnicode=true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>123456<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€šè¿‡ <code>mybatis-config-datasource.xml</code> é…ç½®æ•°æ®æºä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šdriverã€urlã€usernameã€password</li><li>åœ¨è¿™é‡Œ dataSource æµ‹è¯•éªŒè¯ UNPOOLED å’Œ POOLEDï¼Œå› ä¸ºè¿™2ä¸ªéƒ½å±äºè¢«åå°„å·¥å…·ç±»å¤„ç†</li></ul><h4 id="_1-3-é…ç½®mapper" tabindex="-1"><a class="header-anchor" href="#_1-3-é…ç½®mapper" aria-hidden="true">#</a> 1.3 é…ç½®Mapper</h4><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>queryUserInfoById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.lang.Long<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.bugstack.mybatis.test.po.User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    SELECT id, userId, userName, userHead
    FROM user
    where id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™éƒ¨åˆ†æš‚æ—¶ä¸éœ€è¦è°ƒæ•´ï¼Œç›®å‰è¿˜åªæ˜¯ä¸€ä¸ªå…¥å‚çš„ç±»å‹çš„å‚æ•°ï¼Œåç»­æˆ‘ä»¬å…¨éƒ¨å®Œå–„è¿™éƒ¨åˆ†å†…å®¹ä»¥åï¼Œåˆ™å†æä¾›æ›´å¤šçš„å…¶ä»–å‚æ•°è¿›è¡ŒéªŒè¯ã€‚</li></ul><h3 id="_2-å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 2. å•å…ƒæµ‹è¯•</h3><h4 id="_2-1-åå°„ç±»æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-1-åå°„ç±»æµ‹è¯•" aria-hidden="true">#</a> 2.1 åå°„ç±»æµ‹è¯•</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_reflection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Teacher</span> teacher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher<span class="token punctuation">.</span>Student</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Teacher<span class="token punctuation">.</span>Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    teacher<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    teacher<span class="token punctuation">.</span><span class="token function">setStudents</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">MetaObject</span> metaObject <span class="token operator">=</span> <span class="token class-name">SystemMetaObject</span><span class="token punctuation">.</span><span class="token function">forObject</span><span class="token punctuation">(</span>teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>

    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;getGetterNamesï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">getGetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;getSetterNamesï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">getSetterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;nameçš„getæ–¹æ³•è¿”å›å€¼ï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">getGetterType</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;studentsçš„setæ–¹æ³•å‚æ•°å€¼ï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">getGetterType</span><span class="token punctuation">(</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;nameçš„hasGetterï¼š{}&quot;</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">.</span><span class="token function">hasGetter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;student.idï¼ˆå±æ€§ä¸ºå¯¹è±¡ï¼‰çš„hasGetterï¼š{}&quot;</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">.</span><span class="token function">hasGetter</span><span class="token punctuation">(</span><span class="token string">&quot;student.id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–nameçš„å±æ€§å€¼ï¼š{}&quot;</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// é‡æ–°è®¾ç½®å±æ€§å€¼</span>
    metaObject<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ç™½&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è®¾ç½®nameçš„å±æ€§å€¼ï¼š{}&quot;</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®å±æ€§ï¼ˆé›†åˆï¼‰çš„å…ƒç´ å€¼</span>
    metaObject<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;students[0].id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–studentsé›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å±æ€§å€¼ï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;students[0].id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¹è±¡çš„åºåˆ—åŒ–ï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>teacher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™æ˜¯ä¸€ç»„æ¯”è¾ƒå¸¸è§çš„ç”¨äºæµ‹è¯• Mybatis æºç ä¸­ MetaObject çš„æµ‹è¯•ç±»ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå•å…ƒæµ‹è¯•ç”¨åˆ°æˆ‘ä»¬è‡ªå·±å®ç°çš„åå°„å·¥å…·ç±»ä¸Šï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.601</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> getGetterNamesï¼š<span class="token punctuation">[</span><span class="token string">&quot;student&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">]</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.608</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> getSetterNamesï¼š<span class="token punctuation">[</span><span class="token string">&quot;student&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">]</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.609</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> nameçš„getæ–¹æ³•è¿”å›å€¼ï¼š<span class="token string">&quot;java.lang.String&quot;</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.609</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> studentsçš„setæ–¹æ³•å‚æ•°å€¼ï¼š<span class="token string">&quot;java.util.List&quot;</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.609</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> nameçš„hasGetterï¼š<span class="token boolean">true</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.609</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> student<span class="token punctuation">.</span>idï¼ˆå±æ€§ä¸ºå¯¹è±¡ï¼‰çš„hasGetterï¼š<span class="token boolean">true</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.610</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> è·å–nameçš„å±æ€§å€¼ï¼šå°å‚…å“¥
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.610</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> è®¾ç½®nameçš„å±æ€§å€¼ï¼šå°ç™½
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.610</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> è·å–studentsé›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å±æ€§å€¼ï¼š<span class="token string">&quot;001&quot;</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">44</span><span class="token operator">:</span><span class="token number">23.665</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ReflectionTest</span> <span class="token operator">-</span> å¯¹è±¡çš„åºåˆ—åŒ–ï¼š<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;å°ç™½&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token string">&quot;students&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¥½äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæµ‹è¯•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†å¯¹åº”çš„å±æ€§ä¿¡æ¯ï¼Œå¹¶å¯ä»¥è®¾ç½®ä»¥åŠä¿®æ”¹å±æ€§å€¼ï¼Œæ— è®ºæ˜¯å•ä¸ªå±æ€§è¿˜æ˜¯å¯¹è±¡å±æ€§ï¼Œéƒ½å¯ä»¥æ“ä½œã€‚</li></ul><h4 id="_2-2-æ•°æ®æºæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-2-æ•°æ®æºæµ‹è¯•" aria-hidden="true">#</a> 2.2 æ•°æ®æºæµ‹è¯•</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_SqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. ä»SqlSessionFactoryä¸­è·å–SqlSession</span>
    <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">&quot;mybatis-config-datasource.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. è·å–æ˜ å°„å™¨å¯¹è±¡</span>
    <span class="token class-name">IUserDao</span> userDao <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">IUserDao</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. æµ‹è¯•éªŒè¯</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">queryUserInfoById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœï¼š{}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™å—çš„è°ƒç”¨æˆ‘ä»¬æ‰‹å†™æ¡†æ¶çš„æµ‹è¯•ç±»åˆ°ä¸éœ€è¦ä»€ä¹ˆæ”¹å˜ï¼Œåªè¦æ•°æ®æºé…ç½®ä¸Šä½¿ç”¨ <code>type=&quot;POOLED/UNPOOLED&quot;</code> å³å¯ï¼Œè¿™æ ·å°±èƒ½æµ‹è¯•æˆ‘ä»¬è‡ªå·±å¼€å‘çš„ä½¿ç”¨äº†åå°„å™¨è®¾ç½®å±æ€§çš„æ•°æ®æºç±»äº†ã€‚</li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220506-04.png" alt="å›¾ 8-4 ä½¿ç”¨MetaObject è®¾ç½®å±æ€§å€¼"></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">07</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">54.898</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>m<span class="token punctuation">.</span>d<span class="token punctuation">.</span>pooled<span class="token punctuation">.</span></span>PooledDataSource</span> <span class="token operator">-</span> <span class="token class-name">Created</span> connection <span class="token number">212683148.</span>
<span class="token number">07</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">55.006</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ApiTest</span> <span class="token operator">-</span> æµ‹è¯•ç»“æœï¼š<span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;userHead&quot;</span><span class="token operator">:</span><span class="token string">&quot;1_04&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userName&quot;</span><span class="token operator">:</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ ¹æ®å•å…ƒæµ‹è¯•å’Œè°ƒè¯•çš„æˆªå›¾ï¼Œå¯ä»¥çœ‹åˆ°å±æ€§å€¼é€šè¿‡åå°„çš„æ–¹å¼è®¾ç½®åˆ°å¯¹è±¡ä¸­ï¼Œä¹Ÿæ»¡è¶³äº†æˆ‘ä»¬åœ¨åˆ›å»ºæ•°æ®æºæ—¶å€™çš„ä½¿ç”¨ã€‚è¿™æ ·å°±å¯ä»¥é¡ºåˆ©çš„è°ƒç”¨æ•°æ®æºå®Œæˆæ•°æ®çš„æŸ¥è¯¢æ“ä½œäº†ã€‚</li></ul><h2 id="ä¸ƒã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€æ€»ç»“" aria-hidden="true">#</a> ä¸ƒã€æ€»ç»“</h2><ul><li>æœ¬ç« èŠ‚å…³äºåå°„å·¥å…·ç±»çš„å®ç°ä¸­ï¼Œä½¿ç”¨äº†å¤§é‡çš„ JDK æ‰€æä¾›çš„å…³äºåå°„ä¸€äº›å¤„ç†æ“ä½œï¼Œä¹ŸåŒ…æ‹¬å¯ä»¥è·å–ä¸€ä¸ª Class ç±»ä¸­çš„å±æ€§ã€å­—æ®µã€æ–¹æ³•çš„ä¿¡æ¯ã€‚é‚£ä¹ˆå†æœ‰äº†è¿™äº›ä¿¡æ¯ä»¥åå°±å¯ä»¥æŒ‰ç…§åŠŸèƒ½æµç¨‹è¿›è¡Œè§£è€¦ï¼ŒæŠŠå±æ€§ã€åå°„ã€åŒ…è£…ï¼Œéƒ½ä¾æ¬¡æ‹†åˆ†å‡ºæ¥ï¼Œå¹¶æŒ‰ç…§è®¾è®¡åŸåˆ™ï¼Œé€æ­¥åŒ…è£…è®©å¤–æ¥æ›´å°‘çš„çŸ¥é“å†…éƒ¨çš„å¤„ç†ã€‚</li><li>è¿™é‡Œçš„åå°„ä¹Ÿç®—æ˜¯å°å¤©èŠ±æ¿çš„ä½¿ç”¨çº§åˆ«äº†ï¼Œå°è£…çš„å·¥å…·ç±»æ–¹å¼ï¼Œå¦‚æœåœ¨æˆ‘ä»¬ä¹Ÿæœ‰ç±»ä¼¼çš„åœºæ™¯ä¸­ï¼Œå°±å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚å› ä¸ºæ•´ä¸ªå·¥å…·ç±»å¹¶æ²¡æœ‰å¤ªå¤šçš„é¢å¤–å…³è”ï¼Œç›´æ¥æ‹¿æ¥å°è£…æˆä¸€ä¸ªå·¥å…·åŒ…è¿›è¡Œä½¿ç”¨ï¼Œå¤„ç†å¹³å¸¸çš„ä¸šåŠ¡é€»è¾‘ä¸­ç»„ä»¶åŒ–çš„éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯éå¸¸ä¸é”™çš„ã€‚<em>æŠ€æœ¯è¿ç§»ã€å­¦ä»¥è‡´ç”¨ã€å‡èŒåŠ è–ª</em></li><li>ç”±äºæ•´ä¸ªå·¥å…·åŒ…ä¸­æ¶‰åŠçš„ç±»è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå¤§å®¶åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­å°½å¯èƒ½çš„éªŒè¯å’Œè°ƒè¯•ï¼Œä»¥åŠå¯¹æŸä¸ªä¸æ¸…æ¥šçš„æ–¹æ³•è¿›è¡Œå•ç‹¬å¼€å‘å’Œæµ‹è¯•ï¼Œè¿™æ ·æ‰èƒ½æ»¤æ¸…æ•´ä¸ªç»“æ„æ˜¯å¦‚ä½•å®ç°çš„ã€‚<em>å½“ä½ æŠŠè¿™å—çš„å†…å®¹å…¨éƒ¨æ‹¿ä¸‹ï¼Œä»¥åå†é‡åˆ°åå°„å°±æ˜¯å°æ„æ€äº†</em></li></ul><h2 id="å…«ã€ä¼˜ç§€ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#å…«ã€ä¼˜ç§€ä½œä¸š" aria-hidden="true">#</a> å…«ã€ä¼˜ç§€ä½œä¸š</h2>`,85),S={href:"https://t.zsxq.com/0666qVFqj",target:"_blank",rel:"noopener noreferrer"},_={href:"https://t.zsxq.com/07jLbAB1V",target:"_blank",rel:"noopener noreferrer"},M={href:"https://t.zsxq.com/0bfxapOQB",target:"_blank",rel:"noopener noreferrer"},N={href:"https://t.zsxq.com/08Zdjyfd8",target:"_blank",rel:"noopener noreferrer"},F={href:"https://t.zsxq.com/10tbST0Gg",target:"_blank",rel:"noopener noreferrer"},x={href:"https://t.zsxq.com/10LV8eY5X",target:"_blank",rel:"noopener noreferrer"};function I(T,C){const a=e("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),k,s("åšå®¢ï¼š"),n("a",r,[s("https://bugstack.cn"),t(a)]),d,s("åŸæ–‡ï¼š"),n("a",m,[s("https://mp.weixin.qq.com/s/FNgAruzgFebXZiOk0XZT4A"),t(a)])]),v,b,g,y,h,f,w,j,n("p",null,[s("ä¸çŸ¥é“å¤§å®¶åœ¨å­¦ä¹ "),n("a",q,[s("ã€Šæ‰‹å†™ Mybatisã€‹"),t(a)]),s("çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦æœ‰å¯¹ç…§ Mybatis æºç ä¸€èµ·å­¦ä¹ ï¼Œå¦‚æœä½ æœ‰å¯¹ç…§æºç ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡ä¼šå‘ç°æˆ‘ä»¬åœ¨å®ç°æ•°æ®æºæ± åŒ–æ—¶ï¼Œå¯¹äºå±æ€§ä¿¡æ¯çš„è·å–ï¼Œé‡‡ç”¨çš„æ˜¯ç¡¬ç¼–ç çš„æ–¹å¼ã€‚å¦‚å›¾ 8-1 æ‰€ç¤º")]),O,n("ul",null,[n("li",null,[n("a",S,[s("å®Œæˆmybatisè‡ªå·±å®ç°çš„MetaObjectåå°„å·¥å…·ç±»ã€‚è¿™å—åŒ…æ‹¬ï¼šå…ƒå¯¹è±¡ã€å¯¹è±¡åŒ…è£…å™¨ã€å¯¹è±¡å·¥å‚ã€å¯¹è±¡åŒ…è£…å·¥å‚ä»¥åŠReflectoråå°„å™¨ã€‚ @æ¨æ¨å¾—äº¿ğŸ™‰"),t(a)])]),n("li",null,[n("a",_,[s("äº†è§£äº†SecurityManagerçš„ä½¿ç”¨å’Œåå°„è·å–æ³›å‹çš„æ–¹å¼ @ç‹—å“¥"),t(a)])]),n("li",null,[n("a",M,[s("æœ¬ç« å°±æ˜¯è¦è‡ªå·±åŠ¨æ‰‹å®ç°ä¸€ä¸‹åå°„å·¥å…·åŒ…ï¼Œå¹¶ç”¨å®ƒæ¥æ”¹é€ åŸæ•°æ®æºå·¥å‚çš„éƒ¨åˆ†ä»£ç  @å°çŒªç¢ç¢å¿µ"),t(a)])]),n("li",null,[n("a",N,[s("ä¸ºäº†æ”¹é€ è¿™æ ·çš„ç¡¬ç¼–ç æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŸºäºJDKåå°„åŠŸèƒ½å°è£…ä¸€ä¸ªå·¥å…·åŒ… @liuc"),t(a)])]),n("li",null,[n("a",F,[s("å°†åˆ›å»ºDataSourceæ—¶çš„ç¡¬ç¼–ç éƒ¨åˆ†ä¿®æ”¹ä¸ºä½¿ç”¨åå°„å·¥å…·ç±»è¿›è¡Œèµ‹å€¼ï¼Œç†Ÿæ‚‰åå°„å·¥å…·ç±»çš„ä½¿ç”¨ä»¥åŠæ„å»ºæµç¨‹ã€‚@é«˜é«˜çš„é£èµ·æ¥"),t(a)])]),n("li",null,[n("a",x,[s("è¿™ä¸€ç« å†…å®¹è¶…çº§çš„å¤šï¼Œå†ä¹Ÿä¸æ•¢è¯´è‡ªå·±ä¼šåå°„äº†ï¼Œå­¦æ— æ­¢å¢ƒæ‚ğŸ˜‚ã€æ¢³ç†çš„å¾ˆç»†è…»ã€‘@ADé’™å¥¶"),t(a)])])])])}const P=p(i,[["render",I],["__file","2022-05-03-di8zhangï¼šbafansheyongdaochushenruhua.html.vue"]]);export{P as default};
