import{_ as e,r as o,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-3RcBQnkC.js";const u={},i=n("h1",{id:"dubbo-ä½¿ç”¨æ•™ç¨‹å’ŒåŸç†åˆ†æ",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#dubbo-ä½¿ç”¨æ•™ç¨‹å’ŒåŸç†åˆ†æ","aria-hidden":"true"},"#"),s(" Dubbo ä½¿ç”¨æ•™ç¨‹å’ŒåŸç†åˆ†æ")],-1),k=n("br",null,null,-1),r={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),v=n("iframe",{id:"B-Video",src:"//player.bilibili.com/player.html?aid=828140981&bvid=BV1Sg4y1c7m4&cid=1190616538&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"480"}," ",-1),m=n("p",null,"æœ¬æ–‡çš„å®—æ—¨åœ¨äºé€šè¿‡ç®€å•å¹²å‡€å®è·µçš„æ–¹å¼æ•™ä¼šè¯»è€…ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨Dubboã€æ€ä¹ˆä½¿ç”¨Dubboã€Dubboé€šä¿¡çš„åŸç†æ˜¯ä»€ä¹ˆã€‚åœ¨å­¦ä¹ æœ¬æ–‡åï¼Œä½ å¯ä»¥é¿å¼€å¾ˆå¤šå…³äº Dubbo ä½¿ç”¨æ—¶çš„å‘ï¼Œä¹Ÿèƒ½æ›´æ¸…æ¥šè‡ªå·±çš„ç¼–ç æ˜¯åœ¨åšä»€ä¹ˆã€‚",-1),b=n("p",null,"æœ¬æ–‡æ¶‰åŠçš„å·¥ç¨‹ï¼š",-1),g={href:"https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-dubbo",target:"_blank",rel:"noopener noreferrer"},h={href:"https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-dubbo-test",target:"_blank",rel:"noopener noreferrer"},f=p('<h2 id="ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨" aria-hidden="true">#</a> ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨</h2><p>éšç€äº’è”ç½‘åœºæ™¯ä¸­æ‰€è¦é¢å¯¹çš„ç”¨æˆ·è§„æ¨¡å’Œä½“é‡çš„å¢åŠ ï¼Œç³»ç»Ÿçš„ä¹Ÿéœ€è¦åšç›¸åº”çš„æ‹†åˆ†è®¾è®¡å’Œå®ç°ã€‚éšä¹‹è€Œæ¥çš„ï¼Œä»¥å‰çš„ä¸€å¥—ç³»ç»Ÿï¼Œç°åœ¨æˆäº†å¤šä¸ªå¾®æœåŠ¡ã€‚å¦‚ï¼›ç”µå•†ç³»ç»Ÿï¼Œä»¥å‰å°±åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å†™å°±å¯ä»¥äº†ï¼Œç°åœ¨éœ€è¦æ‹†åˆ†å‡ºï¼Œç”¨æˆ·ã€æ”¯ä»˜ã€å•†å“ã€é…é€ã€æ´»åŠ¨ã€é£æ§ç­‰å„ä¸ªæ¨¡å—ã€‚é‚£ä¹ˆè¿™äº›æ¨¡å—æ‹†åˆ†åï¼Œå¦‚ä½•é«˜æ•ˆçš„é€šä¿¡å‘¢ï¼Ÿ</p><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-01.png?raw=true" width="650px"></div><ul><li>å…³äºé€šä¿¡ï¼Œå°±å¼•å…¥äº† RPC æ¡†æ¶ï¼Œè€Œ Dubbo å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå®ç°æ–¹å¼ã€‚</li><li>é‚£ä¸ºå•¥ç”¨ Dubbo å‘¢ï¼Ÿå…¶å®æ ¸å¿ƒé—®é¢˜å°±ä¸€ä¸ªï¼Œä¸ºäº†æé«˜é€šä¿¡æ•ˆç‡ã€‚å› ä¸º Dubbo çš„åº•å±‚é€šä¿¡æ˜¯ Socket è€Œä¸æ˜¯ HTTP æ‰€ä»¥é€šä¿¡çš„æ€§èƒ½ä¼šæ›´å¥½ã€‚åŒæ—¶ Dubbo åˆæœ‰åˆ†å¸ƒå¼çš„é«˜å¯ç”¨è®¾è®¡ï¼Œåœ¨ä¸€ç»„éƒ¨ç½²äº†äº¤æ˜“æœåŠ¡çš„å®ä¾‹å®•æœºåï¼Œä¼šè¢«ä»æ³¨å†Œä¸­å¿ƒæ‘˜é™¤ï¼Œä¹‹åæµé‡ä¼šæ‰“åˆ°å…¶ä»–æœåŠ¡ä¸Šã€‚</li></ul><h2 id="äºŒã€è¦æ€ä¹ˆä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#äºŒã€è¦æ€ä¹ˆä½¿ç”¨" aria-hidden="true">#</a> äºŒã€è¦æ€ä¹ˆä½¿ç”¨</h2><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-02.png?raw=true" width="650px"></div><p>Dubbo çš„ä½¿ç”¨åˆ†ä¸º2æ–¹ï¼Œä¸€ä¸ªæ˜¯æ¥å£çš„æä¾›æ–¹ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ¥å£çš„è°ƒç”¨æ–¹ã€‚æ¥å£çš„æä¾›æ–¹éœ€è¦æä¾›å‡ºè¢«è°ƒç”¨æ–¹ä½¿ç”¨æ¥å£çš„æè¿°æ€§ä¿¡æ¯ã€‚è¿™ä¸ªä¿¡æ¯åŒ…æ‹¬ï¼›æ¥å£åç§°ã€æ¥å£å…¥å‚ã€æ¥å£å‡ºå‚ï¼Œåªæœ‰è®©è°ƒç”¨æ–¹æ‹¿åˆ°è¿™äº›ä¿¡æ¯ä»¥åï¼Œå®ƒæ‰èƒ½ä¾æ‰˜äºè¿™æ ·çš„æ¥å£ä¿¡æ¯åšä¸€ä¸ªä»£ç†æ“ä½œï¼Œå¹¶åœ¨ä»£ç†ç±»ä¸­ä½¿ç”¨ Socket å®ŒæˆåŒæ–¹çš„ä¿¡æ¯äº¤äº’ã€‚</p><p>æ‰€ä»¥ä½ çœ‹ä¸Šå»è°ƒç”¨ RPC æ¥å£å¥½åƒå’Œä½¿ç”¨ HTTP ä¹Ÿæ²¡å•¥åŒºåˆ«ï¼Œæ— éå°±æ˜¯å¼•å…¥äº† POM é…ç½®ï¼Œä¹‹åå†é…ç½®äº†æ³¨è§£å°±å¯ä»¥ä½¿ç”¨äº†ã€‚ä½†å…¶å®ï¼Œå®ƒæ˜¯æŠŠä½ çš„ Jar å½“åšä»£ç†çš„å¿…è¦å‚æ•°ä½¿ç”¨äº†ã€‚<strong>æœ¬æ–‡ä¹Ÿä¼šä»‹ç»ï¼Œå…·ä½“æ˜¯æ€ä¹ˆä»£ç†çš„</strong></p><h2 id="ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹" aria-hidden="true">#</a> ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹</h2><p>å¯¹äºç¼–ç¨‹çš„å­¦ä¹ æ¥è¯´ï¼Œå…¶å®æœ€å¼€å§‹çš„é‚£ä¸€ä¸‹ï¼Œä¸æ˜¯ææ˜ç™½æ‰€æœ‰åŸç†ï¼Œè€Œæ˜¯å…ˆè®©è‡ªå·±å¯ä»¥çœ‹åˆ°è¿è¡Œå‡ºæ¥çš„æ•ˆæœã€‚å“ï¼Œä¹‹åå°±å»åˆ†æåŸç†ï¼Œè¿™æ ·ä¼šèˆ’æœçš„å¤šã€‚</p><p>æ‰€ä»¥å°å‚…å“¥è¿™é‡Œæä¾›äº†ä¸€å¥—ç®€å•çš„ Dubbo ä½¿ç”¨æ¡ˆä¾‹ï¼Œåªè¦ä½ æ»¡è¶³æœ€åŸºæœ¬çš„é…ç½®æ¡ä»¶ï¼Œå°±å¯ä»¥è¿è¡Œå‡ºæ•ˆæœï¼›</p><ol><li>JDK 1.8</li><li>Maven 3.x - jdk1.8æ”¯æŒçš„å°±å¯ä»¥</li><li>Dubbo 3.1.4 - POM ä¸­å·²ç»é…ç½®ï¼Œä¸2.xæœ€å¤§çš„ä½¿ç”¨ä¸Šçš„åŒºåˆ«å°±æ˜¯ä¸€äº›æ³¨è§£çš„ä½¿ç”¨</li><li>Zookeeper 3.4.x - å¦‚æœä½ åªæ˜¯æŒ‰ç…§æœ¬æ–‡ä¸­çš„ç›´è¿æ¨¡å¼æµ‹è¯•ï¼Œé‚£ä¹ˆä¸å®‰è£… Zookeeper ä¹Ÿå¯ä»¥</li></ol><h3 id="_1-æ¥å£æä¾›æ–¹" tabindex="-1"><a class="header-anchor" href="#_1-æ¥å£æä¾›æ–¹" aria-hidden="true">#</a> 1. æ¥å£æä¾›æ–¹</h3>',13),q={href:"https://bugstack.cn/md/road-map/ddd.html",target:"_blank",rel:"noopener noreferrer"},w=p(`<div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-03.png?raw=true" width="750px"></div><h4 id="_1-1-æ¥å£å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-1-æ¥å£å®šä¹‰" aria-hidden="true">#</a> 1.1 æ¥å£å®šä¹‰</h4><p><strong>æºç </strong>ï¼š<code>cn.bugstack.dev.tech.dubbo.api.IUserService</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUserService</span> <span class="token punctuation">{</span>

    <span class="token class-name">Response</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token class-name">UserReqDTO</span> reqDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ¥å£å®šä¹‰å¹³å¹³æ— å¥‡ï¼Œä½†ç¬¬1ä¸ªå‘æš—è—ç„æœºï¼</li><li>ä¹Ÿå°±æ˜¯ï¼Œæ‰€æœ‰çš„ Dubbo æ¥å£ï¼Œå‡ºå…¥å‚ï¼Œé»˜è®¤éƒ½éœ€è¦ç»§æ‰¿ Serializable æ¥å£ã€‚ä¹Ÿå°±æ˜¯ UserReqDTOã€UserResDTOã€Response è¿™3ä¸ªç±»ï¼Œéƒ½å¾—ç»§æ‰¿ Serializable åºåˆ—åŒ–æ¥å£ã€‚</li></ul><h4 id="_1-2-æ¥å£å®ç°" tabindex="-1"><a class="header-anchor" href="#_1-2-æ¥å£å®ç°" aria-hidden="true">#</a> 1.2 æ¥å£å®ç°</h4><p><strong>æºç </strong>ï¼š<code>cn.bugstack.dev.tech.dubbo.trigger.rpc.UserService</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@DubboService</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token keyword">implements</span> <span class="token class-name">IUserService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Response</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token class-name">UserReqDTO</span> reqDTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ userId: {} reqStr: {}&quot;</span><span class="token punctuation">,</span> reqDTO<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 1. æ¨¡æ‹ŸæŸ¥è¯¢ã€ä½ å¯ä»¥ä»æ•°æ®åº“æˆ–è€…Redisç¼“å­˜è·å–æ•°æ®ã€‘</span>
            <span class="token class-name">UserResDTO</span> resDTO <span class="token operator">=</span> <span class="token class-name">UserResDTO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">userName</span><span class="token punctuation">(</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">userAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 2. è¿”å›ç»“æœ</span>
            <span class="token keyword">return</span> <span class="token class-name">Response</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token class-name">Constants<span class="token punctuation">.</span>ResponseCode</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token class-name">Constants<span class="token punctuation">.</span>ResponseCode</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>resDTO<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥ userId: {} reqStr: {}&quot;</span><span class="token punctuation">,</span> reqDTO<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">Response</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token class-name">Constants<span class="token punctuation">.</span>ResponseCode</span><span class="token punctuation">.</span><span class="token constant">UN_ERROR</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token class-name">Constants<span class="token punctuation">.</span>ResponseCode</span><span class="token punctuation">.</span><span class="token constant">UN_ERROR</span><span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ¥å£å®ç°å¹³å¹³æ— å¥‡ï¼Œä½†ç¬¬2ä¸ªå‘æš—è—ç„æœºï¼</li><li>Dubbo çš„å®ç°æ¥å£ï¼Œéœ€è¦è¢« Dubbo è‡ªå·±ç®¡ç†ã€‚æ‰€ä»¥ Dubbo æä¾›äº† @DubboService æ³¨è§£ã€‚æœ‰äº›å°å¡æ‹‰ç±³ï¼Œä½¿ç”¨çš„æ˜¯ä¸æ˜¯ Spring çš„ @Service å‘€ï¼Ÿå°¤å…¶æ˜¯ä»¥å‰çš„ Dubbo ç‰ˆæœ¬ <code>2.7.*</code> å®ƒçš„æ³¨è§£ä¹Ÿæ˜¯ @Service ä¹Ÿä¸ç•™ç¥å°±ç”¨æˆäº† Spring çš„ @Serviceã€‚ä¸€ä¸ªå°bugï¼Œåˆè°ƒäº†ä¸€ä¸Šåˆã€‚</li></ul><h4 id="_1-3-å·¥ç¨‹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-3-å·¥ç¨‹é…ç½®" aria-hidden="true">#</a> 1.3 å·¥ç¨‹é…ç½®</h4><p><strong>application.yml</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>dubbo<span class="token operator">:</span>
  application<span class="token operator">:</span>
    name<span class="token operator">:</span> xfg<span class="token operator">-</span>dev<span class="token operator">-</span>tech<span class="token operator">-</span>dubbo
    version<span class="token operator">:</span> <span class="token number">1.0</span><span class="token number">.0</span>
  registry<span class="token operator">:</span>
    address<span class="token operator">:</span> zookeeper<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">2181</span> # <span class="token class-name">N</span><span class="token operator">/</span><span class="token class-name">A</span> <span class="token operator">-</span> æ— zookeeperå¯é…ç½® <span class="token class-name">N</span><span class="token operator">/</span><span class="token class-name">A</span> èµ°ç›´è¿æ¨¡å¼æµ‹è¯•
  protocol<span class="token operator">:</span>
    name<span class="token operator">:</span> dubbo
    port<span class="token operator">:</span> <span class="token number">20881</span>
  scan<span class="token operator">:</span>
    base<span class="token operator">-</span>packages<span class="token operator">:</span> cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>tech<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>api
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®ä¿¡æ¯å¹³å¹³æ— å¥‡ï¼Œä½†ç¬¬3ä¸ªå‘æš—è—ç„æœºï¼</li><li>base-packages æ‰«æçš„æ˜¯å“ªé‡Œé…ç½®äº† Dubbo çš„ API å…¥å£ï¼Œç»™å®ƒå…¥å£å°±è¡Œï¼Œå®ƒä¼šè‡ªå·±æ‰¾åˆ°å®ç°ç±»ã€‚ä½†ï¼ä½ è¦çŸ¥é“ Java çš„ Spring åº”ç”¨èƒ½æ‰«æåˆ°ï¼Œèƒ½è¢« Spring ç®¡ç†ï¼Œé‚£ä¹ˆ pom è¦<strong>ç›´æ¥æˆ–è€…é—´æ¥</strong>çš„å¼•å¯¼åˆ°å®šä¹‰äº† Dubbo çš„æ¨¡å—ã€‚</li><li>å†æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒSpring åº”ç”¨å¼€å‘ï¼Œè®²ç©¶çº¦å®šå¤§äºé…ç½®ã€‚ä½  Application åº”ç”¨ï¼Œçš„åŒ…ååº”è¯¥æ˜¯å¯ä»¥è¦†ç›–åˆ°å…¶ä»–åŒ…åçš„ã€‚æ¯”å¦‚ Application éƒ½é…ç½®åˆ° <code>cn.bugstack.dev.tech.dubbo.a.b.c.d.*</code> å»äº†ï¼Œå®ƒé»˜è®¤å°±æ‰«ä¸åˆ° <code>cn.bugstack.dev.tech.dubbo.api</code> äº†ã€‚ä¸€ä¸ªå°bugï¼Œä¸€ä¸‹åˆåˆè¿‡å»äº†ã€‚</li><li>æ³¨æ„ï¼šaddressï¼šå¦‚æœé…ç½®çš„æ˜¯ N/A å°±æ˜¯ä¸èµ°ä»»ä½•æ³¨å†Œä¸­å¿ƒï¼Œå°±æ˜¯ä¸ªç›´è¿ï¼Œä¸»è¦ç”¨äºæœ¬åœ°éªŒè¯çš„ã€‚å¦‚æœä½ é…ç½®äº† zookeeper://127.0.0.1:2181 å°±éœ€è¦å…ˆå®‰è£…ä¸€ä¸ª zookeeper å¦å¤–ï¼Œå³ä½¿ä½ é…ç½®äº†æ³¨å†Œä¸­å¿ƒçš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ç›´è¿æµ‹è¯•ã€‚</li></ul><h4 id="_1-4-åº”ç”¨æ„å»º" tabindex="-1"><a class="header-anchor" href="#_1-4-åº”ç”¨æ„å»º" aria-hidden="true">#</a> 1.4 åº”ç”¨æ„å»º</h4><p>ä»¥ä¸Šä¿¡æ¯éƒ½å‡†å¤‡äº†ï¼Œä¸€ç¾¤å°å¡æ‹‰ç±³å¼€å§‹æ‰åˆ°ç¬¬4ä¸ªå‘é‡Œäº†ï¼</p><p>ä½ æœ‰2ä¸ªåº”ç”¨ï¼Œä¸€ä¸ªDubboæ¥å£æä¾›æ–¹ã€ä¸€ä¸ªDubboæ¥å£ä½¿ç”¨æ–¹ã€‚é‚£ä¹ˆä½ åœ¨ç»™ä½ å¦å¤–ä¸€ä¸ªåº”ç”¨ä½¿ç”¨æ¥å£çš„æ—¶å€™ï¼Œä½ åœ¨ InelliJ IDEA çš„ Maven ä¸­æ‰§è¡Œ Install äº†å—ï¼Ÿ</p><p>Install æ˜¯å¹²å•¥çš„ï¼Ÿå®ƒæ˜¯ä¸ºäº†è®©ä½ ä½¿ç”¨äº†åŒä¸€ä¸ªæœ¬åœ° Maven é…ç½®çš„åº”ç”¨ï¼Œå¯ä»¥å¼•å…¥åˆ°å¯¹æ–¹æä¾›çš„ Jar åŒ…ã€‚ä½  Install ä»¥åï¼Œè¿™ä¸ª Jar åŒ…å°±ä¼šè¿›å…¥åˆ°æœ¬åœ° Maven ä»“åº“äº†ã€‚å¦‚æœæ˜¯å…¬å¸é‡Œå¼€å‘ï¼Œä¼šæœ‰ä¸“é—¨çš„è‡ªå·±å®¶éƒ¨ç½²çš„ï¼Œç§æœ‰Mavenä¸­å¿ƒä»“åº“ï¼Œå°±å¯ä»¥é€šè¿‡ deploy æŠŠæœ¬åœ° Jar å‘å¸ƒä¸Šå»ï¼Œé‚£ä¹ˆå…¬å¸é‡Œçš„ä¼™ä¼´ï¼Œä¹Ÿå°±éƒ½å¯ä»¥å¼•ç”¨äº†ã€‚</p><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-04.png?raw=true" width="450px"></div><ul><li>ä½ è¦å…ˆç‚¹å‡» root ä¸‹çš„ install æ“ä½œï¼Œè¿™æ ·å°±ä¼šè‡ªåŠ¨æ„å»ºäº†ã€‚</li><li>å¦‚æœä½ ç”µè„‘é…ç½®æœ‰ç‚¹ä½ï¼Œä¹Ÿä¼šå‡ºç°ä¸€äº›<code>æ°”äººæ€ªç›¸</code>ï¼Œæ¯”å¦‚å°±åˆ·ä¸è¿›å»ï¼Œinstall äº†ä¹Ÿå¼•ç”¨ä¸äº†ã€‚è®°å¾—è¦ clean æ¸…ç©ºä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ° maven æ–‡ä»¶ä»¶å»æ¸…ç©ºã€‚</li></ul><h3 id="_2-æ¥å£ä½¿ç”¨æ–¹" tabindex="-1"><a class="header-anchor" href="#_2-æ¥å£ä½¿ç”¨æ–¹" aria-hidden="true">#</a> 2. æ¥å£ä½¿ç”¨æ–¹</h3><p>æœ‰äº›å°å¡æ‹‰ç±³è§‰å¾—å‰é¢çš„æŠ—éƒ½æ‰«å¹²å‡€äº†ï¼Œå°±å®Œäº‹äº†ã€‚æ²¡æœ‰æ¥ä¸‹æ¥è¿˜æœ‰å‘ï¼Œè®©ä½ ä¸€ææä¸€å¤©ï¼ŒåŠå¤œä¹Ÿç¡ä¸å¥½ã€‚</p><h4 id="_2-1-pom-å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#_2-1-pom-å¼•å…¥" aria-hidden="true">#</a> 2.1 POM å¼•å…¥</h4><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.bugstack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>xfg-dev-tech-dubbo-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>POM çš„é…ç½®ï¼Œå°±æ˜¯æŠŠ Jar åŒ…ç»™å¼•ç”¨è¿›æ¥ã€‚å› ä¸º Dubbo éœ€è¦æ ¹æ®è¿™ä¸ªæ¥å£ï¼Œåšä¸€ä¸ªä»£ç†æ“ä½œã€‚<strong>ä¸å¼•å…¥ï¼Œä½ ä»£ç å°±çˆ†çº¢å•¦ï¼çˆ†çº¢å•¦ï¼ğŸŒ¶</strong></li></ul><h4 id="_2-2-æ¶ˆè´¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-2-æ¶ˆè´¹é…ç½®" aria-hidden="true">#</a> 2.2 æ¶ˆè´¹é…ç½®</h4><p><strong>æºç </strong>ï¼š<code>application.yml</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>dubbo<span class="token operator">:</span>
  application<span class="token operator">:</span>
    name<span class="token operator">:</span> xfg<span class="token operator">-</span>dev<span class="token operator">-</span>tech<span class="token operator">-</span>dubbo
    version<span class="token operator">:</span> <span class="token number">1.0</span><span class="token number">.0</span>
  registry<span class="token operator">:</span>
     address<span class="token operator">:</span> zookeeper<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">2181</span>
#    address<span class="token operator">:</span> <span class="token class-name">N</span><span class="token operator">/</span><span class="token class-name">A</span>
  protocol<span class="token operator">:</span>
    name<span class="token operator">:</span> dubbo
    port<span class="token operator">:</span> <span class="token number">20881</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®äº† zookeeper ä½ å°±ç”¨ç¬¬ä¸€ä¸ªï¼Œä»£ç ä¸­å¯¹åº” <code>@DubboReference(interfaceClass = IUserService.class, version = &quot;1.0.0&quot;)</code></li><li>é…ç½®äº† N/A ä½ å°±ç”¨ç¬¬äºŒä¸ªï¼Œä»£ç ä¸­å¿…é¡»æŒ‡å®šç›´è¿ã€‚<code>@DubboReference(interfaceClass = IUserService.class, url = &quot;dubbo://127.0.0.1:20881&quot;, version = &quot;1.0.0&quot;)</code></li></ul><h4 id="_2-3-ä»£ç é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-3-ä»£ç é…ç½®" aria-hidden="true">#</a> 2.3 ä»£ç é…ç½®</h4><p><strong>æºç </strong>ï¼š<code>cn.bugstack.dev.tech.dubbo.consumer.test.ApiTest</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// ç›´è¿æ¨¡å¼ï¼›@DubboReference(interfaceClass = IUserService.class, url = &quot;dubbo://127.0.0.1:20881&quot;, version = &quot;1.0.0&quot;)</span>
<span class="token annotation punctuation">@DubboReference</span><span class="token punctuation">(</span>interfaceClass <span class="token operator">=</span> <span class="token class-name">IUserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">IUserService</span> userService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_userService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserReqDTO</span> reqDTO <span class="token operator">=</span> <span class="token class-name">UserReqDTO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Response</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span> resDTO <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœ req: {} res: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>resDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">2023</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">22.291</span>  <span class="token constant">INFO</span> <span class="token number">62481</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span>tech<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ApiTest</span>   <span class="token operator">:</span> æµ‹è¯•ç»“æœ req<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">}</span> res<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;userAge&quot;</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userName&quot;</span><span class="token operator">:</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;info&quot;</span><span class="token operator">:</span><span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">}</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">22.324</span>  <span class="token constant">INFO</span> <span class="token number">62481</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>tor<span class="token operator">-</span><span class="token class-name">Framework</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>a<span class="token punctuation">.</span>c<span class="token punctuation">.</span>f<span class="token punctuation">.</span>imps<span class="token punctuation">.</span></span>CuratorFrameworkImpl</span>        <span class="token operator">:</span> backgroundOperationsLoop exiting
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¦‚æœä¸å‡ºå•¥æ„å¤–ï¼Œåˆ°è¿™ä½ å°±å¯ä»¥ç›´æ¥å¯åŠ¨è¿è¡Œäº†ã€‚å¹¶çœ‹åˆ°æµ‹è¯•ç»“æœã€‚</li><li>ä½†åˆ«å¿˜è®°äº†ï¼Œä½ å¯åŠ¨çš„æ—¶å€™ï¼Œéœ€è¦å…ˆå¯åŠ¨ xfg-dev-tech-dubbo è®©æ¥å£æä¾›æ–¹è·‘èµ·æ¥ã€‚</li></ul><h2 id="å››ã€åŸç†çš„åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å››ã€åŸç†çš„åˆ†æ" aria-hidden="true">#</a> å››ã€åŸç†çš„åˆ†æ</h2><p>éƒ½è¯´ Jar æ˜¯æä¾›å¯æè¿°æ€§ä¿¡æ¯çš„ï¼Œå¯¹æ–¹æ‰èƒ½ä»£ç†è°ƒç”¨ã€‚é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹æ˜¯æ€ä¹ˆå¹²çš„å‘¢ï¼Œæ€»ä¸èƒ½ä¸€é—®è¿™ä¸ªï¼Œå°±è®©å°å¡æ‹‰ç±³ä»¬å»æ‰‹å†™ Dubbo å‘€ï¼æ‰€ä»¥å°å‚…å“¥ä¼šé€šè¿‡æœ€ç®€å•æ¨¡å‹ç»“æ„ï¼Œè®©ä½ äº†è§£è¿™ä¸ª Dubbo é€šä¿¡çš„åŸç†ï¼Œæ–¹ä¾¿å°å¡æ‹‰ç±³ä»¬ä¸Šæ‰‹ã€‚</p><div align="center"><img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-06.png?raw=true" width="850px"></div><ul><li>å¦‚æœæ‰€ç¤ºï¼Œæ¥å£ä½¿ç”¨æ–¹ï¼Œå¯¹æ¥å£è¿›è¡Œä»£ç†ã€‚ä»€ä¹ˆæ˜¯ä»£ç†å‘¢ï¼Œä»£ç†å°±æ˜¯ç”¨ä¸€ä¸ªåŒ…è£…çš„ç»“æ„ï¼Œä»£æ›¿åŸæœ‰çš„æ“ä½œã€‚åœ¨è¿™ä¸ªåŒ…è£…çš„ç»“æ„é‡Œï¼Œä½ å¯ä»¥è‡ªå·±æ‰©å±•å‡ºä»»æ„çš„æ–¹æ³•ã€‚</li><li>é‚£ä¹ˆï¼Œè¿™é‡Œçš„ä»£ç†ã€‚å°±æ˜¯æ ¹æ®æ¥å£çš„ä¿¡æ¯ï¼Œåˆ›å»ºå‡ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œåœ¨ä»£ç†å¯¹è±¡ä¸­ï¼Œæä¾› Socket è¯·æ±‚ã€‚å½“è°ƒç”¨è¿™ä¸ªæ¥å£çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¯¹æ¥å£æä¾›æ–¹çš„ï¼Œå‘èµ· Socket è¯·æ±‚äº†ã€‚</li><li>è€Œ Socket æ¥æ”¶æ–¹ï¼Œä¹Ÿå°±æ˜¯æ¥å£æä¾›æ–¹ã€‚ä»–æ”¶åˆ°ä¿¡æ¯ä»¥åï¼Œæ ¹æ®æ¥å£çš„æè¿°æ€§å†…å®¹ï¼Œè¿›è¡Œä¸€ä¸ªåå°„è°ƒç”¨ã€‚è¿™ä¸‹å°±æŠŠä¿¡æ¯ç»™è¯·æ±‚å‡ºæ¥ï¼Œä¹‹åå†é€šè¿‡ Socket è¿”å›å›å»å°±å¯ä»¥äº†ã€‚</li></ul><p>å¥½ï¼Œæ ¸å¿ƒçš„åŸç†å°±è¿™ä¹ˆç‚¹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»ä»£ç ä¸­çœ‹çœ‹ã€‚</p><h3 id="_1-æ¥å£ä»£ç†-æä¾›æ–¹" tabindex="-1"><a class="header-anchor" href="#_1-æ¥å£ä»£ç†-æä¾›æ–¹" aria-hidden="true">#</a> 1. æ¥å£ä»£ç† - æä¾›æ–¹</h3><p><strong>æºç </strong>ï¼š<code>cn.bugstack.dev.tech.dubbo.trigger.socket.RpcServerSocket</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RpcServerSocket</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RpcServerSocket</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext <span class="token operator">=</span> applicationContext<span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">EventLoopGroup</span> bossGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ServerBootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span> workerGroup<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_BACKLOG</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectDecoder</span><span class="token punctuation">(</span><span class="token class-name">ClassResolvers</span><span class="token punctuation">.</span><span class="token function">cacheDisabled</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleChannelInboundHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                                <span class="token annotation punctuation">@Override</span>
                                <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">channelRead0</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> channelHandlerContext<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                                    <span class="token comment">// è§£æå‚æ•°</span>
                                    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;clazz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token class-name">String</span> methodName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;methodName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;paramTypes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                    <span class="token comment">// åå°„è°ƒç”¨</span>
                                    <span class="token class-name">Method</span> method <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">,</span> paramTypes<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token class-name">Object</span> invoke <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                    <span class="token comment">// å°è£…ç»“æœ</span>
                                    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    response<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> invoke<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;RPC è¯·æ±‚è°ƒç”¨ clazz:{} methodName:{}, response:{}&quot;</span><span class="token punctuation">,</span> clazz<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> methodName<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token comment">// å›å†™æ•°æ®</span>
                                    channelHandlerContext<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">ChannelFuture</span> f <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token number">22881</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            bossGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            workerGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸»è¦æä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼›</p><ol><li>Netty Socket å¯åŠ¨ä¸€ä¸ªæœåŠ¡ç«¯</li><li>æ³¨å…¥ ApplicationContext applicationContext ç”¨äºåœ¨æ¥æ”¶åˆ°è¯·æ±‚æ¥å£ä¿¡æ¯åï¼Œè·å–å¯¹åº”çš„ Bean å¯¹è±¡ã€‚</li><li>æ ¹æ®è¯·æ±‚æ¥çš„ Bean å¯¹è±¡ï¼Œä»¥åŠå‚æ•°çš„å¿…è¦ä¿¡æ¯ã€‚è¿›è¡Œæ¥å£çš„åå°„è°ƒç”¨ã€‚</li><li>æœ€åä¸€æ­¥ï¼Œå°±æ˜¯æŠŠæ¥å£åå°„è¯·æ±‚çš„ä¿¡æ¯ï¼Œå†é€šè¿‡ Socket è¿”å›å›å»ã€‚</li></ol><h3 id="_2-æ¥å£åå°„-è°ƒç”¨æ–¹" tabindex="-1"><a class="header-anchor" href="#_2-æ¥å£åå°„-è°ƒç”¨æ–¹" aria-hidden="true">#</a> 2. æ¥å£åå°„ - è°ƒç”¨æ–¹</h3>`,45),y={href:"https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-dubbo-test",target:"_blank",rel:"noopener noreferrer"},S=p(`<p><strong>æºç </strong>ï¼š<code>cn.bugstack.dev.tech.dubbo.consumer.config.RPCProxyBeanFactory</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">&quot;rpcProxyBeanFactory&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RPCProxyBeanFactory</span> <span class="token keyword">implements</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">IUserService</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">;</span>

    <span class="token comment">// ç¼“å­˜æ•°æ®ï¼Œå®é™…RPCä¼šå¯¹æ¯æ¬¡çš„è°ƒç”¨ç”Ÿæˆä¸€ä¸ªIDæ¥æ ‡è®°è·å–</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> responseCache<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RPCProxyBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Rpc Socket é“¾æ¥ç­‰å¾…...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">IUserService</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">IUserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">InvocationHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;clazz&quot;</span><span class="token punctuation">,</span> <span class="token class-name">IUserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;methodName&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;paramTypes&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

                channel<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// æ¨¡æ‹Ÿè¶…æ—¶ç­‰å¾…ï¼Œä¸€èˆ¬RPCæ¥å£è¯·æ±‚ï¼Œéƒ½æœ‰ä¸€ä¸ªè¶…æ—¶ç­‰å¾…æ—¶é•¿ã€‚</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">350</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> responseCache<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">IUserService</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> classes<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">IUserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Bootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>workerGroup<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">AUTO_READ</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> channel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectDecoder</span><span class="token punctuation">(</span><span class="token class-name">ClassResolvers</span><span class="token punctuation">.</span><span class="token function">cacheDisabled</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleChannelInboundHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                                <span class="token annotation punctuation">@Override</span>
                                <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">channelRead0</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> channelHandlerContext<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                                    responseCache <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ChannelFuture</span> channelFuture <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">22881</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">syncUninterruptibly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>channel <span class="token operator">=</span> channelFuture<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            channelFuture<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">syncUninterruptibly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            workerGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸»è¦æä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼›</p><ol><li>å®ç° <code>FactoryBean&lt;IUserService&gt;</code> ä¸ºçš„æ˜¯æŠŠè¿™æ ·ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œäº¤ç»™ Spring å®¹å™¨ç®¡ç†ã€‚</li><li>å®ç° Runnable æ¥å£ï¼Œå¹¶åœ¨æ¥å£ä¸­ï¼Œåˆ›å»º Netty çš„ Socket å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¸­æ¥æ”¶æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼Œå¹¶ä¸´æ—¶å­˜æ”¾åˆ°ç¼“å­˜ä¸­ã€‚<strong>æ³¨æ„ Dubbo ä¸­è¿™å—çš„å¤„ç†ä¼šå¤æ‚ä¸€äº›ï¼Œä»¥åŠè¯·æ±‚åŒæ­¥å“åº”é€šä¿¡ï¼Œè¿™æ ·æ‰èƒ½æŠŠå„ä¸ªæ¥å£çš„è°ƒåŠ¨è®°å½•ä¸‹æ¥</strong></li><li><code>getObject()</code> å¯¹è±¡ä¸­ï¼Œæä¾›ä»£ç†æ“ä½œã€‚ä»£ç†é‡Œï¼Œå°±å¯ä»¥è‡ªå·±æƒ³å’‹æå’‹æäº†ã€‚è€Œ Dubbo ä¹Ÿæ˜¯åœ¨ä»£ç†é‡Œï¼Œæä¾›äº†å¦‚æ­¤çš„æ“ä½œï¼Œå¯¹æ¥å£æä¾›æ–¹å‘é€è¯·æ±‚æ¶ˆæ¯ï¼Œå¹¶åœ¨è¶…æ—¶æ—¶é—´å†…è¿”å›æ¥å£ä¿¡æ¯ã€‚å› ä¸ºåå°„è°ƒç”¨ï¼Œéœ€è¦ä½ <code>æä¾›ç±»</code>ã€<code>æ–¹æ³•</code>ã€<code>å…¥å‚ç±»å‹</code>ã€<code>å…¥å‚å†…å®¹</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠè¿™äº›ä¿¡æ¯ä¼ é€’ç»™æ¥å£æä¾›æ–¹ã€‚</li></ol><h3 id="_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯" aria-hidden="true">#</a> 3. æœåŠ¡æµ‹è¯• - æ¶ˆè´¹éªŒè¯</h3><ul><li>å¯åŠ¨ xfg-dev-tech-dubbo</li><li>æµ‹è¯• xfg-dev-tech-dubbo-test</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;rpcProxyBeanFactory&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">IUserService</span> proxyUserService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_proxyUserService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">UserReqDTO</span> reqDTO <span class="token operator">=</span> <span class="token class-name">UserReqDTO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Response</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserResDTO</span><span class="token punctuation">&gt;</span></span> resDTO <span class="token operator">=</span> proxyUserService<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœ req: {} res: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>reqDTO<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>resDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">2023</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">14</span><span class="token operator">:</span><span class="token number">51.322</span>  <span class="token constant">INFO</span> <span class="token number">74498</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span>tech<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ApiTest</span>   <span class="token operator">:</span> æµ‹è¯•ç»“æœ req<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">}</span> res<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;userAge&quot;</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">&quot;userId&quot;</span><span class="token operator">:</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userName&quot;</span><span class="token operator">:</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;info&quot;</span><span class="token operator">:</span><span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>è¿™é‡Œæˆ‘ä»¬ç»™ IUserService æ³¨å…¥ä¸€ä¸ªè‡ªå·±ä»£ç†å¥½çš„å¯¹è±¡ï¼Œä¹‹åå°±å¯ä»¥è°ƒç”¨éªŒè¯äº†ã€‚</li><li>å¥½å•¦ï¼Œåˆ°è¿™æˆ‘ä»¬å°±æŠŠå…³äº Dubbo çš„äº‹äº¤ä»£æ˜ç™½äº†ï¼Œä»¥ä¸Šå†…å®¹è¾ƒå¤šã€‚å°å¡æ‹‰ç±³éœ€è¦ç»†ç»†çš„å“å‘³å¸æ”¶ï¼</li></ul>`,10);function O(x,D){const a=o("ExternalLinkIcon");return c(),l("div",null,[i,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),k,s("åšå®¢ï¼š"),n("a",r,[s("https://bugstack.cn"),t(a)])]),d,v,m,b,n("ul",null,[n("li",null,[s("xfg-dev-tech-dubboï¼š"),n("a",g,[s("https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-dubbo"),t(a)])]),n("li",null,[s("xfg-dev-tech-dubbo-testï¼š"),n("a",h,[s("https://gitcode.net/KnowledgePlanet/road-map/xfg-dev-tech-dubbo-test"),t(a)])])]),f,n("p",null,[s("å·¥ç¨‹æ¡ˆä¾‹åˆ›å»ºç»“æ„ï¼Œé‡‡ç”¨çš„æ˜¯ DDD ç»“æ„ã€‚ä½†å’Œ DDD ä¸€ç‚¹å…³ç³»æ²¡æœ‰ã€‚å¦‚æœä½ å¯¹å·¥ç¨‹åˆ›å»ºæœ‰ç–‘æƒ‘ï¼Œå¯ä»¥å‚è€ƒ "),n("a",q,[s("ã€ŠJava ç®€æ˜æ•™ç¨‹ã€‹ä¹‹ DDD æ¶æ„"),t(a)])]),w,n("p",null,[s("æ‰“å¼€å·¥ç¨‹ï¼š"),n("a",y,[s("xfg-dev-tech-dubbo-test"),t(a)])]),S])}const _=e(u,[["render",O],["__file","dubbo.html.vue"]]);export{_ as default};
