import{_ as o,r as c,o as d,c as s,a as t,b as a,d as l,f as n,e as r}from"./app-3RcBQnkC.js";const i={},h=t("h1",{id:"第07节-部署环境-elasticsearch、kibana",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#第07节-部署环境-elasticsearch、kibana","aria-hidden":"true"},"#"),a(" 第07节：部署环境 Elasticsearch、Kibana")],-1),b=t("br",null,null,-1),_={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},g=t("blockquote",null,[t("p",null,"沉淀、分享、成长，让自己和他人都能有所收获！")],-1),u=t("h2",{id:"一、运维日志",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#一、运维日志","aria-hidden":"true"},"#"),a(" 一、运维日志")],-1),p={href:"https://github.com/alibaba/canal/wiki",target:"_blank",rel:"noopener noreferrer"},y=t("li",null,"本章节我们会在 docker 环境，把 Mysql 数据库中抽奖系统的分库分表数据使用 canal 同步到 ES 文件系统中",-1),m=t("h2",{id:"二、环境要求",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#二、环境要求","aria-hidden":"true"},"#"),a(" 二、环境要求")],-1),f=r("<p>canal [kə&#39;næl]，译意为水道/管道/沟渠，主要用途是基于 MySQL 数据库增量日志解析，提供增量数据订阅和消费</p><table><thead><tr><th>应用</th><th>端口</th><th>版本</th></tr></thead><tbody><tr><td>Mysql</td><td>3306</td><td>5.7</td></tr><tr><td>ElasticSearch</td><td>9200</td><td>7.6.2</td></tr><tr><td>Kibana</td><td>5601</td><td>7.6.2</td></tr><tr><td>canal.deployer</td><td>11111</td><td>1.1.15</td></tr><tr><td>canal.adapter</td><td>8081</td><td>1.1.15</td></tr><tr><td>canal.admin</td><td>8089</td><td>1.1.15</td></tr></tbody></table>",2),k=t("li",null,"Mysql、ElasticSearch、Kibana，在 Docker 环境已经安装完成，如果尚未安装或者版本不符合可以按照前面章节内容重新安装(PS：版本不匹可能没法同步数据)。",-1),S={href:"https://gitcode.net/KnowledgePlanet/canal",target:"_blank",rel:"noopener noreferrer"},M={href:"https://github.com/alibaba/canal/releases/tag/canal-1.1.5",target:"_blank",rel:"noopener noreferrer"},x=t("ul",null,[t("li",null,"canal.deployer：可以直接监听MySQL的binlog，把自己伪装成MySQL的从库，只负责接收数据，并不做处理。"),t("li",null,"canal.adapter：相当于canal的客户端，会从canal-server中获取数据，然后对数据进行同步，可以同步到MySQL、Elasticsearch和HBase等存储中去。"),t("li",null,"canal.admin：为canal提供整体配置管理、节点运维等面向运维的功能，提供相对友好的WebUI操作界面，方便更多用户快速和安全的操作。")],-1),q=r('<h2 id="三、mysql-配置" tabindex="-1"><a class="header-anchor" href="#三、mysql-配置" aria-hidden="true">#</a> 三、Mysql 配置</h2><p><strong>配置</strong>：对 Mysql 数据库开启 binlog 写入功能，并设置 <code>binlog-format = ROW</code> 同时需要创建一个只读权限的账号，用于订阅 binlog</p><h3 id="_1-查看-binlog-是否启用" tabindex="-1"><a class="header-anchor" href="#_1-查看-binlog-是否启用" aria-hidden="true">#</a> 1. 查看 binlog 是否启用</h3><p><strong>注意</strong>：你可以在 Docker 中使用 <code>docker exec -it [容器ID/容器名称(mysql)] /bin/bash</code> 进入容器后，使用 <code>mysql -u root -p</code> 进入 mysql 后执行命令查看，也可以通过 mysql 可视化工具直接链接后输入查询命令的方式进行查看</p><p><strong>命令</strong>：<code>SHOW VARIABLES LIKE &#39;%log_bin%&#39;;</code></p><table><thead><tr><th style="text-align:center;">已开启 binlog</th><th style="text-align:center;">未开启 binlog</th></tr></thead></table>',6),L=t("ul",null,[t("li",null,"如果你的 Mysql 是未开启 binlog 的，那么需要执行下面的步骤进行开启，否则不能使用 canal 订阅 binlog")],-1);function E(Q,j){const e=c("ExternalLinkIcon");return d(),s("div",null,[h,t("p",null,[a("作者：小傅哥 "),b,a("博客："),t("a",_,[a("https://bugstack.cn"),l(e)])]),g,u,t("ul",null,[t("li",null,[a("canal 是一款 阿里巴巴 MySQL binlog 增量订阅&消费组件，模拟 MySQL slave 的交互协议，伪装自己为 MySQL slave ，向 MySQL master 发送dump 协议。MySQL master 收到 dump 请求，开始推送 binary log 给 slave (即 canal )，canal 解析 binary log 对象(原始为 byte 流)，之后把数据转存到其他需要保存的服务中。文档："),t("a",p,[a("https://github.com/alibaba/canal/wiki"),l(e)])]),y]),m,n(" ![](/images/article/project/lottery/Part-5/8-01.png) "),f,t("ul",null,[k,t("li",null,[a("canal 组件包括：canal.deployer、canal.adapter、canal.admin，本地地址(已做相应的排坑处理)："),t("a",S,[a("https://gitcode.net/KnowledgePlanet/canal"),l(e)]),a("、官网地址(如果有一些个性需求可以下载官网组件)："),t("a",M,[a("https://github.com/alibaba/canal/releases/tag/canal-1.1.5"),l(e)]),x])]),q,n(" | ![](/images/article/project/lottery/Part-5/8-02.png) |  ![](/images/article/project/lottery/Part-5/8-03.png)  | "),L])}const I=o(i,[["render",E],["__file","di08jie：bushuhuanjing canal.html.vue"]]);export{I as default};
