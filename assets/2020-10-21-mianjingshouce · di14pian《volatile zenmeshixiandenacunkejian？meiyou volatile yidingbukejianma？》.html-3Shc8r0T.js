import{_ as t,r as o,o as l,c,a as n,b as s,d as e,e as p}from"./app-3RcBQnkC.js";const i={},r=n("h1",{id:"é¢ç»æ‰‹å†Œ-Â·-ç¬¬14ç¯‡ã€Švolatile-æ€ä¹ˆå®ç°çš„å†…å­˜å¯è§-æ²¡æœ‰-volatile-ä¸€å®šä¸å¯è§å—-ã€‹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#é¢ç»æ‰‹å†Œ-Â·-ç¬¬14ç¯‡ã€Švolatile-æ€ä¹ˆå®ç°çš„å†…å­˜å¯è§-æ²¡æœ‰-volatile-ä¸€å®šä¸å¯è§å—-ã€‹","aria-hidden":"true"},"#"),s(" é¢ç»æ‰‹å†Œ Â· ç¬¬14ç¯‡ã€Švolatile æ€ä¹ˆå®ç°çš„å†…å­˜å¯è§ï¼Ÿæ²¡æœ‰ volatile ä¸€å®šä¸å¯è§å—ï¼Ÿã€‹")],-1),u=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=p(`<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><h2 id="ä¸€ã€ç åœºå¿ƒå¾—" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€ç åœºå¿ƒå¾—" aria-hidden="true">#</a> ä¸€ã€ç åœºå¿ƒå¾—</h2><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-14-02.png" alt=""></p><p><code>ä½ æ˜¯ä¸ªèƒ½åƒè‹¦çš„äººå—ï¼Ÿ</code></p><p>ä»å‰çš„èƒ½åƒè‹¦å¤§å¤šæŒ‡çš„ä½“åŠ›åŠ³åŠ¨çš„è‹¦ï¼Œä½†ç°åœ¨çš„èƒ½åƒè‹¦å·²ç»åŒ…æ‹¬å¤ªå¤šç»´åº¦ï¼ŒåŒ…æ‹¬ï¼š<code>è¯»ä¹¦å­¦ä¹ &amp;å¯‚å¯çš„è‹¦</code>ã€<code>æ·±åº¦æ€è€ƒ&amp;è„‘åŠ›çš„è‹¦</code>ã€<code>è‡ªå¾‹ä¹ æƒ¯&amp;ä¿®è¡Œçš„è‹¦</code>ã€<code>è‡ªæ§èƒ½åŠ›&amp;æ”¾å¼ƒçš„è‹¦</code>ã€<code>ä½å¤´åšäºº&amp;å°Šä¸¥çš„è‹¦</code>ã€‚</p><p>è™½ç„¶è¿™äº›è‹¦æ‘†åœ¨çœ¼å‰ï¼Œä½†å¤§å¤šæ•°äººè¿˜æ˜¯å–œæ¬¢åƒç®€å•çš„è‹¦ã€‚ç†¬å¤œåŠ ç­ã€æ—¥å¤ä¸€æ—¥ã€é‡å¤æ˜¨å¤©ã€CRUDï¼Œæœ€åèº«ä½“å‘èƒ–ã€ä½“è´¨ä¸‹é™ã€èƒ½åŠ›ä¸è¶³ã€è‡ªæŠ±è‡ªæ³£ï¼æ‰€ä»¥æœ‰äº›è‹¦èƒ½ä¸åƒå°±ä¸åƒï¼Œè¦åƒå°±åƒé‚£äº›æœ‰æˆé•¿ä»·å€¼çš„è‹¦ã€‚</p><p><code>ä»Šå¤©ä½ å†™åšå®¢äº†å—ï¼Ÿ</code></p><p>å¦‚æœä¸€ä»¶å°äº‹èƒ½åšæŒ5å¹´ä»¥ä¸Šï¼Œé‚£ä½ ä¸€å®šæ˜¯å¾ˆäº†ä¸èµ·çš„äººã€‚æ˜¯çš„ï¼Œå¾ˆäº†ä¸èµ·ã€‚äººæœ€éš¾çš„å°±æ˜¯æƒ³æ¸…æ¥šäº†ä½†åšä¸åˆ°ï¼Œæˆ–è€…å¶å°”åšåˆ°é•¿æœŸåšä¸åˆ°ã€‚</p><p>å…¶å®å¤§å¤šæ•°èµ°åœ¨ç ”å‘è·¯ä¸Šçš„ä¼™ä¼´ä»¬ï¼Œéƒ½çŸ¥é“è‡ªå·±è¯¥åŠªåŠ›ï¼Œä½†æ˜æ˜ä¸‹å¥½äº†çš„å†³å¿ƒå°±æ˜¯åšæŒä¸äº†å¤šä¹…ã€‚å°±åƒä½ æ˜¯å¦ä¹Ÿæƒ³è¿‡è¦å†™æŠ€æœ¯åšå®¢ï¼ŒåšæŠ€æœ¯ç§¯ç´¯ã€‚ç›´åˆ°æœ‰ä¸€å¤©è¢«ç“¶é¢ˆé™åˆ¶åœ¨å›°å±€ä¸­æ‰ä¼šç€æ€¥ï¼Œä½†è¿™æ—¶å€™åœ¨æƒ³ç ´å±€å°±çœŸçš„å¾ˆéš¾äº†ï¼</p><h2 id="äºŒã€é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#äºŒã€é¢è¯•é¢˜" aria-hidden="true">#</a> äºŒã€é¢è¯•é¢˜</h2><p><code>è°¢é£æœºï¼Œå°è®°</code>ï¼Œé£æœºè¶ç€å‘¨æœ«ï¼Œåƒå®Œç«é”…ã€‚åˆå»çº¦é¢è¯•å®˜å–èŒ¶äº†ï¼</p><p><strong>è°¢é£æœº</strong>ï¼šå—¨ï¼Œæˆ‘åœ¨è¿™ï¼Œè¿™è¾¹ï¼Œè¿™è¾¹ã€‚</p><p><strong>é¢è¯•å®˜</strong>ï¼šä½ æ€ä¹ˆåˆæ¥äº†ï¼Œæœ€è¿‘å­¦çš„ä¸é”™äº†ï¼Ÿ</p><p><strong>è°¢é£æœº</strong>ï¼šè¿˜æ˜¯æƒ³æ¥å¤§å‚ï¼Œåˆ«å®³ç¾ï¼Œé¢æˆ‘å§ï¼</p><p><strong>é¢è¯•å®˜</strong>ï¼šæˆ‘å¥½åƒæ˜¯ä½ è¡¥è¯¾è€å¸ˆ... æ—¢ç„¶æ¥äº†ï¼Œå°±é—®é—®ä½ å§ï¼volatile æ˜¯å¹²å•¥çš„ï¼Ÿ</p><p><strong>è°¢é£æœº</strong>ï¼šå•Šï¼Œvolatile æ˜¯ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§çš„ã€‚</p><p><strong>é¢è¯•å®˜</strong>ï¼šé‚£ volatile å¯ä»¥è§£å†³åŸå­æ€§é—®é¢˜å—ï¼Ÿ</p><p><strong>è°¢é£æœº</strong>ï¼šä¸å¯ä»¥ï¼</p><p><strong>é¢è¯•å®˜</strong>ï¼šé‚£ volatile çš„åº•å±‚åŸç†æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</p><p><strong>è°¢é£æœº</strong>ï¼š...ï¼Œè¿™ï¼<em>é¢è¯•å®˜ï¼Œåˆšé—®ä¸¤ä¸ªé¢˜å°±ç”©é›·</em>ï¼Œä½ æ˜¯ä¸å®¶é‡Œæœ‰äº‹è¦å¿™ï¼Ÿ</p><p><strong>é¢è¯•å®˜</strong>ï¼šä½ ç®¡æˆ‘ï¼</p><h2 id="ä¸‰ã€volatile-è®²è§£" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€volatile-è®²è§£" aria-hidden="true">#</a> ä¸‰ã€volatile è®²è§£</h2><h3 id="_1-å¯è§æ€§æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_1-å¯è§æ€§æ¡ˆä¾‹" aria-hidden="true">#</a> 1. å¯è§æ€§æ¡ˆä¾‹</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">VT</span> vt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span> <span class="token class-name">Thread01</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>vt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> <span class="token class-name">Thread02</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token punctuation">}</span>
                vt<span class="token punctuation">.</span>sign <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;vt.sign = true é€šçŸ¥ while (!sign) ç»“æŸï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread01</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread02</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">VT</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> sign <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sign<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä½ å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¿™æ®µä»£ç </strong>ï¼Œæ˜¯ä¸¤ä¸ªçº¿ç¨‹æ“ä½œä¸€ä¸ªå˜é‡ï¼Œç¨‹åºæœŸæœ›å½“ <code>sign</code> åœ¨çº¿ç¨‹ Thread01 è¢«æ“ä½œ <code>vt.sign = true</code> æ—¶ï¼ŒThread02 è¾“å‡º <em>ä½ å</em>ã€‚</p><p>ä½†å®é™…ä¸Šè¿™æ®µä»£ç æ°¸è¿œä¸ä¼šè¾“å‡º <em>ä½ å</em>ï¼Œè€Œæ˜¯ä¸€ç›´å¤„äºæ­»å¾ªç¯ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€æ­¥æ­¥è®²è§£å’ŒéªŒè¯ã€‚</p><h3 id="_2-åŠ ä¸Švolatileå…³é”®å­—" tabindex="-1"><a class="header-anchor" href="#_2-åŠ ä¸Švolatileå…³é”®å­—" aria-hidden="true">#</a> 2. åŠ ä¸Švolatileå…³é”®å­—</h3><p>æˆ‘ä»¬æŠŠ sign å…³é”®å­—åŠ ä¸Š volatitle æè¿°ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">VT</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> sign <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sign<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä½ å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>vt<span class="token punctuation">.</span>sign <span class="token operator">=</span> <span class="token boolean">true</span> é€šçŸ¥ <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sign<span class="token punctuation">)</span> ç»“æŸï¼
ä½ å

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>volatileå…³é”®å­—æ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œå®ƒä½œä¸ºä¸€ä¸ªä¿®é¥°ç¬¦å‡ºç°ï¼Œç”¨æ¥ä¿®é¥°å˜é‡ï¼Œä½†æ˜¯è¿™é‡Œä¸åŒ…æ‹¬å±€éƒ¨å˜é‡å“¦</p><p>åœ¨æ·»åŠ  volatile å…³é”®å­—åï¼Œç¨‹åºå°±ç¬¦åˆé¢„æœŸçš„è¾“å‡ºäº† <em>ä½ å</em>ã€‚ä»æˆ‘ä»¬å¯¹ volatile çš„å­¦ä¹ è®¤çŸ¥å¯ä»¥çŸ¥é“ã€‚volatileå…³é”®å­—æ˜¯ JVM æä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œç”¨æ¥ä¿®é¥°å˜é‡ï¼Œç”¨æ¥ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§æ€§ã€‚</p><p>æ­£åœ¨ä¿®é¥°åå¯ä»¥è®©å­—æ®µåœ¨çº¿ç¨‹è§å¯è§ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§è¢«ä¿®æ”¹å€¼åï¼Œå¯ä»¥åŠæ—¶çš„åœ¨å¦å¤–çš„çº¿ç¨‹ä¸­åšå‡ºç›¸åº”çš„ååº”ã€‚</p><h3 id="_3-volatileæ€ä¹ˆä¿è¯çš„å¯è§æ€§" tabindex="-1"><a class="header-anchor" href="#_3-volatileæ€ä¹ˆä¿è¯çš„å¯è§æ€§" aria-hidden="true">#</a> 3. volatileæ€ä¹ˆä¿è¯çš„å¯è§æ€§</h3><h4 id="_3-1-æ— volatileæ—¶-å†…å­˜å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_3-1-æ— volatileæ—¶-å†…å­˜å˜åŒ–" aria-hidden="true">#</a> 3.1 æ— volatileæ—¶ï¼Œå†…å­˜å˜åŒ–</h4><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-14-03.png" alt="æ— volatileæ—¶ï¼Œå†…å­˜å˜åŒ–"></p><p>é¦–å…ˆæ˜¯å½“ sign æ²¡æœ‰ volatitle ä¿®é¥°æ—¶ <code>public boolean sign = false;</code>ï¼Œçº¿ç¨‹01å¯¹å˜é‡è¿›è¡Œæ“ä½œï¼Œçº¿ç¨‹02å¹¶ä¸ä¼šæ‹¿åˆ°å˜åŒ–çš„å€¼ã€‚æ‰€ä»¥ç¨‹åºä¹Ÿå°±ä¸ä¼šè¾“å‡ºç»“æœ â€œä½ åâ€</p><h4 id="_3-2-æœ‰volatileæ—¶-å†…å­˜å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_3-2-æœ‰volatileæ—¶-å†…å­˜å˜åŒ–" aria-hidden="true">#</a> 3.2 æœ‰volatileæ—¶ï¼Œå†…å­˜å˜åŒ–</h4><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-14-04.png" alt="æœ‰volatileæ—¶ï¼Œå†…å­˜å˜åŒ–"></p><p>å½“æˆ‘ä»¬æŠŠå˜é‡ä½¿ç”¨ volatile ä¿®é¥°æ—¶ <code>public volatile boolean sign = false;</code>ï¼Œçº¿ç¨‹01å¯¹å˜é‡è¿›è¡Œæ“ä½œæ—¶ï¼Œä¼šæŠŠå˜é‡å˜åŒ–çš„å€¼å¼ºåˆ¶åˆ·æ–°çš„åˆ°ä¸»å†…å­˜ã€‚å½“çº¿ç¨‹02è·å–å€¼æ—¶ï¼Œä¼šæŠŠè‡ªå·±çš„å†…å­˜é‡Œçš„ sign å€¼è¿‡æœŸæ‰ï¼Œä¹‹åä»ä¸»å†…å­˜ä¸­è¯»å–ã€‚æ‰€ä»¥æ·»åŠ å…³é”®å­—åç¨‹åºå¦‚é¢„æœŸè¾“å‡ºç»“æœã€‚</p><h3 id="_4-åç¼–è¯‘è§£æ¯’å¯è§æ€§" tabindex="-1"><a class="header-anchor" href="#_4-åç¼–è¯‘è§£æ¯’å¯è§æ€§" aria-hidden="true">#</a> 4. åç¼–è¯‘è§£æ¯’å¯è§æ€§</h3><p>ç±»ä¼¼è¿™æ ·æœ‰æ·±åº¦çš„æŠ€æœ¯çŸ¥è¯†ï¼Œæœ€ä½³çš„æ–¹å¼å°±æ˜¯æ·±å…¥ç†è§£åŸç†ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆæ‰ä¿è¯çš„å†…å­˜å¯è§æ€§æ“ä½œã€‚</p><h4 id="_4-1-æŸ¥çœ‹jvmæŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#_4-1-æŸ¥çœ‹jvmæŒ‡ä»¤" aria-hidden="true">#</a> 4.1 æŸ¥çœ‹JVMæŒ‡ä»¤</h4><p><strong>æŒ‡ä»¤</strong>ï¼š<code>javap -v -p VT</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> sign<span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token class-name">Z</span>
    flags<span class="token operator">:</span> <span class="token constant">ACC_PUBLIC</span><span class="token punctuation">,</span> <span class="token constant">ACC_VOLATILE</span>

  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">VT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span>
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span><span class="token operator">:</span> aload_0
         <span class="token number">1</span><span class="token operator">:</span> invokespecial #<span class="token number">1</span>                  <span class="token comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
         <span class="token number">4</span><span class="token operator">:</span> aload_0
         <span class="token number">5</span><span class="token operator">:</span> iconst_0
         <span class="token number">6</span><span class="token operator">:</span> putfield      #<span class="token number">2</span>                  <span class="token comment">// Field sign:Z</span>
         <span class="token number">9</span><span class="token operator">:</span> <span class="token keyword">return</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">35</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">37</span><span class="token operator">:</span> <span class="token number">4</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>      <span class="token number">10</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lorg</span><span class="token operator">/</span>itstack<span class="token operator">/</span>interview<span class="token operator">/</span>test<span class="token operator">/</span><span class="token constant">VT</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span> <span class="token constant">ACC_PUBLIC</span>
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span><span class="token operator">:</span> aload_0
         <span class="token number">1</span><span class="token operator">:</span> getfield      #<span class="token number">2</span>                  <span class="token comment">// Field sign:Z</span>
         <span class="token number">4</span><span class="token operator">:</span> ifne          <span class="token number">10</span>
         <span class="token number">7</span><span class="token operator">:</span> <span class="token keyword">goto</span>          <span class="token number">0</span>
        <span class="token number">10</span><span class="token operator">:</span> getstatic     #<span class="token number">3</span>                  <span class="token comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span>
        <span class="token number">13</span><span class="token operator">:</span> ldc           #<span class="token number">4</span>                  <span class="token comment">// String ä½ å</span>
        <span class="token number">15</span><span class="token operator">:</span> invokevirtual #<span class="token number">5</span>                  <span class="token comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
        <span class="token number">18</span><span class="token operator">:</span> <span class="token keyword">return</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">40</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">42</span><span class="token operator">:</span> <span class="token number">10</span>
        line <span class="token number">43</span><span class="token operator">:</span> <span class="token number">18</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>      <span class="token number">19</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lorg</span><span class="token operator">/</span>itstack<span class="token operator">/</span>interview<span class="token operator">/</span>test<span class="token operator">/</span><span class="token constant">VT</span><span class="token punctuation">;</span>
      <span class="token class-name">StackMapTable</span><span class="token operator">:</span> number_of_entries <span class="token operator">=</span> <span class="token number">2</span>
        frame_type <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">/* same */</span>
        frame_type <span class="token operator">=</span> <span class="token number">9</span> <span class="token comment">/* same */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»JVMæŒ‡ä»¤ç ä¸­åªä¼šå‘ç°å¤šäº†ï¼Œ<code>ACC_VOLATILE</code>ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆå…¶ä»–çš„ç‚¹ã€‚æ‰€ä»¥ï¼Œä¹Ÿä¸èƒ½çœ‹å‡ºæ˜¯æ€ä¹ˆå®ç°çš„å¯è§æ€§ã€‚</p><h4 id="_4-2-æŸ¥çœ‹æ±‡ç¼–æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#_4-2-æŸ¥çœ‹æ±‡ç¼–æŒ‡ä»¤" aria-hidden="true">#</a> 4.2 æŸ¥çœ‹æ±‡ç¼–æŒ‡ä»¤</h4><p>é€šè¿‡Classæ–‡ä»¶æŸ¥çœ‹æ±‡ç¼–ï¼Œéœ€è¦ä¸‹è½½ hsdis-amd64.dll æ–‡ä»¶ï¼Œå¤åˆ¶åˆ° <code>JAVA_HOME\\jre\\bin\\serverç›®å½•ä¸‹</code>ã€‚ä¸‹è½½èµ„æºå¦‚ä¸‹ï¼š</p>`,49),m={href:"http://vorboss.dl.sourceforge.net/project/fcml/fcml-1.1.1/hsdis-1.1.1-win32-amd64.zip",target:"_blank",rel:"noopener noreferrer"},v={href:"http://vorboss.dl.sourceforge.net/project/fcml/fcml-1.1.1/hsdis-1.1.1-win32-i386.zip",target:"_blank",rel:"noopener noreferrer"},b=p(`<p>å¦å¤–æ˜¯æ‰§è¡Œå‘½ä»¤ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>åŸºç¡€æŒ‡ä»¤ï¼š<code>java -Xcomp -XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly</code></li><li>æŒ‡å®šæ‰“å°ï¼š<code>-XX:CompileCommand=dontinline,ç±»å.æ–¹æ³•å</code></li><li>æŒ‡å®šæ‰“å°ï¼š<code>-XX:CompileCommand=compileonly,ç±»å.æ–¹æ³•å</code></li><li>è¾“å‡ºä½ç½®ï¼š<code>&gt; xxx</code></li></ol><p>æœ€ç»ˆä½¿ç”¨ï¼š<code>java -Xcomp -XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly -XX:CompileCommand=dontinline,ApiTest.main -XX:CompileCommand=compileonly,ApiTest.mian</code></p><p><em>æŒ‡ä»¤å¯ä»¥åœ¨IDEAä¸­çš„ Terminal é‡Œä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åˆ° DOSé»‘çª—å£ä¸­ä½¿ç”¨</em></p><p><strong>å¦å¤–</strong>ï¼Œä¸ºäº†æ›´ç®€å•çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬æŠŠæŒ‡ä»¤å¯ä»¥é…ç½®åˆ°ideaçš„ VM options é‡Œï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-14-05.png" alt="Idea VM options é…ç½®ç¼–è¯‘æŒ‡ä»¤"></p><p>é…ç½®å®Œæˆåï¼Œä¸å‡ºæ„å¤–çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Loaded</span> disassembler from <span class="token class-name">C</span><span class="token operator">:</span>\\<span class="token class-name">Program</span> <span class="token class-name">Files</span>\\<span class="token class-name">Java</span>\\jdk1<span class="token punctuation">.</span><span class="token number">8.0_161</span>\\jre\\bin\\server\\hsdis<span class="token operator">-</span>amd64<span class="token punctuation">.</span>dll
<span class="token class-name">Decoding</span> compiled method <span class="token number">0x0000000003744990</span><span class="token operator">:</span>
<span class="token class-name">Code</span><span class="token operator">:</span>
<span class="token class-name">Argument</span> <span class="token number">0</span> is unknown<span class="token punctuation">.</span><span class="token constant">RIP</span><span class="token operator">:</span> <span class="token number">0x3744ae0</span> <span class="token class-name">Code</span> size<span class="token operator">:</span> <span class="token number">0x00000110</span>
<span class="token punctuation">[</span><span class="token class-name">Disassembling</span> <span class="token keyword">for</span> mach<span class="token operator">=</span><span class="token char">&#39;amd64&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Entry</span> <span class="token class-name">Point</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Constants</span><span class="token punctuation">]</span>
  # <span class="token punctuation">{</span>method<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token number">0x000000001c853d18</span><span class="token punctuation">}</span> &#39;getSnapshotTransformerList<span class="token char">&#39; &#39;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token class-name">Lsun</span><span class="token operator">/</span>instrument<span class="token operator">/</span><span class="token class-name">TransformerManager</span>$<span class="token class-name">TransformerInfo</span><span class="token punctuation">;</span><span class="token char">&#39; in &#39;</span>sun<span class="token operator">/</span>instrument<span class="token operator">/</span><span class="token class-name">TransformerManager</span>&#39;
  #           <span class="token punctuation">[</span>sp<span class="token operator">+</span><span class="token number">0x40</span><span class="token punctuation">]</span>  <span class="token punctuation">(</span>sp of caller<span class="token punctuation">)</span>
  <span class="token number">0x0000000003744ae0</span><span class="token operator">:</span> mov     r10d<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">8</span>h<span class="token punctuation">]</span>
  <span class="token number">0x0000000003744ae4</span><span class="token operator">:</span> shl     r10<span class="token punctuation">,</span><span class="token number">3</span>h
  <span class="token number">0x0000000003744ae8</span><span class="token operator">:</span> cmp     r10<span class="token punctuation">,</span>rax
  <span class="token number">0x0000000003744aeb</span><span class="token operator">:</span> jne     <span class="token number">3685f</span><span class="token number">60</span>h          <span class="token punctuation">;</span>   <span class="token punctuation">{</span>runtime_call<span class="token punctuation">}</span>
  <span class="token number">0x0000000003744af1</span><span class="token operator">:</span> nop     word ptr <span class="token punctuation">[</span>rax<span class="token operator">+</span>rax<span class="token operator">+</span><span class="token number">0</span>h<span class="token punctuation">]</span>
  <span class="token number">0x0000000003744afc</span><span class="token operator">:</span> nop
<span class="token punctuation">[</span><span class="token class-name">Verified</span> <span class="token class-name">Entry</span> <span class="token class-name">Point</span><span class="token punctuation">]</span>
  <span class="token number">0x0000000003744b00</span><span class="token operator">:</span> mov     dword ptr <span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">0f</span>fffffffffffa000h<span class="token punctuation">]</span><span class="token punctuation">,</span>eax
  <span class="token number">0x0000000003744b07</span><span class="token operator">:</span> push    rbp
  <span class="token number">0x0000000003744b08</span><span class="token operator">:</span> sub     rsp<span class="token punctuation">,</span><span class="token number">30</span>h           <span class="token punctuation">;</span><span class="token operator">*</span>aload_0
                                                <span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>instrument<span class="token punctuation">.</span></span>TransformerManager</span><span class="token operator">::</span><span class="token function">getSnapshotTransformerList</span><span class="token annotation punctuation">@0</span> <span class="token punctuation">(</span>line <span class="token number">166</span><span class="token punctuation">)</span>

  <span class="token number">0x0000000003744b0c</span><span class="token operator">:</span> mov     eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">10</span>h<span class="token punctuation">]</span>
  <span class="token number">0x0000000003744b0f</span><span class="token operator">:</span> shl     rax<span class="token punctuation">,</span><span class="token number">3</span>h            <span class="token punctuation">;</span><span class="token operator">*</span>getfield mTransformerList
                                                <span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>instrument<span class="token punctuation">.</span></span>TransformerManager</span><span class="token operator">::</span><span class="token function">getSnapshotTransformerList</span><span class="token annotation punctuation">@1</span> <span class="token punctuation">(</span>line <span class="token number">166</span><span class="token punctuation">)</span>

  <span class="token number">0x0000000003744b13</span><span class="token operator">:</span> add     rsp<span class="token punctuation">,</span><span class="token number">30</span>h
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¿è¡Œç»“æœå°±æ˜¯æ±‡ç¼–æŒ‡ä»¤</strong>ï¼Œæ¯”è¾ƒå¤šè¿™é‡Œå°±ä¸éƒ½æ”¾äº†ã€‚æˆ‘ä»¬åªè§‚å¯ŸğŸ•µé‡ç‚¹éƒ¨åˆ†ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>   <span class="token number">0x0000000003324cda</span><span class="token operator">:</span> mov    <span class="token function">0x74</span><span class="token punctuation">(</span><span class="token operator">%</span>r8<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">%</span>edx     <span class="token punctuation">;</span><span class="token operator">*</span>getstatic state
                                                 <span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token constant">VT</span><span class="token operator">::</span><span class="token function">run</span><span class="token annotation punctuation">@28</span> <span class="token punctuation">(</span>line <span class="token number">27</span><span class="token punctuation">)</span>
 
   <span class="token number">0x0000000003324cde</span><span class="token operator">:</span> inc    <span class="token operator">%</span>edx
   <span class="token number">0x0000000003324ce0</span><span class="token operator">:</span> mov    <span class="token operator">%</span>edx<span class="token punctuation">,</span><span class="token function">0x74</span><span class="token punctuation">(</span><span class="token operator">%</span>r8<span class="token punctuation">)</span>
   <span class="token number">0x0000000003324ce4</span><span class="token operator">:</span> lock addl $<span class="token number">0x0</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">%</span>rsp<span class="token punctuation">)</span>     <span class="token punctuation">;</span><span class="token operator">*</span>putstatic state
                                                 <span class="token punctuation">;</span> <span class="token operator">-</span> <span class="token constant">VT</span><span class="token operator">::</span><span class="token function">run</span><span class="token annotation punctuation">@33</span> <span class="token punctuation">(</span>line <span class="token number">27</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–è¯‘åçš„æ±‡ç¼–æŒ‡ä»¤ä¸­ï¼Œæœ‰volatileå…³é”®å­—å’Œæ²¡æœ‰volatileå…³é”®å­—ï¼Œä¸»è¦å·®åˆ«åœ¨äºå¤šäº†ä¸€ä¸ª <code>lock addl $0x0,(%rsp)</code>ï¼Œä¹Ÿå°±æ˜¯lockçš„å‰ç¼€æŒ‡ä»¤ã€‚</p><p><strong>lockæŒ‡ä»¤</strong>ç›¸å½“äºä¸€ä¸ª<em>å†…å­˜å±éšœ</em>ï¼Œå®ƒä¿è¯å¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ol><li>å°†æœ¬å¤„ç†å™¨çš„ç¼“å­˜å†™å…¥å†…å­˜ã€‚</li><li>é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤é‡æ’åºåˆ°å†…å­˜å±éšœä¹‹å‰çš„ä½ç½®ã€‚</li><li>å¦‚æœæ˜¯å†™å…¥åŠ¨ä½œä¼šå¯¼è‡´å…¶ä»–å¤„ç†å™¨ä¸­å¯¹åº”çš„å†…å­˜æ— æ•ˆã€‚</li></ol><p>é‚£ä¹ˆï¼Œè¿™é‡Œçš„1ã€3å°±æ˜¯ç”¨æ¥ä¿è¯è¢«ä¿®é¥°çš„å˜é‡ï¼Œä¿è¯å†…å­˜å¯è§æ€§ã€‚</p><h3 id="_5-ä¸åŠ volatileä¹Ÿå¯è§å—" tabindex="-1"><a class="header-anchor" href="#_5-ä¸åŠ volatileä¹Ÿå¯è§å—" aria-hidden="true">#</a> 5. ä¸åŠ volatileä¹Ÿå¯è§å—</h3><p><code>æœ‰è´¨ç–‘å°±è¦æœ‰éªŒè¯</code></p><p>æˆ‘ä»¬ç°åœ¨å†æŠŠä¾‹å­ä¿®æ”¹ä¸‹ï¼Œåœ¨ <code>while (!sign)</code> å¾ªç¯ä½“ä¸­æ·»åŠ ä¸€æ®µæ‰§è¡Œä»£ç ï¼Œå¦‚ä¸‹ï¼›</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">VT</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> sign <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sign<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä½ å¥½&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä½ å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹åå»æ‰äº† <code>volatile</code> å…³é”®å­—ï¼Œå¹¶åœ¨whileå¾ªç¯ä¸­æ·»åŠ ä¸€æ®µä»£ç ã€‚ç°åœ¨çš„è¿è¡Œç»“æœæ˜¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
ä½ å¥½
ä½ å¥½
ä½ å¥½
vt<span class="token punctuation">.</span>sign <span class="token operator">=</span> <span class="token boolean">true</span> é€šçŸ¥ <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sign<span class="token punctuation">)</span> ç»“æŸï¼
ä½ å

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å’‹æ ·</strong>ï¼Œåˆå¯è§äº†å§ï¼</p><p>è¿™æ˜¯å› ä¸ºåœ¨æ²¡ volatile ä¿®é¥°æ—¶ï¼Œjvmä¹Ÿä¼šå°½é‡ä¿è¯å¯è§æ€§ã€‚â€‹æœ‰ volatile ä¿®é¥°çš„æ—¶å€™ï¼Œä¸€å®šä¿è¯å¯è§æ€§ã€‚<strong>ä½†å¯èƒ½å¹¶éå¦‚æ­¤ï¼Œä¸‹ç« èŠ‚ç»§ç»­æ·±æŒ–ï¼</strong></p><h2 id="å››ã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å››ã€æ€»ç»“" aria-hidden="true">#</a> å››ã€æ€»ç»“</h2><ul><li>æœ€åæˆ‘ä»¬å†æ€»ç»“ä¸‹ volatileï¼Œå®ƒå‘¢ï¼Œä¼šæ§åˆ¶è¢«ä¿®é¥°çš„å˜é‡åœ¨å†…å­˜æ“ä½œä¸Šä¸»åŠ¨æŠŠå€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼ŒJMM ä¼šæŠŠè¯¥çº¿ç¨‹å¯¹åº”çš„CPUå†…å­˜è®¾ç½®è¿‡æœŸï¼Œä»ä¸»å†…å­˜ä¸­è¯»å–æœ€æ–°å€¼ã€‚</li><li>é‚£ä¹ˆï¼Œvolatile å¦‚ä½•é˜²æ­¢æŒ‡ä»¤é‡æ’ä¹Ÿæ˜¯å†…å­˜å±éšœï¼Œvolatile çš„å†…å­˜å±æ•…éšœæ˜¯åœ¨è¯»å†™æ“ä½œçš„å‰åå„æ·»åŠ ä¸€ä¸ª StoreStoreå±éšœï¼Œä¹Ÿå°±æ˜¯å››ä¸ªä½ç½®ï¼Œæ¥ä¿è¯é‡æ’åºæ—¶ä¸èƒ½æŠŠå†…å­˜å±éšœåé¢çš„æŒ‡ä»¤é‡æ’åºåˆ°å†…å­˜å±éšœä¹‹å‰çš„ä½ç½®ã€‚</li><li>å¦å¤– volatile å¹¶ä¸èƒ½è§£å†³åŸå­æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³åŸå­æ€§é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨ synchronzied æˆ–è€… lockï¼Œè¿™éƒ¨åˆ†å†…å®¹åœ¨æˆ‘ä»¬åç»­ç« èŠ‚ä¸­ä»‹ç»ã€‚</li></ul>`,24);function h(g,f){const a=o("ExternalLinkIcon");return l(),c("div",null,[r,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),u,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),e(a)])]),d,n("ul",null,[n("li",null,[n("a",m,[s("http://vorboss.dl.sourceforge.net/project/fcml/fcml-1.1.1/hsdis-1.1.1-win32-amd64.zip"),e(a)])]),n("li",null,[n("a",v,[s("http://vorboss.dl.sourceforge.net/project/fcml/fcml-1.1.1/hsdis-1.1.1-win32-i386.zip"),e(a)])])]),b])}const _=t(i,[["render",h],["__file","2020-10-21-mianjingshouce Â· di14pianã€Švolatile zenmeshixiandenacunkejianï¼Ÿmeiyou volatile yidingbukejianmaï¼Ÿã€‹.html.vue"]]);export{_ as default};
