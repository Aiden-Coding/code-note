import{_ as p,r as c,o,c as l,a as n,b as s,d as e,e as t}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"é‡å­¦-java-è®¾è®¡æ¨¡å¼-å®æˆ˜æŠ½è±¡å·¥å‚æ¨¡å¼ã€Œæ›¿æ¢redisåŒé›†ç¾¤å‡çº§-ä»£ç†ç±»æŠ½è±¡åœºæ™¯ã€",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#é‡å­¦-java-è®¾è®¡æ¨¡å¼-å®æˆ˜æŠ½è±¡å·¥å‚æ¨¡å¼ã€Œæ›¿æ¢redisåŒé›†ç¾¤å‡çº§-ä»£ç†ç±»æŠ½è±¡åœºæ™¯ã€","aria-hidden":"true"},"#"),s(" é‡å­¦ Java è®¾è®¡æ¨¡å¼ï¼šå®æˆ˜æŠ½è±¡å·¥å‚æ¨¡å¼ã€Œæ›¿æ¢RedisåŒé›†ç¾¤å‡çº§ï¼Œä»£ç†ç±»æŠ½è±¡åœºæ™¯ã€")],-1),d=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},r=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),v=n("iframe",{id:"B-Video",src:"//player.bilibili.com/player.html?aid=767337308&bvid=BV1ir4y1i7uf&cid=551397526&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"480"}," ",-1),m=t('<h2 id="ä¸€ã€å‰è¨€" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€å‰è¨€" aria-hidden="true">#</a> ä¸€ã€å‰è¨€</h2><p><code>ä»£ç ä¸€æŠŠæ¢­ï¼Œå…„å¼Ÿæ¥èƒŒé”…ã€‚</code></p><p>å¤§éƒ¨åˆ†åšå¼€å‘çš„å°ä¼™ä¼´åˆå¿ƒéƒ½å¸Œæœ›æŠŠä»£ç å†™å¥½ï¼Œé™¤äº†æŠŠç¼–ç¨‹å½“ä½œå·¥ä½œä»¥å¤–ä»–ä»¬è¿˜æ˜¯å…·å¤‡å·¥åŒ ç²¾ç¥çš„ä»ä¸šè€…ã€‚ä½†å¾ˆå¤šæ—¶å€™åˆå¾ˆéš¾è®©ä½ æŠŠåˆå¿ƒåšæŒä¸‹å»ï¼Œå°±åƒï¼›æ¥äº†ä¸ªçƒ‚æ‰‹çš„é¡¹ç›®ã€äº§å“åŠŸèƒ½è¦çš„æ€¥ã€ä¸ªäººèƒ½åŠ›ä¸è¶³ï¼Œç­‰ç­‰åŸå› å¯¼è‡´å·¥ç¨‹ä»£ç è‡ƒè‚¿ä¸å ªï¼Œçº¿ä¸Šé¢‘å‡ºäº‹æ•…ï¼Œæœ€ç»ˆç¦»èŒèµ°äººã€‚</p><p><code>çœ‹äº†å¾ˆå¤šä¹¦ã€å­¦äº†å¾ˆå¤šçŸ¥è¯†ï¼Œå¤šçº¿ç¨‹èƒ½ç©å‡ºèŠ±ï¼Œå¯æœ€åæˆ‘è¿˜æ˜¯å†™ä¸å¥½ä»£ç ï¼</code></p><p>è¿™å°±æœ‰ç‚¹åƒå®¶é‡Œè£…ä¿®å®Œäº†ä¹°ç‰©ä»¶ï¼Œæˆ‘å‡ åä¸‡çš„å®æœ¨æ²™å‘ï¼Œæ€ä¹ˆæ”¾è¿™é‡Œå°±ä¸å¥½çœ‹ã€‚åŒæ ·ä»£ç å†™çš„ä¸å¥½å¹¶ä¸ä¸€å®šæ˜¯åŸºç¡€æŠ€æœ¯ä¸è¶³ï¼Œä¹Ÿä¸ä¸€å®šæ˜¯äº§å“è¦å¾—æ€¥ <code>æ€ä¹ˆå®ç°æˆ‘ä¸ç®¡æ˜å¤©ä¸Šçº¿</code>ã€‚è€Œå¾ˆå¤šæ—¶å€™æ˜¯æˆ‘ä»¬å¯¹ç¼–ç çš„ç»éªŒçš„ä¸è¶³å’Œå¯¹æ¶æ„çš„æŠŠæ§èƒ½åŠ›ä¸åˆ°ä½ï¼Œæˆ‘ç›¸ä¿¡äº§å“çš„ç¬¬ä¸€ä¸ªéœ€æ±‚å¾€å¾€éƒ½ä¸å¤æ‚ï¼Œç”šè‡³æ‰€è§æ‰€å¾—ã€‚ä½†å¦‚æœä½ ä¸è€ƒè™‘åç»­çš„æ˜¯å¦ä¼šæ‹“å±•ï¼Œå°†æ¥ä¼šåœ¨å“ªäº›æ¨¡å—ç»§ç»­æ·»åŠ åŠŸèƒ½ï¼Œé‚£ä¹ˆåç»­çš„ä»£ç å°±ä¼šéšç€ä½ ç§ä¸‹çš„ç¬¬ä¸€é¢—æ¶æ€§çš„ç§å­å¼€å§‹è”“å»¶ã€‚</p><p><code>å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿ƒå¾—æœ‰å“ªäº›ï¼Œæ€ä¹ˆå­¦æ‰ä¼šç”¨ï¼</code></p><p>è®¾è®¡æ¨¡å¼ä¹¦ç±ï¼Œæœ‰ç‚¹åƒè€ƒé©¾é©¶è¯çš„ç§‘ä¸€ã€å®¶é‡Œè£…ä¿®æ—¶çš„æ‰‹å†Œã€æˆ–è€…å•èº«ç‹—çš„æ‹çˆ±å®å…¸ã€‚ä½†ï¼ä½ åªè¦ä¸å®æ“ï¼Œä¸€å®šèƒ½æçš„<strong>ä¹±<code>ç </code>ä¸ƒç³Ÿ</strong>ã€‚å› ä¸ºè¿™äº›æŒ‡å¯¼æ€æƒ³éƒ½æ˜¯ä»å®é™…ç»éªŒä¸­æç‚¼çš„ï¼Œæ²¡æœ‰ç»è¿‡æç‚¼çš„å°ç™½ï¼Œå¾ˆéš¾é©¾é©­è¿™æ ·çš„çŸ¥è¯†ã€‚æ‰€ä»¥åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­é¦–å…ˆè¦æœ‰æ¡ˆä¾‹ï¼Œä¹‹åå†ç»“åˆæ¡ˆä¾‹ä¸è‡ªå·±å®é™…çš„ä¸šåŠ¡ï¼Œå°è¯•é‡æ„æ”¹é€ ï¼Œæ…¢æ…¢ä½“ä¼šå…¶ä¸­çš„æ„Ÿå—ï¼Œä»è€Œä¹Ÿå°±å­¦ä¼šäº†å¦‚æœæ­å»ºå‡ºä¼˜ç§€çš„ä»£ç ã€‚</p><h2 id="äºŒã€å¼€å‘ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#äºŒã€å¼€å‘ç¯å¢ƒ" aria-hidden="true">#</a> äºŒã€å¼€å‘ç¯å¢ƒ</h2>',8),b=n("li",null,"JDK 1.8",-1),g=n("li",null,"Idea + Maven",-1),h=n("strong",null,"å…¬ä¼—å·",-1),y={href:"https://bugstack.cn/assets/images/qrcode.png",target:"_blank",rel:"noopener noreferrer"},f=n("code",null,"bugstackè™«æ´æ ˆ",-1),w=n("code",null,"æºç ä¸‹è½½",-1),_=t('<table><thead><tr><th>å·¥ç¨‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>itstack-demo-design-2-00</td><td>åœºæ™¯æ¨¡æ‹Ÿå·¥ç¨‹ï¼Œæ¨¡æ‹Ÿå‡ºä½¿ç”¨Rediså‡çº§ä¸ºé›†ç¾¤æ—¶ç±»æ”¹é€ </td></tr><tr><td>itstack-demo-design-2-01</td><td>ä½¿ç”¨ä¸€å¨ä»£ç å®ç°ä¸šåŠ¡éœ€æ±‚ï¼Œä¹Ÿæ˜¯å¯¹ifelseçš„ä½¿ç”¨</td></tr><tr><td>itstack-demo-design-2-02</td><td>é€šè¿‡è®¾è®¡æ¨¡å¼ä¼˜åŒ–æ”¹é€ ä»£ç ï¼Œäº§ç”Ÿå¯¹æ¯”æ€§ä»è€Œå­¦ä¹ </td></tr></tbody></table><h2 id="ä¸‰ã€æŠ½è±¡å·¥å‚æ¨¡å¼ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æŠ½è±¡å·¥å‚æ¨¡å¼ä»‹ç»" aria-hidden="true">#</a> ä¸‰ã€æŠ½è±¡å·¥å‚æ¨¡å¼ä»‹ç»</h2><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-01.png" alt="æŠ½è±¡å·¥å‚æ¨¡å¼ï¼Œå›¾ç‰‡æ¥è‡ª refactoringguru.cn"></p>',3),x={href:"https://refactoringguru.cn/design-patterns/abstract-factory",target:"_blank",rel:"noopener noreferrer"},I=t(`<p>æŠ½è±¡å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼è™½ç„¶ä¸»è¦æ„å›¾éƒ½æ˜¯ä¸ºäº†è§£å†³ï¼Œ<strong>æ¥å£é€‰æ‹©</strong>é—®é¢˜ã€‚ä½†åœ¨å®ç°ä¸Šï¼ŒæŠ½è±¡å·¥å‚æ˜¯ä¸€ä¸ªä¸­å¿ƒå·¥å‚ï¼Œåˆ›å»ºå…¶ä»–å·¥å‚çš„æ¨¡å¼ã€‚</p><p>å¯èƒ½åœ¨å¹³å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­å¾ˆå°‘å…³æ³¨è¿™æ ·çš„è®¾è®¡æ¨¡å¼æˆ–è€…ç±»ä¼¼çš„ä»£ç ç»“æ„ï¼Œä½†æ˜¯è¿™ç§åœºæ™¯ç¡®ä¸€ç›´åœ¨æˆ‘ä»¬èº«è¾¹ï¼Œä¾‹å¦‚ï¼›</p><ol><li><p>ä¸åŒç³»ç»Ÿå†…çš„å›è½¦æ¢è¡Œ</p><ol><li>Unixç³»ç»Ÿé‡Œï¼Œæ¯è¡Œç»“å°¾åªæœ‰ <strong>&lt;æ¢è¡Œ&gt;</strong>ï¼Œå³ <code>\\n</code>ï¼›</li><li>Windowsç³»ç»Ÿé‡Œé¢ï¼Œæ¯è¡Œç»“å°¾æ˜¯ <strong>&lt;æ¢è¡Œ&gt;&lt;å›è½¦&gt;</strong>ï¼Œå³ <code>\\n\\r</code>ï¼›</li><li>Macç³»ç»Ÿé‡Œï¼Œæ¯è¡Œç»“å°¾æ˜¯ <strong>&lt;å›è½¦&gt;</strong></li></ol></li><li><p>IDEA å¼€å‘å·¥å…·çš„å·®å¼‚å±•ç¤º(Win\\Mac)</p><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-02.png" alt="ä¸åŒç³»ç»Ÿä¸‹ï¼ŒIDEA å¼€å‘å·¥å…·çš„å±•ç¤ºå·®å¼‚ç‚¹"></p></li></ol><p>**é™¤äº†è¿™æ ·æ˜¾è€Œæ˜“è§çš„ä¾‹å­å¤–ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡å¼€å‘ä¸­æ—¶å¸¸ä¹Ÿä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œéœ€è¦å…¼å®¹åšå¤„ç†ã€‚**ä½†å¤§éƒ¨åˆ†ç»éªŒä¸è¶³çš„å¼€å‘äººå‘˜ï¼Œå¸¸å¸¸ç›´æ¥é€šè¿‡æ·»åŠ <code>ifelse</code>æ–¹å¼è¿›è¡Œå¤„ç†äº†ã€‚</p><h2 id="å››ã€æ¡ˆä¾‹åœºæ™¯æ¨¡æ‹Ÿ" tabindex="-1"><a class="header-anchor" href="#å››ã€æ¡ˆä¾‹åœºæ™¯æ¨¡æ‹Ÿ" aria-hidden="true">#</a> å››ã€æ¡ˆä¾‹åœºæ™¯æ¨¡æ‹Ÿ</h2><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-03.png" alt="æ¨¡æ‹Ÿä¼ä¸šçº§åŒå¥—Redisé›†ç¾¤å‡çº§"></p><p><code>å¾ˆå¤šæ—¶å€™åˆæœŸä¸šåŠ¡çš„è›®è’å‘å±•ï¼Œä¹Ÿä¼šç‰µåŠ¨ç€ç ”å‘å¯¹ç³»ç»Ÿçš„å»ºè®¾ã€‚</code></p><p>é¢„ä¼°<code>QPSè¾ƒä½</code>ã€<code>ç³»ç»Ÿå‹åŠ›è¾ƒå°</code>ã€<code>å¹¶å‘è®¿é—®ä¸å¤§</code>ã€<code>è¿‘ä¸€å¹´æ²¡æœ‰å¤§åŠ¨ä½œ</code>ç­‰ç­‰ï¼Œåœ¨è€ƒè™‘æ—¶é—´æŠ•å…¥æˆæœ¬çš„å‰æå‰ï¼Œå¹¶ä¸ä¼šæŠ•å…¥ç‰¹åˆ«å¤šçš„äººåŠ›å»æ„å»ºéå¸¸å®Œå–„çš„ç³»ç»Ÿã€‚å°±åƒå¯¹ <code>Redis</code> çš„ä½¿ç”¨ï¼Œå¾€å¾€å¯èƒ½åªè¦æ˜¯å•æœºçš„å°±å¯ä»¥æ»¡è¶³ç°çŠ¶ã€‚</p><p><code>ä¸å¹ç‰›çš„è®²ç™¾åº¦é¦–é¡µæˆ‘ä¸Šå­¦æ—¶å€™ä¸€å¤©å°±èƒ½å†™å®Œï¼Œç­‰æ¯•ä¸šå·¥ä½œäº†å°±ç®—ç»™æˆ‘ä¸€å¹´éƒ½å®Œæˆä¸äº†ï¼</code></p><p>ä½†éšç€ä¸šåŠ¡è¶…è¿‡é¢„æœŸçš„å¿«é€Ÿå‘å±•ï¼Œç³»ç»Ÿçš„è´Ÿè½½èƒ½åŠ›ä¹Ÿè¦éšç€è·Ÿä¸Šã€‚åŸæœ‰çš„å•æœº <code>Redis</code> å·²ç»æ»¡è¶³ä¸äº†ç³»ç»Ÿéœ€æ±‚ã€‚è¿™æ—¶å€™å°±éœ€è¦æ›´æ¢ä¸ºæ›´ä¸ºå¥å£®çš„Redisé›†ç¾¤æœåŠ¡ï¼Œè™½ç„¶éœ€è¦ä¿®æ”¹ä½†æ˜¯ä¸èƒ½å½±å“ç›®å‰ç³»ç»Ÿçš„è¿è¡Œï¼Œè¿˜è¦å¹³æ»‘è¿‡æ¸¡è¿‡å»ã€‚</p><p>éšç€è¿™æ¬¡çš„å‡çº§ï¼Œå¯ä»¥é¢„è§çš„é—®é¢˜ä¼šæœ‰ï¼›</p><ol><li>å¾ˆå¤šæœåŠ¡ç”¨åˆ°äº†Rediséœ€è¦ä¸€èµ·å‡çº§åˆ°é›†ç¾¤ã€‚</li><li>éœ€è¦å…¼å®¹é›†ç¾¤Aå’Œé›†ç¾¤Bï¼Œä¾¿äºåç»­çš„ç¾å¤‡ã€‚</li><li>ä¸¤å¥—é›†ç¾¤æä¾›çš„æ¥å£å’Œæ–¹æ³•å„æœ‰å·®å¼‚ï¼Œéœ€è¦åšé€‚é…ã€‚</li><li>ä¸èƒ½å½±å“åˆ°ç›®å‰æ­£å¸¸è¿è¡Œçš„ç³»ç»Ÿã€‚</li></ol><h3 id="_1-åœºæ™¯æ¨¡æ‹Ÿå·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_1-åœºæ™¯æ¨¡æ‹Ÿå·¥ç¨‹" aria-hidden="true">#</a> 1. åœºæ™¯æ¨¡æ‹Ÿå·¥ç¨‹</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>design<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">00</span>
â””â”€â”€ src
    â””â”€â”€ main
        â””â”€â”€ java
            â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design
                â”œâ”€â”€ matter
                â”‚   â”œâ”€â”€ <span class="token constant">EGM</span><span class="token punctuation">.</span>java
                â”‚   â””â”€â”€ <span class="token constant">IIR</span><span class="token punctuation">.</span>java
                â””â”€â”€ <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>å·¥ç¨‹ä¸­çš„æ‰€æœ‰ä»£ç å¯ä»¥é€šè¿‡å…³æ³¨å…¬ä¼—å·ï¼š<code>bugstackè™«æ´æ ˆ</code>ï¼Œå›å¤<code>æºç ä¸‹è½½</code>è¿›è¡Œè·å–ã€‚</em></p><h3 id="_2-åœºæ™¯ç®€è¿°" tabindex="-1"><a class="header-anchor" href="#_2-åœºæ™¯ç®€è¿°" aria-hidden="true">#</a> 2. åœºæ™¯ç®€è¿°</h3><h4 id="_2-1-æ¨¡æ‹Ÿå•æœºæœåŠ¡-redisutils" tabindex="-1"><a class="header-anchor" href="#_2-1-æ¨¡æ‹Ÿå•æœºæœåŠ¡-redisutils" aria-hidden="true">#</a> 2.1 æ¨¡æ‹Ÿå•æœºæœåŠ¡ RedisUtils</h4><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-04.png" alt="Rediså•æœºæœåŠ¡"></p><ul><li>æ¨¡æ‹ŸRedisåŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯å‡å®šç›®å‰æ‰€æœ‰çš„ç³»ç»Ÿéƒ½åœ¨ä½¿ç”¨çš„æœåŠ¡</li><li>ç±»å’Œæ–¹æ³•åæ¬¡éƒ½å›ºå®šå†™æ­»åˆ°å„ä¸ªä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œæ”¹åŠ¨ç•¥å¾®éº»çƒ¦</li></ul><h4 id="_2-2-æ¨¡æ‹Ÿé›†ç¾¤-egm" tabindex="-1"><a class="header-anchor" href="#_2-2-æ¨¡æ‹Ÿé›†ç¾¤-egm" aria-hidden="true">#</a> 2.2 æ¨¡æ‹Ÿé›†ç¾¤ EGM</h4><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-05.png" alt="æ¨¡æ‹Ÿé›†ç¾¤ EGM"></p><ul><li>æ¨¡æ‹Ÿä¸€ä¸ªé›†ç¾¤æœåŠ¡ï¼Œä½†æ˜¯æ–¹æ³•åä¸å„ä¸šåŠ¡ç³»ç»Ÿä¸­ä½¿ç”¨çš„æ–¹æ³•åä¸åŒã€‚æœ‰ç‚¹åƒä½ macï¼Œæˆ‘ç”¨winã€‚åšä¸€æ ·çš„äº‹ï¼Œä½†æœ‰ä¸åŒçš„æ“ä½œã€‚</li></ul><h4 id="_2-3-æ¨¡æ‹Ÿé›†ç¾¤-iir" tabindex="-1"><a class="header-anchor" href="#_2-3-æ¨¡æ‹Ÿé›†ç¾¤-iir" aria-hidden="true">#</a> 2.3 æ¨¡æ‹Ÿé›†ç¾¤ IIR</h4><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-06.png" alt="æ¨¡æ‹Ÿé›†ç¾¤ IIR"></p><ul><li>è¿™æ˜¯å¦å¤–ä¸€å¥—é›†ç¾¤æœåŠ¡ï¼Œæœ‰æ—¶å€™åœ¨ä¼ä¸šå¼€å‘ä¸­å°±å¾ˆæœ‰å¯èƒ½å‡ºç°ä¸¤å¥—æœåŠ¡ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿæ˜¯ä¸ºäº†åšæ¨¡æ‹Ÿæ¡ˆä¾‹ï¼Œæ‰€ä»¥æ·»åŠ ä¸¤å¥—å®ç°åŒæ ·åŠŸèƒ½çš„ä¸åŒæœåŠ¡ï¼Œæ¥å­¦ä¹ æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</li></ul><p>ç»¼ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç›®å‰çš„ç³»ç»Ÿä¸­å·²ç»åœ¨å¤§é‡çš„ä½¿ç”¨redisæœåŠ¡ï¼Œä½†æ˜¯å› ä¸ºç³»ç»Ÿä¸èƒ½æ»¡è¶³ä¸šåŠ¡çš„å¿«é€Ÿå‘å±•ï¼Œå› æ­¤éœ€è¦è¿ç§»åˆ°é›†ç¾¤æœåŠ¡ä¸­ã€‚è€Œè¿™æ—¶æœ‰ä¸¤å¥—é›†ç¾¤æœåŠ¡éœ€è¦å…¼å®¹ä½¿ç”¨ï¼Œåˆè¦æ»¡è¶³æ‰€æœ‰çš„ä¸šåŠ¡ç³»ç»Ÿæ”¹é€ çš„åŒæ—¶ä¸å½±å“çº¿ä¸Šä½¿ç”¨ã€‚</p><h3 id="_3-å•é›†ç¾¤ä»£ç ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_3-å•é›†ç¾¤ä»£ç ä½¿ç”¨" aria-hidden="true">#</a> 3. å•é›†ç¾¤ä»£ç ä½¿ç”¨</h3><p>ä»¥ä¸‹æ˜¯æ¡ˆä¾‹æ¨¡æ‹Ÿä¸­åŸæœ‰çš„å•é›†ç¾¤Redisä½¿ç”¨æ–¹å¼ï¼Œåç»­ä¼šé€šè¿‡å¯¹è¿™é‡Œçš„ä»£ç è¿›è¡Œæ”¹é€ ã€‚</p><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-07.png" alt="å½“å‰åŠŸèƒ½çš„ç±»å›¾ç»“æ„"></p><h3 id="_3-1-å®šä¹‰ä½¿ç”¨æ¥å£" tabindex="-1"><a class="header-anchor" href="#_3-1-å®šä¹‰ä½¿ç”¨æ¥å£" aria-hidden="true">#</a> 3.1 å®šä¹‰ä½¿ç”¨æ¥å£</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CacheService</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-å®ç°è°ƒç”¨ä»£ç " tabindex="-1"><a class="header-anchor" href="#_3-2-å®ç°è°ƒç”¨ä»£ç " aria-hidden="true">#</a> 3.2 å®ç°è°ƒç”¨ä»£ç </h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CacheServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">CacheService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">RedisUtils</span> redisUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisUtils<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisUtils<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç›®å‰çš„ä»£ç å¯¹äºå½“å‰åœºæ™¯ä¸‹çš„ä½¿ç”¨æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯æ‰€æœ‰çš„ä¸šåŠ¡ç³»ç»Ÿéƒ½åœ¨ä½¿ç”¨åŒæ—¶ï¼Œéœ€è¦æ”¹é€ å°±ä¸é‚£ä¹ˆå®¹æ˜“äº†ã€‚è¿™é‡Œå¯ä»¥æ€è€ƒä¸‹ï¼Œçœ‹å¦‚ä½•æ”¹é€ æ‰æ˜¯åˆç†çš„ã€‚</li></ul><h2 id="äº”ã€ç”¨ä¸€å¨å¨ä»£ç å®ç°" tabindex="-1"><a class="header-anchor" href="#äº”ã€ç”¨ä¸€å¨å¨ä»£ç å®ç°" aria-hidden="true">#</a> äº”ã€ç”¨ä¸€å¨å¨ä»£ç å®ç°</h2><p><code>è®²é“ç†æ²¡æœ‰ifelseè§£å†³ä¸äº†çš„é€»è¾‘ï¼Œä¸è¡Œå°±åœ¨åŠ ä¸€è¡Œï¼</code></p><p>æ­¤æ—¶çš„å®ç°æ–¹å¼å¹¶ä¸ä¼šä¿®æ”¹ç±»ç»“æ„å›¾ï¼Œä¹Ÿå°±æ˜¯ä¸ä¸Šé¢ç»™å‡ºçš„ç±»å±‚çº§å…³ç³»ä¸€è‡´ã€‚é€šè¿‡åœ¨æ¥å£ä¸­æ·»åŠ ç±»å‹å­—æ®µåŒºåˆ†å½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸ªé›†ç¾¤ï¼Œæ¥ä½œä¸ºä½¿ç”¨çš„åˆ¤æ–­ã€‚å¯ä»¥è¯´ç›®å‰çš„æ–¹å¼éå¸¸éš¾ç”¨ï¼Œå…¶ä»–ä½¿ç”¨æ–¹æ”¹åŠ¨é¢‡å¤šï¼Œè¿™é‡Œåªæ˜¯åšä¸ºä¾‹å­ã€‚</p><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>design<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">01</span>
â””â”€â”€ src
    â””â”€â”€ main
        â””â”€â”€ java
            â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design
                â”œâ”€â”€ impl
                â”‚   â””â”€â”€ <span class="token class-name">CacheServiceImpl</span><span class="token punctuation">.</span>java
                â””â”€â”€ <span class="token class-name">CacheService</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ­¤æ—¶çš„åªæœ‰ä¸¤ä¸ªç±»ï¼Œç±»ç»“æ„éå¸¸ç®€å•ã€‚è€Œæˆ‘ä»¬éœ€è¦çš„è¡¥å……æ‰©å±•åŠŸèƒ½ä¹Ÿåªæ˜¯åœ¨ <code>CacheServiceImpl</code> ä¸­å®ç°ã€‚</li></ul><h3 id="_2-ifelseå®ç°éœ€æ±‚" tabindex="-1"><a class="header-anchor" href="#_2-ifelseå®ç°éœ€æ±‚" aria-hidden="true">#</a> 2. ifelseå®ç°éœ€æ±‚</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CacheServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">CacheService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">RedisUtils</span> redisUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">EGM</span> egm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EGM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">IIR</span> iir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IIR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> egm<span class="token punctuation">.</span><span class="token function">gain</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">==</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> iir<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> redisUtils<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            egm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">==</span> redisType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            iir<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        redisUtils<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//... åŒç±»ä¸åšå¤ªå¤šå±•ç¤ºï¼Œå¯ä»¥ä¸‹è½½æºç è¿›è¡Œå‚è€ƒ</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™é‡Œçš„å®ç°è¿‡ç¨‹éå¸¸ç®€å•ï¼Œä¸»è¦æ ¹æ®ç±»å‹åˆ¤æ–­æ˜¯å“ªä¸ªRedisé›†ç¾¤ã€‚</li><li>è™½ç„¶å®ç°æ˜¯ç®€å•äº†ï¼Œä½†æ˜¯å¯¹ä½¿ç”¨è€…æ¥è¯´å°±éº»çƒ¦äº†ï¼Œå¹¶ä¸”ä¹Ÿå¾ˆéš¾åº”å¯¹åæœŸçš„æ‹“å±•å’Œä¸åœçš„ç»´æŠ¤ã€‚</li></ul><h3 id="_3-æµ‹è¯•éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_3-æµ‹è¯•éªŒè¯" aria-hidden="true">#</a> 3. æµ‹è¯•éªŒè¯</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡junitå•å…ƒæµ‹è¯•çš„æ–¹å¼éªŒè¯æ¥å£æœåŠ¡ï¼Œå¼ºè°ƒæ—¥å¸¸ç¼–å†™å¥½å•æµ‹å¯ä»¥æ›´å¥½çš„æé«˜ç³»ç»Ÿçš„å¥å£®åº¦ã€‚</p><p><strong>ç¼–å†™æµ‹è¯•ç±»ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_CacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CacheService</span> cacheService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CacheServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cacheService<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> val01 <span class="token operator">=</span> cacheService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>val01<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç»“æœï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">22</span><span class="token operator">:</span><span class="token number">26</span><span class="token operator">:</span><span class="token number">24.591</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">EGM</span> <span class="token operator">-</span> <span class="token constant">EGM</span>å†™å…¥æ•°æ® keyï¼šuser_name_01 valï¼šå°å‚…å“¥
<span class="token number">22</span><span class="token operator">:</span><span class="token number">26</span><span class="token operator">:</span><span class="token number">24.593</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">EGM</span> <span class="token operator">-</span> <span class="token constant">EGM</span>è·å–æ•°æ® keyï¼šuser_name_01
æµ‹è¯•ç»“æœï¼šå°å‚…å“¥

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä»ç»“æœä¸Šçœ‹è¿è¡Œæ­£å¸¸ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ä½†è¿™æ ·çš„ä»£ç åªè¦åˆ°ç”Ÿæˆè¿è¡Œèµ·æ¥ä»¥åï¼Œæƒ³å†æ”¹å°±çœŸçš„éš¾äº†ï¼</li></ul><h2 id="å…­ã€æŠ½è±¡å·¥å‚æ¨¡å¼é‡æ„ä»£ç " tabindex="-1"><a class="header-anchor" href="#å…­ã€æŠ½è±¡å·¥å‚æ¨¡å¼é‡æ„ä»£ç " aria-hidden="true">#</a> å…­ã€æŠ½è±¡å·¥å‚æ¨¡å¼é‡æ„ä»£ç </h2><p><code>æ¥ä¸‹æ¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼æ¥è¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œä¹Ÿç®—æ˜¯ä¸€æ¬¡å¾ˆå°çš„é‡æ„ã€‚</code></p><p>è¿™é‡Œçš„æŠ½è±¡å·¥å‚çš„åˆ›å»ºå’Œè·å–æ–¹å¼ï¼Œä¼šé‡‡ç”¨ä»£ç†ç±»çš„æ–¹å¼è¿›è¡Œå®ç°ã€‚æ‰€è¢«ä»£ç†çš„ç±»å°±æ˜¯ç›®å‰çš„Redisæ“ä½œæ–¹æ³•ç±»ï¼Œè®©è¿™ä¸ªç±»åœ¨ä¸éœ€è¦ä»»ä½•ä¿®æ”¹ä¸‹ï¼Œå°±å¯ä»¥å®ç°è°ƒç”¨é›†ç¾¤Aå’Œé›†ç¾¤Bçš„æ•°æ®æœåŠ¡ã€‚</p><p>å¹¶ä¸”è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹éå¸¸é‡è¦ï¼Œç”±äºé›†ç¾¤Aå’Œé›†ç¾¤Båœ¨éƒ¨åˆ†æ–¹æ³•æä¾›ä¸Šæ˜¯ä¸åŒçš„ï¼Œå› æ­¤éœ€è¦åšä¸€ä¸ªæ¥å£é€‚é…ï¼Œè€Œè¿™ä¸ªé€‚é…ç±»å°±ç›¸å½“äºå·¥å‚ä¸­çš„å·¥å‚ï¼Œç”¨äºåˆ›å»ºæŠŠä¸åŒçš„æœåŠ¡æŠ½è±¡ä¸ºç»Ÿä¸€çš„æ¥å£åšç›¸åŒçš„ä¸šåŠ¡ã€‚è¿™ä¸€å—ä¸æˆ‘ä»¬ä¸Šä¸€ç« èŠ‚ä¸­çš„<code>å·¥å‚æ–¹æ³•æ¨¡å‹</code>ç±»å‹ï¼Œå¯ä»¥ç¿»é˜…å‚è€ƒã€‚</p><h3 id="_1-å·¥ç¨‹ç»“æ„-1" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„-1" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>design<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">02</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design
    â”‚           â”œâ”€â”€ factory    
    â”‚           â”‚   â”œâ”€â”€ impl
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">EGMCacheAdapter</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">IIRCacheAdapter</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">ICacheAdapter</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">JDKInvocationHandler</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">JDKProxy</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ impl
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">CacheServiceImpl</span><span class="token punctuation">.</span>java    
    â”‚           â””â”€â”€ <span class="token class-name">CacheService</span><span class="token punctuation">.</span>java 
    â””â”€â”€ test
         â””â”€â”€ java
             â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>test
                 â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æŠ½è±¡å·¥å‚æ¨¡å‹ç»“æ„</strong></p><p><img src="https://bugstack.cn/assets/images/2020/itstack-demo-design-2-08.png" alt="æŠ½è±¡å·¥å‚æ¨¡å‹ç»“æ„"></p><ul><li>å·¥ç¨‹ä¸­æ¶‰åŠçš„éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ä»£ç ï¼Œå¦‚ä¸‹ï¼› <ul><li><code>ICacheAdapter</code>ï¼Œå®šä¹‰äº†é€‚é…æ¥å£ï¼Œåˆ†åˆ«åŒ…è£…ä¸¤ä¸ªé›†ç¾¤ä¸­å·®å¼‚åŒ–çš„æ¥å£åç§°ã€‚<code>EGMCacheAdapter</code>ã€<code>IIRCacheAdapter</code></li><li><code>JDKProxy</code>ã€<code>JDKInvocationHandler</code>ï¼Œæ˜¯ä»£ç†ç±»çš„å®šä¹‰å’Œå®ç°ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå°±æ˜¯æŠ½è±¡å·¥å‚çš„å¦å¤–ä¸€ç§å®ç°æ–¹å¼ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼å¯ä»¥å¾ˆå¥½çš„æŠŠåŸæœ‰æ“ä½œRedisçš„æ–¹æ³•è¿›è¡Œä»£ç†æ“ä½œï¼Œé€šè¿‡æ§åˆ¶ä¸åŒçš„å…¥å‚å¯¹è±¡ï¼Œæ§åˆ¶ç¼“å­˜çš„ä½¿ç”¨ã€‚</li></ul></li></ul><p><strong>å¥½</strong>ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¼šåˆ†åˆ«è®²è§£å‡ ä¸ªç±»çš„å…·ä½“å®ç°ã€‚</p><h3 id="_2-ä»£ç å®ç°" tabindex="-1"><a class="header-anchor" href="#_2-ä»£ç å®ç°" aria-hidden="true">#</a> 2. ä»£ç å®ç°</h3><h4 id="_2-1-å®šä¹‰é€‚é…æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2-1-å®šä¹‰é€‚é…æ¥å£" aria-hidden="true">#</a> 2.1 å®šä¹‰é€‚é…æ¥å£</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ICacheAdapter</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸ªç±»çš„ä¸»è¦ä½œç”¨æ˜¯è®©æ‰€æœ‰é›†ç¾¤çš„æä¾›æ–¹ï¼Œèƒ½åœ¨ç»Ÿä¸€çš„æ–¹æ³•åç§°ä¸‹è¿›è¡Œæ“ä½œã€‚ä¹Ÿæ–¹é¢åç»­çš„æ‹“å±•ã€‚</li></ul><h4 id="_2-2-å®ç°é›†ç¾¤ä½¿ç”¨æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-2-å®ç°é›†ç¾¤ä½¿ç”¨æœåŠ¡" aria-hidden="true">#</a> 2.2 å®ç°é›†ç¾¤ä½¿ç”¨æœåŠ¡</h4><p><strong>EGMCacheAdapter</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EGMCacheAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">ICacheAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">EGM</span> egm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EGM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> egm<span class="token punctuation">.</span><span class="token function">gain</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        egm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        egm<span class="token punctuation">.</span><span class="token function">setEx</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        egm<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>IIRCacheAdapter</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IIRCacheAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">ICacheAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">IIR</span> iir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IIR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> iir<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iir<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iir<span class="token punctuation">.</span><span class="token function">setExpire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iir<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä»¥ä¸Šä¸¤ä¸ªå®ç°éƒ½éå¸¸å®¹æ˜“ï¼Œåœ¨ç»Ÿä¸€æ–¹æ³•åä¸‹è¿›è¡ŒåŒ…è£…ã€‚</li></ul><h4 id="_2-3-å®šä¹‰æŠ½è±¡å·¥ç¨‹ä»£ç†ç±»å’Œå®ç°" tabindex="-1"><a class="header-anchor" href="#_2-3-å®šä¹‰æŠ½è±¡å·¥ç¨‹ä»£ç†ç±»å’Œå®ç°" aria-hidden="true">#</a> 2.3 å®šä¹‰æŠ½è±¡å·¥ç¨‹ä»£ç†ç±»å’Œå®ç°</h4><p><strong>JDKProxy</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> interfaceClass<span class="token punctuation">,</span> <span class="token class-name">ICacheAdapter</span> cacheAdapter<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">InvocationHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JDKInvocationHandler</span><span class="token punctuation">(</span>cacheAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> classes <span class="token operator">=</span> interfaceClass<span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>classes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™é‡Œä¸»è¦çš„ä½œç”¨å°±æ˜¯å®Œæˆä»£ç†ç±»ï¼ŒåŒæ—¶å¯¹äºä½¿ç”¨å“ªä¸ªé›†ç¾¤æœ‰å¤–éƒ¨é€šè¿‡å…¥å‚è¿›è¡Œä¼ é€’ã€‚</li></ul><p><strong>JDKInvocationHandler</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDKInvocationHandler</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ICacheAdapter</span> cacheAdapter<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">JDKInvocationHandler</span><span class="token punctuation">(</span><span class="token class-name">ICacheAdapter</span> cacheAdapter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cacheAdapter <span class="token operator">=</span> cacheAdapter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ICacheAdapter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ClassLoaderUtils</span><span class="token punctuation">.</span><span class="token function">getClazzByArgs</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>cacheAdapter<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ä»£ç†ç±»çš„å®ç°ä¸­å…¶å®ä¹Ÿéå¸¸ç®€å•ï¼Œé€šè¿‡ç©¿é€è¿›æ¥çš„é›†ç¾¤æœåŠ¡è¿›è¡Œæ–¹æ³•æ“ä½œã€‚</li><li>å¦å¤–åœ¨<code>invoke</code>ä¸­é€šè¿‡ä½¿ç”¨è·å–æ–¹æ³•åç§°åå°„æ–¹å¼ï¼Œè°ƒç”¨å¯¹åº”çš„æ–¹æ³•åŠŸèƒ½ï¼Œä¹Ÿå°±ç®€åŒ–äº†æ•´ä½“çš„ä½¿ç”¨ã€‚</li><li>åˆ°è¿™æˆ‘ä»¬å°±å·²ç»å°†æ•´ä½“çš„åŠŸèƒ½å®ç°å®Œæˆäº†ï¼Œå…³äºæŠ½è±¡å·¥å‚è¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥ä½¿ç”¨éä»£ç†çš„æ–¹å¼è¿›è¡Œå®ç°ã€‚</li></ul><h3 id="_3-æµ‹è¯•éªŒè¯-1" tabindex="-1"><a class="header-anchor" href="#_3-æµ‹è¯•éªŒè¯-1" aria-hidden="true">#</a> 3. æµ‹è¯•éªŒè¯</h3><p><strong>ç¼–å†™æµ‹è¯•ç±»ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_CacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">CacheService</span> proxy_EGM <span class="token operator">=</span> <span class="token class-name">JDKProxy</span><span class="token punctuation">.</span><span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">CacheServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">EGMCacheAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    proxy_EGM<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> val01 <span class="token operator">=</span> proxy_EGM<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>val01<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">CacheService</span> proxy_IIR <span class="token operator">=</span> <span class="token class-name">JDKProxy</span><span class="token punctuation">.</span><span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">CacheServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IIRCacheAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    proxy_IIR<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> val02 <span class="token operator">=</span> proxy_IIR<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user_name_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>val02<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨æµ‹è¯•çš„ä»£ç ä¸­é€šè¿‡ä¼ å…¥ä¸åŒçš„é›†ç¾¤ç±»å‹ï¼Œå°±å¯ä»¥è°ƒç”¨ä¸åŒçš„é›†ç¾¤ä¸‹çš„æ–¹æ³•ã€‚<code>JDKProxy.getProxy(CacheServiceImpl.class, new EGMCacheAdapter());</code></li><li>å¦‚æœåç»­æœ‰æ‰©å±•çš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§è¿™æ ·çš„ç±»å‹æ–¹å¼è¿›è¡Œè¡¥å……ï¼ŒåŒæ—¶å¯¹äºæ”¹é€ ä¸Šæ¥è¯´å¹¶æ²¡æœ‰æ”¹åŠ¨åŸæ¥çš„æ–¹æ³•ï¼Œé™ä½äº†ä¿®æ”¹æˆæœ¬ã€‚</li></ul><p><strong>ç»“æœï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">23</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">06.953</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">EGM</span> <span class="token operator">-</span> <span class="token constant">EGM</span>å†™å…¥æ•°æ® keyï¼šuser_name_01 valï¼šå°å‚…å“¥
<span class="token number">23</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">06.956</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">EGM</span> <span class="token operator">-</span> <span class="token constant">EGM</span>è·å–æ•°æ® keyï¼šuser_name_01
æµ‹è¯•ç»“æœï¼šå°å‚…å“¥
<span class="token number">23</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">06.957</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">IIR</span> <span class="token operator">-</span> <span class="token constant">IIR</span>å†™å…¥æ•°æ® keyï¼šuser_name_01 valï¼šå°å‚…å“¥
<span class="token number">23</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">06.957</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>design<span class="token punctuation">.</span>matter<span class="token punctuation">.</span><span class="token constant">IIR</span> <span class="token operator">-</span> <span class="token constant">IIR</span>è·å–æ•°æ® keyï¼šuser_name_01
æµ‹è¯•ç»“æœï¼šå°å‚…å“¥

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿è¡Œç»“æœæ­£å¸¸ï¼Œè¿™æ ·çš„ä»£ç æ»¡è¶³äº†è¿™æ¬¡æ‹“å±•çš„éœ€æ±‚ï¼ŒåŒæ—¶ä½ çš„æŠ€æœ¯èƒ½åŠ›ä¹Ÿç»™è€æ¿ç•™ä¸‹äº†æ·±åˆ»çš„å°è±¡ã€‚</li><li>ç ”å‘è‡ªæˆ‘èƒ½åŠ›çš„æå‡è¿œä¸æ˜¯å¤–æ¥çš„å‹åŠ›å°±æ˜¯ç¼–å†™ä¸€å¨å¨ä»£ç çš„æ¥å£ï¼Œå¦‚æœä½ å·²ç»ç†Ÿç»ƒäº†å¾ˆå¤šæŠ€èƒ½ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å³ä½¿ç´§æ€¥çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½åšå‡ºå®Œå–„çš„æ–¹æ¡ˆã€‚</li></ul><h2 id="ä¸ƒã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€æ€»ç»“" aria-hidden="true">#</a> ä¸ƒã€æ€»ç»“</h2><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼Œæ‰€è¦è§£å†³çš„é—®é¢˜å°±æ˜¯åœ¨ä¸€ä¸ªäº§å“æ—ï¼Œå­˜åœ¨å¤šä¸ªä¸åŒç±»å‹çš„äº§å“(Redisé›†ç¾¤ã€æ“ä½œç³»ç»Ÿ)æƒ…å†µä¸‹ï¼Œæ¥å£é€‰æ‹©çš„é—®é¢˜ã€‚è€Œè¿™ç§åœºæ™¯åœ¨ä¸šåŠ¡å¼€å‘ä¸­ä¹Ÿæ˜¯éå¸¸å¤šè§çš„ï¼Œåªä¸è¿‡å¯èƒ½æœ‰æ—¶å€™æ²¡æœ‰å°†å®ƒä»¬æŠ½è±¡åŒ–å‡ºæ¥ã€‚</li><li><code>ä½ çš„ä»£ç åªæ˜¯è¢«ifelseåŸ‹ä¸Šäº†ï¼</code>å½“ä½ çŸ¥é“ä»€ä¹ˆåœºæ™¯ä¸‹ä½•æ—¶å¯ä»¥è¢«æŠ½è±¡å·¥ç¨‹ä¼˜åŒ–ä»£ç ï¼Œé‚£ä¹ˆä½ çš„ä»£ç å±‚çº§ç»“æ„ä»¥åŠæ»¡è¶³ä¸šåŠ¡éœ€æ±‚ä¸Šï¼Œéƒ½å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„å®ŒæˆåŠŸèƒ½å®ç°å¹¶æå‡æ‰©å±•æ€§å’Œä¼˜é›…åº¦ã€‚</li><li>é‚£ä¹ˆè¿™ä¸ªè®¾è®¡æ¨¡å¼æ»¡è¶³äº†ï¼›å•ä¸€èŒè´£ã€å¼€é—­åŸåˆ™ã€è§£è€¦ç­‰ä¼˜ç‚¹ï¼Œä½†å¦‚æœè¯´éšç€ä¸šåŠ¡çš„ä¸æ–­æ‹“å±•ï¼Œå¯èƒ½ä¼šé€ æˆç±»å®ç°ä¸Šçš„å¤æ‚åº¦ã€‚ä½†ä¹Ÿå¯ä»¥è¯´ç®—ä¸ä¸Šç¼ºç‚¹ï¼Œå› ä¸ºå¯ä»¥éšç€å…¶ä»–è®¾è®¡æ–¹å¼çš„å¼•å…¥å’Œä»£ç†ç±»ä»¥åŠè‡ªåŠ¨ç”ŸæˆåŠ è½½çš„æ–¹å¼é™ä½æ­¤é¡¹ç¼ºç‚¹ã€‚</li></ul>`,86);function j(S,C){const a=c("ExternalLinkIcon");return o(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),d,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),e(a)])]),r,v,m,n("ol",null,[b,g,n("li",null,[s("æ¶‰åŠå·¥ç¨‹ä¸‰ä¸ªï¼Œå¯ä»¥é€šè¿‡å…³æ³¨"),h,s("ï¼š"),n("a",y,[f,e(a)]),s("ï¼Œå›å¤"),w,s("è·å–")])]),_,n("ul",null,[n("li",null,[s("å›¾ç‰‡æ¥è‡ªï¼š"),n("a",x,[s("https://refactoringguru.cn/design-patterns/abstract-factory"),e(a)])])]),I])}const A=p(i,[["render",j],["__file","2020-05-24-zhongxueJavashejimoshiã€Šchouxianggongchangmoshiã€‹.html.vue"]]);export{A as default};
