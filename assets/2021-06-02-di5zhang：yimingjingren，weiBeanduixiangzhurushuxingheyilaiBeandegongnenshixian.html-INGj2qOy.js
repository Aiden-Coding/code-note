import{_ as p,r as o,o as c,c as l,a as n,b as s,d as e,e as t}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"ã€Šspring-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬-5-ç« -ä¸€é¸£æƒŠäºº-ä¸ºbeanå¯¹è±¡æ³¨å…¥å±æ€§å’Œä¾èµ–beançš„åŠŸèƒ½å®ç°",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ã€Šspring-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬-5-ç« -ä¸€é¸£æƒŠäºº-ä¸ºbeanå¯¹è±¡æ³¨å…¥å±æ€§å’Œä¾èµ–beançš„åŠŸèƒ½å®ç°","aria-hidden":"true"},"#"),s(" ã€ŠSpring æ‰‹æ’¸ä¸“æ ã€‹ç¬¬ 5 ç« ï¼šä¸€é¸£æƒŠäººï¼Œä¸ºBeanå¯¹è±¡æ³¨å…¥å±æ€§å’Œä¾èµ–Beançš„åŠŸèƒ½å®ç°")],-1),r=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("br",null,null,-1),v={href:"https://mp.weixin.qq.com/s/EKoMDpa4q8TMikRM2wBIzw",target:"_blank",rel:"noopener noreferrer"},m=t('<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><h2 id="ä¸€ã€å‰è¨€" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€å‰è¨€" aria-hidden="true">#</a> ä¸€ã€å‰è¨€</h2><p><code>è¶…å–ã€æ‰å•ã€å¹‚ç­‰ï¼Œä½ çš„ç¨‹åºæ€»æ˜¯ä¸æŠ—æï¼</code></p><p>æƒ³æƒ³ï¼Œè¿è¥å·²ç»å¯¹å¤–å®£ä¼ äº†ä¸ƒå…«å¤©çš„æ´»åŠ¨ï¼Œæ»¡å¿ƒæ¬¢å–œçš„ç­‰ç€æœ€åä¸€å¤©é¡µé¢ä¸Šçº¿å¯¹å¤–äº†ï¼Œçªç„¶å‡ºç°äº†ä¸€å †å¼‚å¸¸ã€èµ„æŸã€é—ªé€€ï¼Œè€Œç”¨æˆ·æµé‡ç¨çºµå³é€ï¼Œæœ€åæƒ³æ­»çš„å¿ƒéƒ½æœ‰ï¼</p><p>å°±ç¼–ç¨‹å¼€å‘æ¥è®²ï¼Œä¸¢ä¸‰è½å››ã€ä¹±ç ä¸ƒç³Ÿï¼Œå¯èƒ½è¿™å°±æ˜¯å¤§éƒ¨åˆ†åˆçº§ç¨‹åºå‘˜æ—¥å¸¸å¼€å‘çš„çœŸå®å†™ç…§ï¼Œåœ¨å³ä½¿æœ‰æµ‹è¯•äººå‘˜éªŒè¯çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šå‡ºç°å¸¦Bugä¸Šçº¿çš„ç°è±¡ï¼Œåªä¸è¿‡æ˜¯å½“æ—¶æ²¡æœ‰å‘ç°è€Œå·²ï¼<em>å› ä¸ºæ˜¯äººå†™ä»£ç ï¼Œå°±ä¸€å®šä¼šæœ‰é”™è¯¯ï¼Œå³ä½¿æ˜¯è€ç å†œ</em></p><p>å°±ç¨‹åºBugæ¥è®²ï¼Œä¼šåŒ…æ‹¬äº§å“PRDæµç¨‹ä¸Šçš„Bugã€è¿è¥é…ç½®æ´»åŠ¨æ—¶å€™çš„Bugã€ç ”å‘å¼€å‘æ—¶åŠŸèƒ½å®ç°çš„Bugã€æµ‹è¯•éªŒè¯æ—¶æ¼æ‰æµç¨‹çš„Bugã€ä¸Šçº¿è¿‡ç¨‹ä¸­è¿ç»´æœåŠ¡ç›¸å…³é…ç½®çš„Bugï¼Œè€Œè¿™äº›å…¶å®éƒ½å¯ä»¥é€šè¿‡åˆ¶å®šçš„æµç¨‹è§„èŒƒå’Œä¸€å®šçš„ç ”å‘ç»éªŒç§¯ç´¯ï¼Œæ…¢æ…¢å°½å¯èƒ½å‡å°‘ã€‚</p><p>è€Œå¦å¤–ä¸€ç±»æ˜¯æ²Ÿé€šç•™ä¸‹çš„Bugï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸šåŠ¡æéœ€æ±‚ã€äº§å“å®šæ–¹æ¡ˆã€ç ”å‘åšå®ç°ï¼Œæœ€ç»ˆè¿˜è¦æœ‰UIã€æµ‹è¯•ã€è¿è¥ã€æ¶æ„ç­‰ç­‰å„ä¸ªç¯èŠ‚çš„äººå‘˜å‚ä¸åˆ°ä¸€ä¸ªé¡¹ç›®çš„æ‰¿æ¥ã€å¼€å‘åˆ°ä¸Šçº¿è¿è¡Œï¼Œè€Œåœ¨è¿™ä¸€ç¾¤äººéœ€è¦ä¿æŒä¸€ä¸ªç»Ÿä¸€çš„ä¿¡æ¯ä¼ æ’­å…¶å®æ˜¯å¾ˆéš¾çš„ã€‚æ¯”å¦‚åœ¨é¡¹ç›®å¼€å‘ä¸­æœŸï¼Œè¿è¥ç»™äº§å“è¯´äº†ä¸€ä¸ªæ–°å¢çš„éœ€æ±‚ï¼Œäº§å“è§‰å¾—åŠŸèƒ½ä¹Ÿä¸å¤§ï¼Œéšå³æ‰¾åˆ°å¯¹åº”çš„å‰ç«¯ç ”å‘åŠ ä¸ªé€»è¾‘ï¼Œä½†æ²¡æƒ³åˆ°å¯èƒ½ä¹Ÿå½±å“åˆ°äº†åç«¯çš„å¼€å‘å’Œæµ‹è¯•çš„ç”¨ä¾‹ã€‚æœ€ååŠŸèƒ½è™½ç„¶æ˜¯ä¸Šçº¿äº†ï¼Œå¯å¹¶ä¸åœ¨æ•´ä¸ªäº§ç ”æµ‹çš„éœ€æ±‚è¦†ç›–åº¦èŒƒå›´é‡Œï¼Œä¹Ÿå°±éšå½¢çš„åŸ‹ä¸‹äº†ä¸€ä¸ªå‘ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è®©ä½ çš„ç¨‹åºå¾ˆæŠ—æï¼Œæ¥çš„ä½å†œå¤«ä¸‰æ‹³ï¼Œé‚£ä¹ˆä½ è¦åšçš„å°±ä¸åªæ˜¯ä¸€ä¸ªå•çº¯çš„æ¬ç –ç å†œï¼</p><h2 id="äºŒã€ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç›®æ ‡" aria-hidden="true">#</a> äºŒã€ç›®æ ‡</h2>',9),b={href:"https://bugstack.cn/spring/2021/05/20/%E7%AC%AC2%E7%AB%A0-%E5%B0%8F%E8%AF%95%E7%89%9B%E5%88%80-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84Bean%E5%AE%B9%E5%99%A8.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://bugstack.cn/spring/2021/05/23/%E7%AC%AC3%E7%AB%A0-%E5%88%9D%E6%98%BE%E8%BA%AB%E6%89%8B-%E8%BF%90%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%AE%9E%E7%8E%B0-Bean-%E7%9A%84%E5%AE%9A%E4%B9%89-%E6%B3%A8%E5%86%8C-%E8%8E%B7%E5%8F%96.html",target:"_blank",rel:"noopener noreferrer"},y={href:"https://bugstack.cn/spring/2021/05/23/%E7%AC%AC3%E7%AB%A0-%E5%88%9D%E6%98%BE%E8%BA%AB%E6%89%8B-%E8%BF%90%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%AE%9E%E7%8E%B0-Bean-%E7%9A%84%E5%AE%9A%E4%B9%89-%E6%B3%A8%E5%86%8C-%E8%8E%B7%E5%8F%96.html",target:"_blank",rel:"noopener noreferrer"},h={href:"https://bugstack.cn/spring/2021/05/30/%E7%AC%AC4%E7%AB%A0-%E5%B4%AD%E9%9C%B2%E5%A4%B4%E8%A7%92-%E5%9F%BA%E4%BA%8ECglib%E5%AE%9E%E7%8E%B0%E5%90%AB%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E7%B1%BB%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%AD%96%E7%95%A5.html",target:"_blank",rel:"noopener noreferrer"},f=n("code",null,"ç±»ä¸­æ˜¯å¦æœ‰å±æ€§çš„é—®é¢˜",-1),B=t(`<p>å¯¹äºå±æ€§çš„å¡«å……ä¸åªæ˜¯ intã€Longã€Stringï¼Œè¿˜åŒ…æ‹¬è¿˜æ²¡æœ‰å®ä¾‹åŒ–çš„å¯¹è±¡å±æ€§ï¼Œéƒ½éœ€è¦åœ¨ Bean åˆ›å»ºæ—¶è¿›è¡Œå¡«å……æ“ä½œã€‚<em>ä¸è¿‡è¿™é‡Œæˆ‘ä»¬æš‚æ—¶ä¸ä¼šè€ƒè™‘ Bean çš„å¾ªç¯ä¾èµ–ï¼Œå¦åˆ™ä¼šæŠŠæ•´ä¸ªåŠŸèƒ½å®ç°æ’‘å¤§ï¼Œè¿™æ ·æ–°äººå­¦ä¹ æ—¶å°±æŠŠæ¡ä¸ä½äº†ï¼Œå¾…åç»­é™†ç»­å…ˆæŠŠæ ¸å¿ƒåŠŸèƒ½å®ç°åï¼Œå†é€æ­¥å®Œå–„</em></p><h2 id="ä¸‰ã€è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€è®¾è®¡" aria-hidden="true">#</a> ä¸‰ã€è®¾è®¡</h2><p>é‰´äºå±æ€§å¡«å……æ˜¯åœ¨ Bean ä½¿ç”¨ <code>newInstance</code> æˆ–è€… <code>Cglib</code> åˆ›å»ºåï¼Œå¼€å§‹è¡¥å…¨å±æ€§ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨ç±» <code>AbstractAutowireCapableBeanFactory</code> çš„ createBean æ–¹æ³•ä¸­æ·»åŠ è¡¥å…¨å±æ€§æ–¹æ³•ã€‚<em>è¿™éƒ¨åˆ†å¤§å®¶åœ¨å®ä¹ çš„è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥å¯¹ç…§Springæºç å­¦ä¹ ï¼Œè¿™é‡Œçš„å®ç°ä¹Ÿæ˜¯Springçš„ç®€åŒ–ç‰ˆï¼Œåç»­å¯¹ç…§å­¦ä¹ ä¼šæ›´åŠ æ˜“äºç†è§£</em></p><p><img src="https://bugstack.cn/assets/images/spring/spring-5-01.png" alt=""></p><ul><li>å±æ€§å¡«å……è¦åœ¨ç±»å®ä¾‹åŒ–åˆ›å»ºä¹‹åï¼Œä¹Ÿå°±æ˜¯éœ€è¦åœ¨ <code>AbstractAutowireCapableBeanFactory</code> çš„ createBean æ–¹æ³•ä¸­æ·»åŠ  <code>applyPropertyValues</code> æ“ä½œã€‚</li><li>ç”±äºæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºBeanæ—¶å€™å¡«å……å±æ€§æ“ä½œï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ bean å®šä¹‰ BeanDefinition ç±»ä¸­ï¼Œæ·»åŠ  PropertyValues ä¿¡æ¯ã€‚</li><li>å¦å¤–æ˜¯å¡«å……å±æ€§ä¿¡æ¯è¿˜åŒ…æ‹¬äº† Bean çš„å¯¹è±¡ç±»å‹ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å†å®šä¹‰ä¸€ä¸ª BeanReferenceï¼Œé‡Œé¢å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„ Bean åç§°ï¼Œåœ¨å…·ä½“çš„å®ä¾‹åŒ–æ“ä½œæ—¶è¿›è¡Œé€’å½’åˆ›å»ºå’Œå¡«å……ï¼Œä¸ Spring æºç å®ç°ä¸€æ ·ã€‚<em>Spring æºç ä¸­ BeanReference æ˜¯ä¸€ä¸ªæ¥å£</em></li></ul><h2 id="å››ã€å®ç°" tabindex="-1"><a class="header-anchor" href="#å››ã€å®ç°" aria-hidden="true">#</a> å››ã€å®ç°</h2><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>small<span class="token operator">-</span>spring<span class="token operator">-</span>step<span class="token operator">-</span><span class="token number">04</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans
    â”‚           â”œâ”€â”€ factory
    â”‚           â”‚   â”œâ”€â”€ config
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanDefinition</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanReference</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">SingletonBeanRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ support
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AbstractAutowireCapableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AbstractBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanDefinitionRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">CglibSubclassingInstantiationStrategy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultSingletonBeanRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">InstantiationStrategy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">SimpleInstantiationStrategy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">BeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ <span class="token class-name">BeansException</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ <span class="token class-name">PropertyValue</span><span class="token punctuation">.</span>java
    â”‚           â””â”€â”€ <span class="token class-name">PropertyValues</span><span class="token punctuation">.</span>java
    â””â”€â”€ test
        â””â”€â”€ java
            â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test
                â”œâ”€â”€ bean
                â”‚   â”œâ”€â”€ <span class="token class-name">UserDao</span><span class="token punctuation">.</span>java
                â”‚   â””â”€â”€ <span class="token class-name">UserService</span><span class="token punctuation">.</span>java
                â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å·¥ç¨‹æºç </strong>ï¼š<code>å…¬ä¼—å·ã€Œbugstackè™«æ´æ ˆã€ï¼Œå›å¤ï¼šSpring ä¸“æ ï¼Œè·å–å®Œæ•´æºç </code></p><p>Spring Bean å®¹å™¨ç±»å…³ç³»ï¼Œå¦‚å›¾ 5-2</p><p><img src="https://bugstack.cn/assets/images/spring/spring-5-02.png" alt="å›¾ 5-2"></p><ul><li>æœ¬ç« èŠ‚ä¸­éœ€è¦æ–°å¢åŠ 3ä¸ªç±»ï¼Œ<code>BeanReference</code>(ç±»å¼•ç”¨)ã€<code>PropertyValue</code>(å±æ€§å€¼)ã€<code>PropertyValues</code>(å±æ€§é›†åˆ)ï¼Œåˆ†åˆ«ç”¨äºç±»å’Œå…¶ä»–ç±»å‹å±æ€§å¡«å……æ“ä½œã€‚</li><li>å¦å¤–æ”¹åŠ¨çš„ç±»ä¸»è¦æ˜¯ <code>AbstractAutowireCapableBeanFactory</code>ï¼Œåœ¨ createBean ä¸­è¡¥å…¨å±æ€§å¡«å……éƒ¨åˆ†ã€‚</li></ul><h3 id="_2-å®šä¹‰å±æ€§" tabindex="-1"><a class="header-anchor" href="#_2-å®šä¹‰å±æ€§" aria-hidden="true">#</a> 2. å®šä¹‰å±æ€§</h3><p><strong>cn.bugstack.springframework.beans.PropertyValue</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertyValue</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> value<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// ...get/set</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>cn.bugstack.springframework.beans.PropertyValues</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertyValues</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PropertyValue</span><span class="token punctuation">&gt;</span></span> propertyValueList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">PropertyValue</span> pv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>propertyValueList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>propertyValueList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">PropertyValue</span> <span class="token function">getPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertyValue</span> pv <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>propertyValueList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pv<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> pv<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸¤ä¸ªç±»çš„ä½œç”¨å°±æ˜¯åˆ›å»ºå‡ºä¸€ä¸ªç”¨äºä¼ é€’ç±»ä¸­å±æ€§ä¿¡æ¯çš„ç±»ï¼Œå› ä¸ºå±æ€§å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼Œæ‰€ä»¥è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ªé›†åˆåŒ…è£…ä¸‹ã€‚</li></ul><h3 id="_3-beanå®šä¹‰è¡¥å…¨" tabindex="-1"><a class="header-anchor" href="#_3-beanå®šä¹‰è¡¥å…¨" aria-hidden="true">#</a> 3. Beanå®šä¹‰è¡¥å…¨</h3><p><strong>cn.bugstack.springframework.beans.factory.config.BeanDefinition</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanDefinition</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Class</span> beanClass<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">PropertyValues</span> propertyValues<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">Class</span> beanClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanClass <span class="token operator">=</span> beanClass<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>propertyValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">Class</span> beanClass<span class="token punctuation">,</span> <span class="token class-name">PropertyValues</span> propertyValues<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanClass <span class="token operator">=</span> beanClass<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>propertyValues <span class="token operator">=</span> propertyValues <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> propertyValues <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// ...get/set</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ Bean æ³¨å†Œçš„è¿‡ç¨‹ä¸­æ˜¯éœ€è¦ä¼ é€’ Bean çš„ä¿¡æ¯ï¼Œåœ¨å‡ ä¸ªå‰é¢ç« èŠ‚çš„æµ‹è¯•ä¸­éƒ½æœ‰æ‰€ä½“ç° <code>new BeanDefinition(UserService.class, propertyValues);</code></li><li>æ‰€ä»¥ä¸ºäº†æŠŠå±æ€§ä¸€å®šäº¤ç»™ Bean å®šä¹‰ï¼Œæ‰€ä»¥è¿™é‡Œå¡«å……äº† PropertyValues å±æ€§ï¼ŒåŒæ—¶æŠŠä¸¤ä¸ªæ„é€ å‡½æ•°åšäº†ä¸€äº›ç®€å•çš„ä¼˜åŒ–ï¼Œé¿å…åé¢ for å¾ªç¯æ—¶è¿˜å¾—åˆ¤æ–­å±æ€§å¡«å……æ˜¯å¦ä¸ºç©ºã€‚</li></ul><h3 id="_4-bean-å±æ€§å¡«å……" tabindex="-1"><a class="header-anchor" href="#_4-bean-å±æ€§å¡«å……" aria-hidden="true">#</a> 4. Bean å±æ€§å¡«å……</h3><p><strong>cn.bugstack.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractAutowireCapableBeanFactory</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBeanFactory</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">InstantiationStrategy</span> instantiationStrategy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CglibSubclassingInstantiationStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">createBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            bean <span class="token operator">=</span> <span class="token function">createBeanInstance</span><span class="token punctuation">(</span>beanDefinition<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ç»™ Bean å¡«å……å±æ€§</span>
            <span class="token function">applyPropertyValues</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeansException</span><span class="token punctuation">(</span><span class="token string">&quot;Instantiation of bean failed&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">addSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">createBeanInstance</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Constructor</span> constructorToUse <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> beanClass <span class="token operator">=</span> beanDefinition<span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> declaredConstructors <span class="token operator">=</span> beanClass<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> ctor <span class="token operator">:</span> declaredConstructors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> args <span class="token operator">&amp;&amp;</span> ctor<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> args<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                constructorToUse <span class="token operator">=</span> ctor<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">getInstantiationStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">instantiate</span><span class="token punctuation">(</span>beanDefinition<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> constructorToUse<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Bean å±æ€§å¡«å……
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">applyPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">PropertyValues</span> propertyValues <span class="token operator">=</span> beanDefinition<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertyValue</span> propertyValue <span class="token operator">:</span> propertyValues<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token class-name">String</span> name <span class="token operator">=</span> propertyValue<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Object</span> value <span class="token operator">=</span> propertyValue<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">BeanReference</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// A ä¾èµ– Bï¼Œè·å– B çš„å®ä¾‹åŒ–</span>
                    <span class="token class-name">BeanReference</span> beanReference <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BeanReference</span><span class="token punctuation">)</span> value<span class="token punctuation">;</span>
                    value <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>beanReference<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// å±æ€§å¡«å……</span>
                <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">setFieldValue</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeansException</span><span class="token punctuation">(</span><span class="token string">&quot;Error setting property valuesï¼š&quot;</span> <span class="token operator">+</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">InstantiationStrategy</span> <span class="token function">getInstantiationStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instantiationStrategy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setInstantiationStrategy</span><span class="token punctuation">(</span><span class="token class-name">InstantiationStrategy</span> instantiationStrategy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instantiationStrategy <span class="token operator">=</span> instantiationStrategy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸ªç±»çš„å†…å®¹ç¨å¾®æœ‰ç‚¹é•¿ï¼Œä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ–¹æ³•ï¼šcreateBeanã€createBeanInstanceã€applyPropertyValuesï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ createBean çš„æ–¹æ³•ä¸­è°ƒç”¨çš„ applyPropertyValues æ–¹æ³•ã€‚</li><li>åœ¨ applyPropertyValues ä¸­ï¼Œé€šè¿‡è·å– <code>beanDefinition.getPropertyValues()</code> å¾ªç¯è¿›è¡Œå±æ€§å¡«å……æ“ä½œï¼Œå¦‚æœé‡åˆ°çš„æ˜¯ BeanReferenceï¼Œé‚£ä¹ˆå°±éœ€è¦é€’å½’è·å– Bean å®ä¾‹ï¼Œè°ƒç”¨ getBean æ–¹æ³•ã€‚</li><li>å½“æŠŠä¾èµ–çš„ Bean å¯¹è±¡åˆ›å»ºå®Œæˆåï¼Œä¼šé€’å½’å›ç°åœ¨å±æ€§å¡«å……ä¸­ã€‚è¿™é‡Œéœ€è¦æ³¨æ„æˆ‘ä»¬å¹¶æ²¡æœ‰å»å¤„ç†å¾ªç¯ä¾èµ–çš„é—®é¢˜ï¼Œè¿™éƒ¨åˆ†å†…å®¹è¾ƒå¤§ï¼Œåç»­è¡¥å……ã€‚<em>BeanUtil.setFieldValue(bean, name, value) æ˜¯ hutool-all å·¥å…·ç±»ä¸­çš„æ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å®ç°</em></li></ul><h2 id="äº”ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#äº”ã€æµ‹è¯•" aria-hidden="true">#</a> äº”ã€æµ‹è¯•</h2><h3 id="_1-äº‹å…ˆå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-äº‹å…ˆå‡†å¤‡" aria-hidden="true">#</a> 1. äº‹å…ˆå‡†å¤‡</h3><p><strong>cn.bugstack.springframework.test.bean.UserDao</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10002&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å…«æ¯æ°´&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10003&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é˜¿æ¯›&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queryUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>cn.bugstack.springframework.test.bean.UserService</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> uId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼š&quot;</span> <span class="token operator">+</span> userDao<span class="token punctuation">.</span><span class="token function">queryUserName</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...get/set</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Daoã€Serviceï¼Œæ˜¯æˆ‘ä»¬å¹³å¸¸å¼€å‘ç»å¸¸ä½¿ç”¨çš„åœºæ™¯ã€‚åœ¨ UserService ä¸­æ³¨å…¥ UserDaoï¼Œè¿™æ ·å°±èƒ½ä½“ç°å‡ºBeanå±æ€§çš„ä¾èµ–äº†ã€‚</li></ul><h3 id="_2-æµ‹è¯•ç”¨ä¾‹" tabindex="-1"><a class="header-anchor" href="#_2-æµ‹è¯•ç”¨ä¾‹" aria-hidden="true">#</a> 2. æµ‹è¯•ç”¨ä¾‹</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_BeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.åˆå§‹åŒ– BeanFactory</span>
    <span class="token class-name">DefaultListableBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token comment">// 2. UserDao æ³¨å†Œ</span>
    beanFactory<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">UserDao</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   

    <span class="token comment">// 3. UserService è®¾ç½®å±æ€§[uIdã€userDao]</span>
    <span class="token class-name">PropertyValues</span> propertyValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    propertyValues<span class="token punctuation">.</span><span class="token function">addPropertyValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;uId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    propertyValues<span class="token punctuation">.</span><span class="token function">addPropertyValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BeanReference</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token comment">// 4. UserService æ³¨å…¥bean</span>
    <span class="token class-name">BeanDefinition</span> beanDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> propertyValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
    beanFactory<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>    

    <span class="token comment">// 5. UserService è·å–bean</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userService<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¸ç›´æ¥è·å– Bean å¯¹è±¡ä¸åŒï¼Œè¿™æ¬¡æˆ‘ä»¬è¿˜éœ€è¦å…ˆæŠŠ userDao æ³¨å…¥åˆ° Bean å®¹å™¨ä¸­ã€‚<code>beanFactory.registerBeanDefinition(&quot;userDao&quot;, new BeanDefinition(UserDao.class)); </code></li><li>æ¥ä¸‹æ¥å°±æ˜¯å±æ€§å¡«å……çš„æ“ä½œäº†ï¼Œä¸€ç§æ˜¯æ™®é€šå±æ€§ <code>new PropertyValue(&quot;uId&quot;, &quot;10001&quot;)</code>ï¼Œå¦å¤–ä¸€ç§æ˜¯å¯¹è±¡å±æ€§ <code>new PropertyValue(&quot;userDao&quot;,new BeanReference(&quot;userDao&quot;))</code></li><li>æ¥ä¸‹æ¥çš„æ“ä½œå°±ç®€å•äº†ï¼Œåªä¸è¿‡æ˜¯æ­£å¸¸è·å– userService å¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•å³å¯ã€‚</li></ul><h3 id="_3-æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_3-æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> 3. æµ‹è¯•ç»“æœ</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼šå°å‚…å“¥

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä»æµ‹è¯•ç»“æœçœ‹æˆ‘ä»¬çš„å±æ€§å¡«å……å·²ç»èµ·ä½œç”¨äº†ï¼Œå› ä¸ºåªæœ‰å±æ€§å¡«å……åï¼Œæ‰èƒ½è°ƒç”¨åˆ°Daoæ–¹æ³•ï¼Œå¦‚ï¼š<code>userDao.queryUserName(uId)</code></p></li><li><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨çœ‹çœ‹Debugè°ƒè¯•çš„æƒ…å†µä¸‹ï¼Œæœ‰æ²¡æœ‰è¿›å…¥åˆ°å®ç°çš„ Bean å±æ€§å¡«å……ä¸­ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://bugstack.cn/assets/images/spring/spring-5-03.png" alt=""></p><ul><li>å¥½ï¼Œå°±æ˜¯æˆªå›¾è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°å·²ç»å¼€å§‹è¿›è¡Œå±æ€§å¡«å……æ“ä½œäº†ï¼Œå½“å‘ç°å±æ€§æ˜¯ BeanReference æ—¶ï¼Œåˆ™éœ€è¦è·å–åˆ›å»º Bean å®ä¾‹ã€‚</li></ul></li></ul><h2 id="å…­ã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å…­ã€æ€»ç»“" aria-hidden="true">#</a> å…­ã€æ€»ç»“</h2><ul><li>åœ¨æœ¬ç« èŠ‚ä¸­æˆ‘ä»¬æŠŠ AbstractAutowireCapableBeanFactory ç±»ä¸­çš„åˆ›å»ºå¯¹è±¡åŠŸèƒ½åˆåšäº†æ‰©å……ï¼Œä¾èµ–äºæ˜¯å¦æœ‰æ„é€ å‡½æ•°çš„å®ä¾‹åŒ–ç­–ç•¥å®Œæˆåï¼Œå¼€å§‹è¡¥å…… Bean å±æ€§ä¿¡æ¯ã€‚å½“é‡åˆ° Bean å±æ€§ä¸º Bean å¯¹è±¡æ—¶ï¼Œéœ€è¦é€’å½’å¤„ç†ã€‚æœ€ååœ¨å±æ€§å¡«å……æ—¶éœ€è¦ç”¨åˆ°åå°„æ“ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›å·¥å…·ç±»å¤„ç†ã€‚</li><li>æ¯ä¸€ä¸ªç« èŠ‚çš„åŠŸèƒ½ç‚¹æˆ‘ä»¬éƒ½åœ¨å¾ªåºæ¸è¿›çš„å®ç°ï¼Œè¿™æ ·å¯ä»¥è®©æ–°äººæ›´å¥½çš„æ¥å—å…³äº Spring ä¸­çš„è®¾è®¡æ€è·¯ã€‚å°¤å…¶æ˜¯åœ¨ä¸€äº›å·²ç»å¼€å‘å¥½çš„ç±»ä¸Šï¼Œæ€ä¹ˆæ‰©å……æ–°çš„åŠŸèƒ½æ—¶å€™çš„è®¾è®¡æ›´ä¸ºé‡è¦ã€‚å­¦ä¹ ç¼–ç¨‹æœ‰çš„æ—¶å€™å­¦ä¹ æ€è·¯è®¾è®¡è¦æ¯”ä»…ä»…æ˜¯åšç®€å•å®ç°ï¼Œæ›´èƒ½æå‡ç¼–ç¨‹æ€ç»´ã€‚</li><li>åˆ°è¿™ä¸€ç« èŠ‚å…³äº Bean çš„åˆ›å»ºæ“ä½œå°±å¼€å‘å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥éœ€è¦æ•´ä¸ªæ¡†æ¶çš„åŸºç¡€ä¸Šå®Œæˆèµ„æºå±æ€§çš„åŠ è½½ï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦å»åŠ¨ Xml é…ç½®äº†ï¼Œè®©æˆ‘ä»¬è¿™å°æ¡†æ¶è¶Šæ¥è¶Šåƒ Springã€‚å¦å¤–åœ¨æ¡†æ¶å®ç°çš„è¿‡ç¨‹ä¸­æ‰€æœ‰çš„ç±»åéƒ½ä¼šå‚è€ƒ Spring æºç ï¼Œä»¥åŠç›¸åº”çš„è®¾è®¡å®ç°æ­¥éª¤ä¹Ÿæ˜¯ä¸ Spring æºç ä¸­å¯¹åº”ï¼Œåªä¸è¿‡ä¼šç®€åŒ–ä¸€äº›æµç¨‹ï¼Œä½†ä½ å¯ä»¥æ‹¿ç›¸åŒçš„ç±»åï¼Œå»æœåˆ°æ¯ä¸€ä¸ªåŠŸèƒ½åœ¨ Spring æºç ä¸­çš„å®ç°ã€‚</li></ul><h2 id="ä¸ƒã€ä¼˜ç§€ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€ä¼˜ç§€ä½œä¸š" aria-hidden="true">#</a> ä¸ƒã€ä¼˜ç§€ä½œä¸š</h2>`,42),w={href:"https://t.zsxq.com/05AiaUJuV",target:"_blank",rel:"noopener noreferrer"},E={href:"https://t.zsxq.com/06nUNZJIA",target:"_blank",rel:"noopener noreferrer"},_={href:"https://t.zsxq.com/07Nsp9m64",target:"_blank",rel:"noopener noreferrer"},A={href:"https://t.zsxq.com/07IAklHLs",target:"_blank",rel:"noopener noreferrer"},V={href:"https://t.zsxq.com/07WTcflJE",target:"_blank",rel:"noopener noreferrer"},D={href:"https://t.zsxq.com/073LNvrkV",target:"_blank",rel:"noopener noreferrer"},q={href:"https://t.zsxq.com/08x3zDtYQ",target:"_blank",rel:"noopener noreferrer"},S={href:"https://t.zsxq.com/08fb1tWcp",target:"_blank",rel:"noopener noreferrer"},j={href:"https://t.zsxq.com/0akd1q9b6",target:"_blank",rel:"noopener noreferrer"},x={href:"https://t.zsxq.com/0awh9UUvp",target:"_blank",rel:"noopener noreferrer"},C={href:"https://t.zsxq.com/0b1v9zM2X",target:"_blank",rel:"noopener noreferrer"},P={href:"https://t.zsxq.com/0cpTuoSNs",target:"_blank",rel:"noopener noreferrer"};function U(I,F){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),e(a)]),d,s("åŸæ–‡ï¼š"),n("a",v,[s("https://mp.weixin.qq.com/s/EKoMDpa4q8TMikRM2wBIzw"),e(a)])]),m,n("p",null,[s("é¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸‹è¿™å‡ ç« èŠ‚éƒ½å®Œæˆäº†ä»€ä¹ˆï¼ŒåŒ…æ‹¬ï¼š"),n("a",b,[s("å®ç°ä¸€ä¸ªå®¹å™¨"),e(a)]),s("ã€"),n("a",g,[s("å®šä¹‰å’Œæ³¨å†ŒBean"),e(a)]),s("ã€"),n("a",y,[s("å®ä¾‹åŒ–Bean"),e(a)]),s("ï¼Œ"),n("a",h,[s("æŒ‰ç…§æ˜¯å¦åŒ…å«æ„é€ å‡½æ•°å®ç°ä¸åŒçš„å®ä¾‹åŒ–ç­–ç•¥"),e(a)]),s("ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºå¯¹è±¡å®ä¾‹åŒ–è¿™æˆ‘ä»¬è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿå…¶å®è¿˜ç¼ºå°‘ä¸€ä¸ªå…³äº"),f,s("ï¼Œå¦‚æœæœ‰ç±»ä¸­åŒ…å«å±æ€§é‚£ä¹ˆåœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±éœ€è¦æŠŠå±æ€§ä¿¡æ¯å¡«å……ä¸Šï¼Œè¿™æ ·æ‰æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡åˆ›å»ºã€‚")]),B,n("ul",null,[n("li",null,[n("a",w,[s("å­¦ä¹ ç¬”è®° By Chin"),e(a)])]),n("li",null,[n("a",E,[s("ç»™beanæ³¨å…¥å±æ€§å’Œä¾èµ–å¯¹è±¡ï¼ˆä¾‹ï¼šç»™UserServiceæ³¨å…¥uIdå’ŒUserDaoï¼‰@liuc"),e(a)])]),n("li",null,[n("a",_,[s("å¯¹springçš„2-4ç« èŠ‚è¿›è¡Œæ€»ä½“çš„æ¢³ç†ï¼ˆå·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œæ¨¡æ¿æ¨¡å¼ï¼Œç­–ç•¥æ¨¡å¼ï¼‰@å–‚æ©™å­"),e(a)])]),n("li",null,[n("a",A,[s("å±æ€§å¡«å……çš„æ—¶æœºï¼ˆè¦åœ¨ç±»å®ä¾‹åŒ–åˆ›å»ºä¹‹åï¼‰@åˆ˜å°ç™½"),e(a)])]),n("li",null,[n("a",V,[s("ä¸»è¦ç›®æ ‡å°±æ˜¯è§£å†³å±æ€§å¡«å……é—®é¢˜ï¼Œå…·ä½“æ¥è¯´åˆç»†åˆ†ä¸º(å±æ€§ç›¸å…³ç±»çš„è®¾è®¡ã€å¡«å……å±æ€§çš„æ—¶æœº) @Homage"),e(a)])]),n("li",null,[n("a",D,[s("æ³¨å…¥å±æ€§å’Œä¾èµ–å¯¹è±¡ @å‚…å“¥åæ´ä¼šä¼šé•¿"),e(a)])]),n("li",null,[n("a",q,[s("è·å–beanåï¼Œå¢åŠ å¡«å……å±æ€§æµç¨‹ @mkii"),e(a)])]),n("li",null,[n("a",S,[s("springæ¡†æ¶è¿˜ä¸èƒ½å®Œæˆå®ç°å¯¹è±¡å±æ€§å€¼çš„å¡«å…… @è€ƒå°æ‹‰à¸„à¸´à¸”à¸–à¸¶à¸‡"),e(a)])]),n("li",null,[n("a",j,[s("å¾ªç¯è·å–åˆ›å»ºbeanå¯¹è±¡BeanReference(ç±»å¼•ç”¨ç±») @å°æ±¤å“¥"),e(a)])]),n("li",null,[n("a",x,[s("èµ„æºåŠ è½½å™¨è§£ææ–‡ä»¶æ³¨å†Œå¯¹è±¡ @ææ˜Œç¥¥"),e(a)])]),n("li",null,[n("a",C,[s("å®ç°åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œè‡ªåŠ¨è¯†åˆ«ï¼Œèµ„æºåŠ è½½ @çˆ±å¥‹æ–—çš„å°é²¨é±¼"),e(a)])]),n("li",null,[n("a",P,[s("åŒºåˆ†Beanå·¥å‚ä¸­ä¸¤ä¸ªå¯¹è±¡ï¼šBeanDefinitionå’ŒObjectï¼Œå…¶ä¸­BeanDefinitionæˆå‘˜å¯¹è±¡ä¸­ä¿å­˜çš„æ˜¯classç±» @L.ast"),e(a)])])])])}const z=p(i,[["render",U],["__file","2021-06-02-di5zhangï¼šyimingjingrenï¼ŒweiBeanduixiangzhurushuxingheyilaiBeandegongnenshixian.html.vue"]]);export{z as default};
