import{_ as t,r as p,o as c,c as o,a as n,b as s,d as e,e as l}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"ã€Šmybatis-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬4ç« -mapper-xmlçš„è§£æå’Œæ³¨å†Œä½¿ç”¨",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ã€Šmybatis-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬4ç« -mapper-xmlçš„è§£æå’Œæ³¨å†Œä½¿ç”¨","aria-hidden":"true"},"#"),s(" ã€ŠMybatis æ‰‹æ’¸ä¸“æ ã€‹ç¬¬4ç« ï¼šMapper XMLçš„è§£æå’Œæ³¨å†Œä½¿ç”¨")],-1),r=n("br",null,null,-1),d={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),m={href:"https://mp.weixin.qq.com/s/C_bb9f1Hr9aJAvbmrDHHig",target:"_blank",rel:"noopener noreferrer"},v=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),b=n("iframe",{id:"B-Video",src:"//player.bilibili.com/player.html?aid=469969468&bvid=BV1qT41157D8&cid=744089465&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"480"}," ",-1),g=l(`<h2 id="ä¸€ã€å‰è¨€" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€å‰è¨€" aria-hidden="true">#</a> ä¸€ã€å‰è¨€</h2><p><code>ä½ æ˜¯æ€ä¹ˆé¢å¯¹åŠŸèƒ½è¿­ä»£çš„ï¼Ÿ</code></p><p>å…¶å®å¾ˆå¤šç¨‹åºå‘˜åœ¨åˆšå¼€å§‹åšç¼–ç¨‹æˆ–è€…æ–°åŠ å…¥ä¸€å®¶å…¬å¸æ—¶ï¼Œéƒ½æ²¡æœ‰å¤šå°‘æœºä¼šå¯ä»¥åšä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éƒ½æ˜¯åœ¨è€é¡¹ç›®ä¸Šä¸æ–­çš„è¿­ä»£æ›´æ–°ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä½ å¯èƒ½è¦å­¦ä¹ Nä¸ªå‰äººç•™ä¸‹çš„å„å¼å„æ ·çš„é£æ ¼è¿¥å¼‚çš„ä»£ç ç‰‡æ®µï¼Œåœ¨è¿™äº›çºµæ¨ªäº¤é”™çš„æµç¨‹ä¸­ï¼Œæ‰¾åˆ°ä¸€å¸­ä¹‹åœ°ï¼ŒæŠŠè‡ªå·±çš„<code>ifelse</code>åŠ è¿›å»ã€‚</p><p>è™½ç„¶è¿™æ ·èƒ¡ä¹±çš„åŠ <code>ifelse</code>ï¼Œåˆšä¸Šæ‰‹å°±â€œæ‘†çƒ‚â€çš„å¿ƒæ€ï¼Œè®©äººå¾ˆéš¾å—ã€‚ä½†è¦æƒ³åœ¨å·²ç»è¢«å‹ç¼©çš„å·¥æœŸä¸‹ï¼Œè¿˜èƒ½äº¤ä»˜å‡ºé«˜è´¨é‡çš„ä»£ç å…¶å®ä¹Ÿå¾ˆéš¾å®Œæˆï¼Œæ‰€ä»¥ä¸€éƒ¨åˆ†ç ”å‘è¢«é€¼åˆ°èƒ½ç”¨å°±è¡Œï¼Œèƒ½è·‘å°±å¯ä»¥ã€‚</p><p>ä½†è¯´å›æ¥ï¼Œå…¶å®ä¸èƒ½é€æ­¥æ¸…ç†ä¸€ç‰‡å±å±±ï¼Œè®©ä»£ç åœ¨ä½ çš„æ‰‹ä¸Šé€æ­¥æ¸…æ™°ã€æ•´æ´ã€å¹²å‡€ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿæ˜¯ä½œä¸ºç å†œè‡ªèº«ç»éªŒçš„ä¸è¶³ï¼Œä¸æ‡‚å¾—ç³»ç»Ÿé‡æ„ã€ä¸äº†è§£è®¾è®¡åŸåˆ™ã€ä¸ç†Ÿæ‚‰ä¸šåŠ¡èƒŒæ™¯ã€ä¸æ¸…æ¥šäº§å“èµ°å‘ç­‰ç­‰åŸå› é€ æˆçš„ã€‚æ‰€ä»¥æœ€å¥½çš„åŠæ³•æ˜¯æå‡è‡ªèº«çš„èƒ½åŠ›ï¼Œæ¯æ¥åˆ°ä¸€æ¬¡éœ€æ±‚éƒ½æœ‰ä¸€äº›æŠ€æœ¯ä¸Šçš„æ”¹å˜ï¼Œæ—¢ç„¶å®ƒæ˜¯å±å±±ï¼Œé‚£å°±å½“åšæ‰“æ€ªå‡çº§äº†ï¼Œä¿®ä¸€ç‚¹ã€æ”¹ä¸€å—ã€è¡¥ä¸€ç‰‡ï¼Œæ€»ä¼šåœ¨ä½ æ‰‹ä¸Šè¶Šæ¥è¶Šæ˜“äºç»´æŠ¤å’Œæ‰©å±•çš„ã€‚</p><h2 id="äºŒã€ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç›®æ ‡" aria-hidden="true">#</a> äºŒã€ç›®æ ‡</h2><p>åœ¨æˆ‘ä»¬æ¸è¿›å¼çš„é€æ­¥å®ç° Mybatis æ¡†æ¶è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æœ‰ä¸€ä¸ªç›®æ ‡å¯¼å‘çš„æ€è·¯ï¼Œä¹Ÿå°±æ˜¯è¯´ Mybatis çš„æ ¸å¿ƒé€»è¾‘æ€ä¹ˆå®ç°ã€‚</p><p>å…¶å®æˆ‘ä»¬å¯ä»¥æŠŠè¿™æ ·ä¸€ä¸ª ORM æ¡†æ¶çš„ç›®æ ‡ï¼Œç®€å•çš„æè¿°æˆæ˜¯ä¸ºäº†ç»™ä¸€ä¸ªæ¥å£æä¾›ä»£ç†ç±»ï¼Œç±»ä¸­åŒ…æ‹¬äº†å¯¹ Mapper ä¹Ÿå°±æ˜¯ xml æ–‡ä»¶ä¸­çš„ SQL ä¿¡æ¯(<code>ç±»å‹</code>ã€<code>å…¥å‚</code>ã€<code>å‡ºå‚</code>ã€<code>æ¡ä»¶</code>)è¿›è¡Œè§£æå’Œå¤„ç†ï¼Œè¿™ä¸ªå¤„ç†è¿‡ç¨‹å°±æ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œä»¥åŠè¿”å›å¯¹åº”çš„ç»“æœç»™åˆ°æ¥å£ã€‚å¦‚å›¾ 4-1</p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220409-01.png" alt="å›¾ 4-1 ORM æ¡†æ¶æ ¸å¿ƒæµç¨‹"></p><p>é‚£ä¹ˆæŒ‰ç…§ ORM æ ¸å¿ƒæµç¨‹çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ‘ä»¬æœ¬ç« èŠ‚å°±éœ€è¦åœ¨ä¸Šä¸€ç« èŠ‚çš„åŸºç¡€ä¸Šï¼Œç»§ç»­æ‰©å±•å¯¹ Mapper æ–‡ä»¶çš„è§£æä»¥åŠæå–å‡ºå¯¹åº”çš„ SQL æ–‡ä»¶ã€‚å¹¶åœ¨å½“å‰è¿™ä¸ªé˜¶æ®µï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬è°ƒç”¨ DAO æ¥å£æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥è¿”å› Mapper ä¸­å¯¹åº”çš„å¾…æ‰§è¡Œ SQL è¯­å¥ã€‚<em>ä¸ºäº†ä¸è‡³äºæŠŠæ•´ä¸ªå·¥ç¨‹æ’‘å¤§ï¼Œå°å‚…å“¥ä¼šå¸¦ç€å¤§å®¶é€æ­¥å®Œæˆè¿™äº›å†…å®¹ï¼Œæ‰€ä»¥æœ¬ç« èŠ‚æš‚æ—¶ä¸ä¼šå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œå¾…åç»­é€æ­¥å®ç°</em></p><h2 id="ä¸‰ã€è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€è®¾è®¡" aria-hidden="true">#</a> ä¸‰ã€è®¾è®¡</h2><p>ç»“åˆä¸Šä¸€ç« èŠ‚æˆ‘ä»¬ä½¿ç”¨äº† <code>MapperRegistry</code> å¯¹åŒ…è·¯å¾„è¿›è¡Œæ‰«ææ³¨å†Œæ˜ å°„å™¨ï¼Œå¹¶åœ¨ <code>DefaultSqlSession</code> ä¸­è¿›è¡Œä½¿ç”¨ã€‚é‚£ä¹ˆåœ¨æˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›å‘½åç©ºé—´ã€SQLæè¿°ã€æ˜ å°„ä¿¡æ¯ç»Ÿä¸€ç»´æŠ¤åˆ°æ¯ä¸€ä¸ª DAO å¯¹åº”çš„ Mapper XML çš„æ–‡ä»¶ä»¥åï¼Œå…¶å® XML å°±æ˜¯æˆ‘ä»¬çš„æºå¤´äº†ã€‚é€šè¿‡å¯¹ XML æ–‡ä»¶çš„è§£æå’Œå¤„ç†å°±å¯ä»¥å®Œæˆ Mapper æ˜ å°„å™¨çš„æ³¨å†Œå’Œ SQL ç®¡ç†ã€‚è¿™æ ·ä¹Ÿå°±æ›´åŠ æˆ‘ä»¬æ“ä½œå’Œä½¿ç”¨äº†ã€‚å¦‚å›¾ 4-2</p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220409-02.png" alt="å›¾ 4-2 XML æ–‡ä»¶è§£ææ³¨å†Œå¤„ç†"></p><ul><li>é¦–å…ˆéœ€è¦å®šä¹‰ <code>SqlSessionFactoryBuilder</code> å·¥å‚å»ºé€ è€…æ¨¡å¼ç±»ï¼Œé€šè¿‡å…¥å£ IO çš„æ–¹å¼å¯¹ XML æ–‡ä»¶è¿›è¡Œè§£æã€‚å½“å‰æˆ‘ä»¬ä¸»è¦ä»¥è§£æ SQL éƒ¨åˆ†ä¸ºä¸»ï¼Œå¹¶æ³¨å†Œæ˜ å°„å™¨ï¼Œä¸²è”å‡ºæ•´ä¸ªæ ¸å¿ƒæµç¨‹çš„è„‰ç»œã€‚</li><li>æ–‡ä»¶è§£æä»¥åä¼šå­˜æ”¾åˆ° Configuration é…ç½®ç±»ä¸­ï¼Œæ¥ä¸‹æ¥ä½ ä¼šçœ‹åˆ°è¿™ä¸ªé…ç½®ç±»ä¼šè¢«ä¸²è”åˆ°æ•´ä¸ª Mybatis æµç¨‹ä¸­ï¼Œæ‰€æœ‰å†…å®¹å­˜æ”¾å’Œè¯»å–éƒ½ç¦»ä¸å¼€è¿™ä¸ªç±»ã€‚å¦‚æˆ‘ä»¬åœ¨ DefaultSqlSession ä¸­è·å– Mapper å’Œæ‰§è¡Œ selectOne ä¹ŸåŒæ ·æ˜¯éœ€è¦åœ¨ Configuration é…ç½®ç±»ä¸­è¿›è¡Œè¯»å–æ“ä½œã€‚</li></ul><h2 id="å››ã€å®ç°" tabindex="-1"><a class="header-anchor" href="#å››ã€å®ç°" aria-hidden="true">#</a> å››ã€å®ç°</h2><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>mybatis<span class="token operator">-</span>step<span class="token operator">-</span><span class="token number">03</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis
    â”‚           â”œâ”€â”€ binding
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MapperMethod</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MapperProxy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MapperProxyFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">MapperRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ builder
    â”‚           â”‚   â”œâ”€â”€ xml
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">XMLConfigBuilder</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">BaseBuilder</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ io
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">Resources</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ mapping
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">MappedStatement</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">SqlCommandType</span><span class="token punctuation">.</span>java
    â”‚           â””â”€â”€ session
    â”‚               â”œâ”€â”€ defaults
    â”‚               â”‚   â”œâ”€â”€ <span class="token class-name">DefaultSqlSession</span><span class="token punctuation">.</span>java
    â”‚               â”‚   â””â”€â”€ <span class="token class-name">DefaultSqlSessionFactory</span><span class="token punctuation">.</span>java
    â”‚               â”œâ”€â”€ <span class="token class-name">Configuration</span><span class="token punctuation">.</span>java
    â”‚               â”œâ”€â”€ <span class="token class-name">SqlSession</span><span class="token punctuation">.</span>java
    â”‚               â”œâ”€â”€ <span class="token class-name">SqlSessionFactory</span><span class="token punctuation">.</span>java
    â”‚               â””â”€â”€ <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">.</span>java
    â””â”€â”€ test
        â”œâ”€â”€ java
        â”‚   â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span>dao
        â”‚       â”œâ”€â”€ dao
        â”‚       â”‚   â””â”€â”€ <span class="token class-name">IUserDao</span><span class="token punctuation">.</span>java
        â”‚       â”œâ”€â”€ po
        â”‚       â”‚   â””â”€â”€ <span class="token class-name">User</span><span class="token punctuation">.</span>java
        â”‚       â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
        â””â”€â”€ resources
            â”œâ”€â”€ mapper
            â”‚   â””â”€â”€<span class="token class-name">User_Mapper</span><span class="token punctuation">.</span>xml
            â””â”€â”€ mybatis<span class="token operator">-</span>config<span class="token operator">-</span>datasource<span class="token punctuation">.</span>xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å·¥ç¨‹æºç </strong>ï¼š<code>å…¬ä¼—å·ã€Œbugstackè™«æ´æ ˆã€ï¼Œå›å¤ï¼šæ‰‹å†™Mybatisï¼Œè·å–å®Œæ•´æºç </code></p><p>XML è§£æå’Œæ³¨å†Œç±»å®ç°å…³ç³»ï¼Œå¦‚å›¾ 4-2</p><p><img src="https://bugstack.cn/images/article/spring/mybatis-220409-03.png" alt="å›¾ 4-2 XML è§£æå’Œæ³¨å†Œç±»å®ç°å…³ç³»"></p><ul><li>SqlSessionFactoryBuilder ä½œä¸ºæ•´ä¸ª Mybatis çš„å…¥å£ï¼Œæä¾›å»ºé€ è€…å·¥å‚ï¼ŒåŒ…è£… XML è§£æå¤„ç†ï¼Œå¹¶è¿”å›å¯¹åº” SqlSessionFactory å¤„ç†ç±»ã€‚</li><li>é€šè¿‡è§£ææŠŠ XML ä¿¡æ¯æ³¨å†Œåˆ° Configuration é…ç½®ç±»ä¸­ï¼Œå†é€šè¿‡ä¼ é€’ Configuration é…ç½®ç±»åˆ°å„ä¸ªé€»è¾‘å¤„ç†ç±»é‡Œï¼ŒåŒ…æ‹¬ DefaultSqlSession ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è·å–æ˜ å°„å™¨å’Œæ‰§è¡ŒSQLçš„æ—¶å€™ï¼Œä»é…ç½®ç±»ä¸­æ‹¿åˆ°å¯¹åº”çš„å†…å®¹äº†ã€‚</li></ul><h3 id="_2-æ„å»ºsqlsessionfactoryå»ºé€ è€…å·¥å‚" tabindex="-1"><a class="header-anchor" href="#_2-æ„å»ºsqlsessionfactoryå»ºé€ è€…å·¥å‚" aria-hidden="true">#</a> 2. æ„å»ºSqlSessionFactoryå»ºé€ è€…å·¥å‚</h3><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.session.SqlSessionFactoryBuilder</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SqlSessionFactoryBuilder</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">Reader</span> reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">XMLConfigBuilder</span> xmlConfigBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLConfigBuilder</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">build</span><span class="token punctuation">(</span>xmlConfigBuilder<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DefaultSqlSessionFactory</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>SqlSessionFactoryBuilder æ˜¯ä½œä¸ºæ•´ä¸ª Mybatis çš„å…¥å£ç±»ï¼Œé€šè¿‡æŒ‡å®šè§£æXMLçš„IOï¼Œå¼•å¯¼æ•´ä¸ªæµç¨‹çš„å¯åŠ¨ã€‚</li><li>ä»è¿™ä¸ªç±»å¼€å§‹æ–°å¢åŠ äº† XMLConfigBuilderã€Configuration ä¸¤ä¸ªå¤„ç†ç±»ï¼Œåˆ†åˆ«ç”¨äºè§£æ XML å’Œä¸²è”æ•´ä¸ªæµç¨‹çš„å¯¹è±¡ä¿å­˜æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šåˆ†åˆ«ä»‹ç»è¿™äº›æ–°å¼•å…¥çš„å¯¹è±¡ã€‚</li></ul><h3 id="_3-xml-è§£æå¤„ç†" tabindex="-1"><a class="header-anchor" href="#_3-xml-è§£æå¤„ç†" aria-hidden="true">#</a> 3. XML è§£æå¤„ç†</h3><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.builder.xml.XMLConfigBuilder</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XMLConfigBuilder</span> <span class="token keyword">extends</span> <span class="token class-name">BaseBuilder</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Element</span> root<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">XMLConfigBuilder</span><span class="token punctuation">(</span><span class="token class-name">Reader</span> reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. è°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–Configuration</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. dom4j å¤„ç† xml</span>
        <span class="token class-name">SAXReader</span> saxReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SAXReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Document</span> document <span class="token operator">=</span> saxReader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getRootElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">DocumentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Configuration</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// è§£ææ˜ å°„å™¨</span>
            <span class="token function">mapperElement</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">&quot;mappers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;Error parsing SQL Mapper Configuration. Cause: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> configuration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">mapperElement</span><span class="token punctuation">(</span><span class="token class-name">Element</span> mappers<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Element</span><span class="token punctuation">&gt;</span></span> mapperList <span class="token operator">=</span> mappers<span class="token punctuation">.</span><span class="token function">elements</span><span class="token punctuation">(</span><span class="token string">&quot;mapper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Element</span> e <span class="token operator">:</span> mapperList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            		<span class="token comment">// è§£æå¤„ç†ï¼Œå…·ä½“å‚ç…§æºç </span>
            		
                <span class="token comment">// æ·»åŠ è§£æ SQL</span>
                configuration<span class="token punctuation">.</span><span class="token function">addMappedStatement</span><span class="token punctuation">(</span>mappedStatement<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// æ³¨å†ŒMapperæ˜ å°„å™¨</span>
            configuration<span class="token punctuation">.</span><span class="token function">addMapper</span><span class="token punctuation">(</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">classForName</span><span class="token punctuation">(</span>namespace<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>XMLConfigBuilder æ ¸å¿ƒæ“ä½œåœ¨äºåˆå§‹åŒ– Configurationï¼Œå› ä¸º Configuration çš„ä½¿ç”¨ç¦»è§£æ XML å’Œå­˜æ”¾æ˜¯æœ€è¿‘çš„æ“ä½œï¼Œæ‰€ä»¥æ”¾åœ¨è¿™é‡Œæ¯”è¾ƒé€‚åˆã€‚</li><li>ä¹‹åå°±æ˜¯å…·ä½“çš„ parse() è§£ææ“ä½œï¼Œå¹¶æŠŠè§£æåçš„ä¿¡æ¯ï¼Œé€šè¿‡ Configuration é…ç½®ç±»è¿›è¡Œå­˜æ”¾ï¼ŒåŒ…æ‹¬ï¼šæ·»åŠ è§£æ SQLã€æ³¨å†ŒMapperæ˜ å°„å™¨ã€‚</li><li>è§£æé…ç½®æ•´ä½“åŒ…æ‹¬ï¼šç±»å‹åˆ«åã€æ’ä»¶ã€å¯¹è±¡å·¥å‚ã€å¯¹è±¡åŒ…è£…å·¥å‚ã€è®¾ç½®ã€ç¯å¢ƒã€ç±»å‹è½¬æ¢ã€æ˜ å°„å™¨ï¼Œä½†ç›®å‰æˆ‘ä»¬è¿˜ä¸éœ€è¦é‚£ä¹ˆå¤šï¼Œæ‰€ä»¥åªåšä¸€äº›å¿…è¦çš„ SQL è§£æå¤„ç†ã€‚</li></ul><h3 id="_4-é€šè¿‡é…ç½®ç±»åŒ…è£…æ³¨å†Œæœºå’Œsqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_4-é€šè¿‡é…ç½®ç±»åŒ…è£…æ³¨å†Œæœºå’Œsqlè¯­å¥" aria-hidden="true">#</a> 4. é€šè¿‡é…ç½®ç±»åŒ…è£…æ³¨å†Œæœºå’ŒSQLè¯­å¥</h3><p><strong>æºç è¯¦è§(é…ç½®é¡¹)</strong>ï¼š<code>cn.bugstack.mybatis.session.Configuration</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ˜ å°„æ³¨å†Œæœº
     */</span>
    <span class="token keyword">protected</span> <span class="token class-name">MapperRegistry</span> mapperRegistry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperRegistry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ˜ å°„çš„è¯­å¥ï¼Œå­˜åœ¨Mapé‡Œ
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MappedStatement</span><span class="token punctuation">&gt;</span></span> mappedStatements <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">addMapper</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mapperRegistry<span class="token punctuation">.</span><span class="token function">addMapper</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addMappedStatement</span><span class="token punctuation">(</span><span class="token class-name">MappedStatement</span> ms<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mappedStatements<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ms<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨é…ç½®ç±»ä¸­æ·»åŠ æ˜ å°„å™¨æ³¨å†Œæœºå’Œæ˜ å°„è¯­å¥çš„å­˜æ”¾ï¼›</p><ul><li>æ˜ å°„å™¨æ³¨å†Œæœºæ˜¯æˆ‘ä»¬ä¸Šä¸€ç« èŠ‚å®ç°çš„å†…å®¹ï¼Œç”¨äºæ³¨å†Œ Mapper æ˜ å°„å™¨é”æä¾›çš„æ“ä½œç±»ã€‚</li><li>å¦å¤–ä¸€ä¸ª MappedStatement æ˜¯æœ¬ç« èŠ‚æ–°æ·»åŠ çš„ SQL ä¿¡æ¯è®°å½•å¯¹è±¡ï¼ŒåŒ…æ‹¬è®°å½•ï¼šSQLç±»å‹ã€SQLè¯­å¥ã€å…¥å‚ç±»å‹ã€å‡ºå‚ç±»å‹ç­‰ã€‚<em>è¯¦ç»†å¯å‚ç…§æºç </em></li></ul><h3 id="_5-defaultsqlsessionç»“åˆé…ç½®é¡¹è·å–ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-defaultsqlsessionç»“åˆé…ç½®é¡¹è·å–ä¿¡æ¯" aria-hidden="true">#</a> 5. DefaultSqlSessionç»“åˆé…ç½®é¡¹è·å–ä¿¡æ¯</h3><p><strong>æºç è¯¦è§</strong>ï¼š<code>cn.bugstack.mybatis.session.defaults.DefaultSqlSession</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultSqlSession</span> <span class="token keyword">implements</span> <span class="token class-name">SqlSession</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Configuration</span> configuration<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token class-name">String</span> statement<span class="token punctuation">,</span> <span class="token class-name">Object</span> parameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MappedStatement</span> mappedStatement <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getMappedStatement</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token string">&quot;ä½ è¢«ä»£ç†äº†ï¼&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;\\næ–¹æ³•ï¼š&quot;</span> <span class="token operator">+</span> statement <span class="token operator">+</span> <span class="token string">&quot;\\nå…¥å‚ï¼š&quot;</span> <span class="token operator">+</span> parameter <span class="token operator">+</span> <span class="token string">&quot;\\nå¾…æ‰§è¡ŒSQLï¼š&quot;</span> <span class="token operator">+</span> mappedStatement<span class="token punctuation">.</span><span class="token function">getSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> configuration<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>DefaultSqlSession ç›¸å¯¹äºä¸Šä¸€ç« èŠ‚ï¼Œå°å‚…å“¥è¿™é‡ŒæŠŠ <code>MapperRegistry mapperRegistry</code> æ›¿æ¢ä¸º <code>Configuration configuration</code>ï¼Œè¿™æ ·æ‰èƒ½ä¼ é€’æ›´ä¸°å¯Œçš„ä¿¡æ¯å†…å®¹ï¼Œè€Œä¸åªæ˜¯æ³¨å†Œå™¨æ“ä½œã€‚</li><li>ä¹‹ååœ¨ DefaultSqlSession#selectOneã€DefaultSqlSession#getMapper ä¸¤ä¸ªæ–¹æ³•ä¸­éƒ½ä½¿ç”¨ configuration æ¥è·å–å¯¹åº”çš„ä¿¡æ¯ã€‚</li><li>ç›®å‰ selectOne æ–¹æ³•ä¸­åªæ˜¯æŠŠè·å–çš„ä¿¡æ¯è¿›è¡Œæ‰“å°ï¼Œåç»­å°†å¼•å…¥ SQL æ‰§è¡Œå™¨è¿›è¡Œç»“æœæŸ¥è¯¢å¹¶è¿”å›ã€‚</li></ul><h2 id="äº”ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#äº”ã€æµ‹è¯•" aria-hidden="true">#</a> äº”ã€æµ‹è¯•</h2><h3 id="_1-äº‹å…ˆå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-äº‹å…ˆå‡†å¤‡" aria-hidden="true">#</a> 1. äº‹å…ˆå‡†å¤‡</h3><p>æä¾› DAO æ¥å£å’Œå¯¹åº”çš„ Mapper xml é…ç½®</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUserDao</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">queryUserInfoById</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.bugstack.mybatis.test.dao.IUserDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>queryUserInfoById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.lang.Long<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.bugstack.mybatis.test.po.User<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT id, userId, userHead, createTime
        FROM user
        where id = #{id}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_2-å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 2. å•å…ƒæµ‹è¯•</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_SqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. ä»SqlSessionFactoryä¸­è·å–SqlSession</span>
    <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">&quot;mybatis-config-datasource.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. è·å–æ˜ å°„å™¨å¯¹è±¡</span>
    <span class="token class-name">IUserDao</span> userDao <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">IUserDao</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. æµ‹è¯•éªŒè¯</span>
    <span class="token class-name">String</span> res <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">queryUserInfoById</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœï¼š{}&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç›®å‰çš„ä½¿ç”¨æ–¹å¼å°±å’Œ Mybatis éå¸¸åƒäº†ï¼Œé€šè¿‡åŠ è½½ xml é…ç½®æ–‡ä»¶ï¼Œäº¤ç»™ SqlSessionFactoryBuilder è¿›è¡Œæ„å»ºè§£æï¼Œå¹¶è·å– SqlSessionFactory å·¥å‚ã€‚è¿™æ ·å°±å¯ä»¥é¡ºåˆ©çš„å¼€å¯ Session ä»¥åŠå®Œæˆåç»­çš„æ“ä½œã€‚</li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">07</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">40.519</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token constant">INFO</span>  <span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span></span>ApiTest</span> <span class="token operator">-</span> æµ‹è¯•ç»“æœï¼šä½ è¢«ä»£ç†äº†ï¼
æ–¹æ³•ï¼š<span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>test<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span>IUserDao</span><span class="token punctuation">.</span>queryUserInfoById
å…¥å‚ï¼š<span class="token punctuation">[</span><span class="token class-name">Ljava</span><span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Object<span class="token punctuation">;</span><span class="token annotation punctuation">@23223dd8</span>
å¾…æ‰§è¡Œ<span class="token constant">SQL</span>ï¼š
        <span class="token class-name">SELECT</span> id<span class="token punctuation">,</span> userId<span class="token punctuation">,</span> userHead<span class="token punctuation">,</span> createTime
        <span class="token constant">FROM</span> user
        where id <span class="token operator">=</span> <span class="token operator">?</span>
    

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä»æµ‹è¯•ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰çš„ä»£ç†æ“ä½œå·²ç»å¯ä»¥æŠŠæˆ‘ä»¬ä» XML ä¸­è§£æçš„ SQL ä¿¡æ¯è¿›è¡Œæ‰“å°äº†ï¼Œåç»­æˆ‘ä»¬å°†ç»“åˆè¿™éƒ¨åˆ†çš„å¤„ç†ç»§ç»­å®Œæˆæ•°æ®åº“çš„æ“ä½œã€‚</li></ul><h2 id="å…­ã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å…­ã€æ€»ç»“" aria-hidden="true">#</a> å…­ã€æ€»ç»“</h2><ul><li>äº†è§£ ORM å¤„ç†çš„æ ¸å¿ƒæµç¨‹ï¼ŒçŸ¥æ™“ç›®å‰æˆ‘ä»¬æ‰€å¤„åœ¨çš„æ­¥éª¤å’Œè¦å®Œæˆçš„å†…å®¹ï¼Œåªæœ‰éå¸¸æ¸…æ¥šçš„çŸ¥é“è¿™ä¸ªä»£ç†ã€å°è£…ã€è§£æå’Œè¿”å›ç»“æœçš„è¿‡ç¨‹æ‰èƒ½æ›´å¥½çš„å®Œæˆæ•´ä¸ªæ¡†æ¶çš„å®ç°ã€‚</li><li>SqlSessionFactoryBuilder çš„å¼•å…¥åŒ…è£…äº†æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼šXML æ–‡ä»¶çš„è§£æã€Configuration é…ç½®ç±»çš„å¤„ç†ï¼Œè®© DefaultSqlSession å¯ä»¥æ›´åŠ çµæ´»çš„æ‹¿åˆ°å¯¹åº”çš„ä¿¡æ¯ï¼Œè·å– Mapper å’Œ SQL è¯­å¥ã€‚</li><li>å¦å¤–ä»æ•´ä¸ªå·¥ç¨‹æ­å»ºçš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šå·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€ä»£ç†æ¨¡å¼çš„ä½¿ç”¨ï¼Œä¹Ÿæœ‰å¾ˆå¤šè®¾è®¡åŸåˆ™çš„è¿ç”¨ï¼Œè¿™äº›æŠ€å·§éƒ½å¯ä»¥è®©æ•´ä¸ªå·¥ç¨‹å˜å¾—æ˜“äºç»´æŠ¤å’Œæ˜“äºè¿­ä»£ã€‚<em>è¿™ä¹Ÿæ˜¯ç ”å‘äººå‘˜åœ¨å­¦ä¹ æºç çš„è¿‡ç¨‹ä¸­ï¼Œéå¸¸å€¼å¾—é‡ç‚¹å…³æ³¨çš„åœ°æ–¹ã€‚</em></li></ul><h2 id="ä¸ƒã€ä¼˜ç§€ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€ä¼˜ç§€ä½œä¸š" aria-hidden="true">#</a> ä¸ƒã€ä¼˜ç§€ä½œä¸š</h2>`,52),h={href:"https://t.zsxq.com/08wDxcVV4",target:"_blank",rel:"noopener noreferrer"},f={href:"https://t.zsxq.com/081RvQF4B",target:"_blank",rel:"noopener noreferrer"},y={href:"https://t.zsxq.com/0cWqIjDR6",target:"_blank",rel:"noopener noreferrer"};function S(q,M){const a=p("ExternalLinkIcon");return c(),o("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",d,[s("https://bugstack.cn"),e(a)]),k,s("åŸæ–‡ï¼š"),n("a",m,[s("https://mp.weixin.qq.com/s/C_bb9f1Hr9aJAvbmrDHHig"),e(a)])]),v,b,g,n("ul",null,[n("li",null,[n("a",h,[s("Mapper XMLçš„è§£æå’Œæ³¨å†Œä½¿ç”¨ @liuc"),e(a)])]),n("li",null,[n("a",f,[s("å…¶å®ä¸­å¿ƒç‚¹åœ¨äºConfigurationè¿™ä¸ªç±»ã€‚Resources,XMLConfigBuilderæ˜¯ä¸ºäº†è·å–Configurationåšå‡†å¤‡ã€‚@echo"),e(a)])]),n("li",null,[n("a",y,[s("å®šä¹‰SqlSessionFactoryBuilderå·¥å‚å»ºé€ è€…æ¨¡å¼ç±» @è°åŠ¨äº†æˆ‘çš„è¾£æ¡"),e(a)])])])])}const x=t(i,[["render",S],["__file","2022-04-09-di4zhangï¼šXMLdejiexihezhuceshiyong.html.vue"]]);export{x as default};
