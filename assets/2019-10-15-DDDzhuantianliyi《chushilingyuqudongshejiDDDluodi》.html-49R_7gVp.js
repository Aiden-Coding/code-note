import{_ as t,r as i,o as p,c,a as n,b as s,d as e,e as l}from"./app-3RcBQnkC.js";const o={},u=n("h1",{id:"dddä¸“é¢˜æ¡ˆä¾‹ä¸€ã€Šåˆè¯†é¢†åŸŸé©±åŠ¨è®¾è®¡dddè½åœ°ã€‹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#dddä¸“é¢˜æ¡ˆä¾‹ä¸€ã€Šåˆè¯†é¢†åŸŸé©±åŠ¨è®¾è®¡dddè½åœ°ã€‹","aria-hidden":"true"},"#"),s(" DDDä¸“é¢˜æ¡ˆä¾‹ä¸€ã€Šåˆè¯†é¢†åŸŸé©±åŠ¨è®¾è®¡DDDè½åœ°ã€‹")],-1),r=n("br",null,null,-1),d={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},v=n("br",null,null,-1),k={href:"https://t.zsxq.com/jAi2nUf",target:"_blank",rel:"noopener noreferrer"},m=l(`<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><p>é¢†åŸŸé©±åŠ¨è®¾è®¡DDD{Domain-Driven Design}å†å²è¾ƒé•¿ä½†éšç€å¾®æœåŠ¡çš„å…´èµ·DDDåˆæ´»è·ƒåˆ°äººä»¬çš„è§†çº¿ï¼Œå®ƒæä¾›çš„æ˜¯ä¸€å¥—æ¶æ„è®¾è®¡æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™å¥—æ–¹æ³•è®ºå°†æ¶æ„è®¾è®¡çš„å°½å¯èƒ½åšåˆ°é«˜å†…èšã€ä½è€¦åˆã€å¯æ‰©å±•æ€§å¼ºçš„åº”ç”¨æœåŠ¡ã€‚æœ¬ä¸“é¢˜ä»¥DDDå®æˆ˜è½åœ°ä¸ºæ ¹æœ¬ï¼Œåˆ†ç« èŠ‚è®¾è®¡ä¸åŒçš„æ¶æ„æ¨¡å‹ã€‚å­¦ä¹ å¹¶å®æˆ˜æ˜¯å¥”å…¥åº”ç”¨çº§æœ€å¿«çš„æ–¹æ³•ï¼ŒHi HelloWorldï¼æˆ‘æ¥äº†ã€‚</p><h2 id="å‰è¨€ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#å‰è¨€ä»‹ç»" aria-hidden="true">#</a> å‰è¨€ä»‹ç»</h2><blockquote><p>DDDï¼ˆDomain-Driven Design é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰æ˜¯ç”±Eric Evansæœ€å…ˆæå‡ºï¼Œç›®çš„æ˜¯å¯¹è½¯ä»¶æ‰€æ¶‰åŠåˆ°çš„é¢†åŸŸè¿›è¡Œå»ºæ¨¡ï¼Œä»¥åº”å¯¹ç³»ç»Ÿè§„æ¨¡è¿‡å¤§æ—¶å¼•èµ·çš„è½¯ä»¶å¤æ‚æ€§çš„é—®é¢˜ã€‚æ•´ä¸ªè¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œå¼€å‘å›¢é˜Ÿå’Œé¢†åŸŸä¸“å®¶ä¸€èµ·é€šè¿‡ é€šç”¨è¯­è¨€(Ubiquitous Language)å»ç†è§£å’Œæ¶ˆåŒ–é¢†åŸŸçŸ¥è¯†ï¼Œä»é¢†åŸŸçŸ¥è¯†ä¸­æå–å’Œåˆ’åˆ†ä¸ºä¸€ä¸ªä¸€ä¸ªçš„å­é¢†åŸŸï¼ˆæ ¸å¿ƒå­åŸŸï¼Œé€šç”¨å­åŸŸï¼Œæ”¯æ’‘å­åŸŸï¼‰ï¼Œå¹¶åœ¨å­é¢†åŸŸä¸Šå»ºç«‹æ¨¡å‹ï¼Œå†é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œè¿™æ ·å‘¨è€Œå¤å§‹ï¼Œæ„å»ºå‡ºä¸€å¥—ç¬¦åˆå½“å‰é¢†åŸŸçš„æ¨¡å‹ã€‚</p></blockquote><p><img src="https://bugstack.cn/assets/images/pic-content/2019/10/DDD-01-1.png" alt="å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ &amp; DDDæ¦‚è¿°"></p><p><strong>å¼€å‘ç›®æ ‡</strong></p><p>ä¾é é¢†åŸŸé©±åŠ¨è®¾è®¡çš„è®¾è®¡æ€æƒ³ï¼Œé€šè¿‡äº‹ä»¶é£æš´å»ºç«‹é¢†åŸŸæ¨¡å‹ï¼Œåˆç†åˆ’åˆ†é¢†åŸŸé€»è¾‘å’Œç‰©ç†è¾¹ç•Œï¼Œå»ºç«‹é¢†åŸŸå¯¹è±¡åŠæœåŠ¡çŸ©é˜µå’ŒæœåŠ¡æ¶æ„å›¾ï¼Œå®šä¹‰ç¬¦åˆDDDåˆ†å±‚æ¶æ„æ€æƒ³çš„ä»£ç ç»“æ„æ¨¡å‹ï¼Œä¿è¯ä¸šåŠ¡æ¨¡å‹ä¸ä»£ç æ¨¡å‹çš„ä¸€è‡´æ€§ã€‚é€šè¿‡ä¸Šè¿°è®¾è®¡æ€æƒ³ã€æ–¹æ³•å’Œè¿‡ç¨‹ï¼ŒæŒ‡å¯¼å›¢é˜ŸæŒ‰ç…§DDDè®¾è®¡æ€æƒ³å®Œæˆå¾®æœåŠ¡è®¾è®¡å’Œå¼€å‘ã€‚</p><ol><li>æ‹’ç»æ³¥çƒå°å•ä½“ã€æ‹’ç»æ±¡æŸ“åŠŸèƒ½ä¸æœåŠ¡ã€æ‹’ç»ä¸€åŠ åŠŸèƒ½æ’æœŸä¸€ä¸ªæœˆ</li><li>æ¶æ„å‡ºé«˜å¯ç”¨ææ˜“ç¬¦åˆäº’è”ç½‘é«˜é€Ÿè¿­ä»£çš„åº”ç”¨æœåŠ¡</li><li>ç‰©æ–™åŒ–ã€ç»„è£…åŒ–ã€å¯ç¼–æ’çš„æœåŠ¡ï¼Œæé«˜äººæ•ˆ</li></ol><p><strong>æœåŠ¡æ¶æ„</strong><img src="https://bugstack.cn/assets/images/pic-content/2019/10/DDD-01-2.png" alt="å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ &amp; æœåŠ¡æ¶æ„"></p><ul><li><p>åº”ç”¨å±‚{application}</p><ul><li>åº”ç”¨æœåŠ¡ä½äºåº”ç”¨å±‚ã€‚ç”¨æ¥è¡¨è¿°åº”ç”¨å’Œç”¨æˆ·è¡Œä¸ºï¼Œè´Ÿè´£æœåŠ¡çš„ç»„åˆã€ç¼–æ’å’Œè½¬å‘ï¼Œè´Ÿè´£å¤„ç†ä¸šåŠ¡ç”¨ä¾‹çš„æ‰§è¡Œé¡ºåºä»¥åŠç»“æœçš„æ‹¼è£…ã€‚</li><li>åº”ç”¨å±‚çš„æœåŠ¡åŒ…æ‹¬åº”ç”¨æœåŠ¡å’Œé¢†åŸŸäº‹ä»¶ç›¸å…³æœåŠ¡ã€‚</li><li>åº”ç”¨æœåŠ¡å¯å¯¹å¾®æœåŠ¡å†…çš„é¢†åŸŸæœåŠ¡ä»¥åŠå¾®æœåŠ¡å¤–çš„åº”ç”¨æœåŠ¡è¿›è¡Œç»„åˆå’Œç¼–æ’ï¼Œæˆ–è€…å¯¹åŸºç¡€å±‚å¦‚æ–‡ä»¶ã€ç¼“å­˜ç­‰æ•°æ®ç›´æ¥æ“ä½œå½¢æˆåº”ç”¨æœåŠ¡ï¼Œå¯¹å¤–æä¾›ç²—ç²’åº¦çš„æœåŠ¡ã€‚</li><li>é¢†åŸŸäº‹ä»¶æœåŠ¡åŒ…æ‹¬ä¸¤ç±»ï¼šé¢†åŸŸäº‹ä»¶çš„å‘å¸ƒå’Œè®¢é˜…ã€‚é€šè¿‡äº‹ä»¶æ€»çº¿å’Œæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥æ•°æ®ä¼ è¾“ï¼Œå®ç°å¾®æœåŠ¡ä¹‹é—´çš„è§£è€¦ã€‚</li></ul></li><li><p>é¢†åŸŸå±‚{domain}</p><ul><li>é¢†åŸŸæœåŠ¡ä½äºé¢†åŸŸå±‚ï¼Œä¸ºå®Œæˆé¢†åŸŸä¸­è·¨å®ä½“æˆ–å€¼å¯¹è±¡çš„æ“ä½œè½¬æ¢è€Œå°è£…çš„æœåŠ¡ï¼Œé¢†åŸŸæœåŠ¡ä»¥ä¸å®ä½“å’Œå€¼å¯¹è±¡ç›¸åŒçš„æ–¹å¼å‚ä¸å®æ–½è¿‡ç¨‹ã€‚</li><li>é¢†åŸŸæœåŠ¡å¯¹åŒä¸€ä¸ªå®ä½“çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•è¿›è¡Œç»„åˆå’Œå°è£…ï¼Œæˆ–å¯¹å¤šä¸ªä¸åŒå®ä½“çš„æ“ä½œè¿›è¡Œç»„åˆæˆ–ç¼–æ’ï¼Œå¯¹å¤–æš´éœ²æˆé¢†åŸŸæœåŠ¡ã€‚é¢†åŸŸæœåŠ¡å°è£…äº†æ ¸å¿ƒçš„ä¸šåŠ¡é€»è¾‘ã€‚å®ä½“è‡ªèº«çš„è¡Œä¸ºåœ¨å®ä½“ç±»å†…éƒ¨å®ç°ï¼Œå‘ä¸Šå°è£…æˆé¢†åŸŸæœåŠ¡æš´éœ²ã€‚</li><li>ä¸ºéšè—é¢†åŸŸå±‚çš„ä¸šåŠ¡é€»è¾‘å®ç°ï¼Œæ‰€æœ‰é¢†åŸŸæ–¹æ³•å’ŒæœåŠ¡ç­‰å‡é¡»é€šè¿‡é¢†åŸŸæœåŠ¡å¯¹å¤–æš´éœ²ã€‚</li><li>ä¸ºå®ç°å¾®æœåŠ¡å†…èšåˆä¹‹é—´çš„è§£è€¦ï¼ŒåŸåˆ™ä¸Šç¦æ­¢è·¨èšåˆçš„é¢†åŸŸæœåŠ¡è°ƒç”¨å’Œè·¨èšåˆçš„æ•°æ®ç›¸äº’å…³è”ã€‚</li></ul></li><li><p>åŸºç¡€å±‚{infrastructrue}</p><ul><li>åŸºç¡€æœåŠ¡ä½äºåŸºç¡€å±‚ã€‚ä¸ºå„å±‚æä¾›èµ„æºæœåŠ¡ï¼ˆå¦‚æ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼‰ï¼Œå®ç°å„å±‚çš„è§£è€¦ï¼Œé™ä½å¤–éƒ¨èµ„æºå˜åŒ–å¯¹ä¸šåŠ¡é€»è¾‘çš„å½±å“ã€‚</li><li>åŸºç¡€æœåŠ¡ä¸»è¦ä¸ºä»“å‚¨æœåŠ¡ï¼Œé€šè¿‡ä¾èµ–åè½¬çš„æ–¹å¼ä¸ºå„å±‚æä¾›åŸºç¡€èµ„æºæœåŠ¡ï¼Œé¢†åŸŸæœåŠ¡å’Œåº”ç”¨æœåŠ¡è°ƒç”¨ä»“å‚¨æœåŠ¡æ¥å£ï¼Œåˆ©ç”¨ä»“å‚¨å®ç°æŒä¹…åŒ–æ•°æ®å¯¹è±¡æˆ–ç›´æ¥è®¿é—®åŸºç¡€èµ„æºã€‚</li></ul></li><li><p>æ¥å£å±‚{interfaces}</p><ul><li>æ¥å£æœåŠ¡ä½äºç”¨æˆ·æ¥å£å±‚ï¼Œç”¨äºå¤„ç†ç”¨æˆ·å‘é€çš„Restfulè¯·æ±‚å’Œè§£æç”¨æˆ·è¾“å…¥çš„é…ç½®æ–‡ä»¶ç­‰ï¼Œå¹¶å°†ä¿¡æ¯ä¼ é€’ç»™åº”ç”¨å±‚ã€‚</li></ul></li></ul><h2 id="å¼€å‘ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#å¼€å‘ç¯å¢ƒ" aria-hidden="true">#</a> å¼€å‘ç¯å¢ƒ</h2><ol><li>jdk1.8ã€jdk1.7ä»¥ä¸‹åªèƒ½éƒ¨åˆ†æ”¯æŒnettyã€‘</li><li>springboot 2.0.6.RELEASE</li><li>idea + maven</li></ol><h2 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹" aria-hidden="true">#</a> ä»£ç ç¤ºä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>ddd<span class="token operator">-</span><span class="token number">01</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â”œâ”€â”€ java
    â”‚   â”‚   â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo
    â”‚   â”‚       â”œâ”€â”€ application
    â”‚   â”‚       â”‚	â”œâ”€â”€ event
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ <span class="token class-name">ApplicationRunner</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â””â”€â”€ service
    â”‚   â”‚       â”‚	    â””â”€â”€ <span class="token class-name">UserService</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”œâ”€â”€ domain
    â”‚   â”‚       â”‚	â”œâ”€â”€ model
    â”‚   â”‚       â”‚	â”‚   â”œâ”€â”€ aggregates
    â”‚   â”‚       â”‚	â”‚   â”‚   â””â”€â”€ <span class="token class-name">UserRichInfo</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ vo
    â”‚   â”‚       â”‚	â”‚       â”œâ”€â”€ <span class="token class-name">UserInfo</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”‚       â””â”€â”€ <span class="token class-name">UserSchool</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”œâ”€â”€ repository
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ <span class="token class-name">IuserRepository</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â””â”€â”€ service
    â”‚   â”‚       â”‚	    â””â”€â”€ <span class="token class-name">UserServiceImpl</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”œâ”€â”€ infrastructure
    â”‚   â”‚       â”‚	â”œâ”€â”€ dao
    â”‚   â”‚       â”‚	â”‚   â”œâ”€â”€ impl
    â”‚   â”‚       â”‚	â”‚   â”‚   â””â”€â”€ <span class="token class-name">UserDaoImpl</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ <span class="token class-name">UserDao</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”œâ”€â”€ po
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ <span class="token class-name">UserEntity</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â”œâ”€â”€ repository
    â”‚   â”‚       â”‚	â”‚   â”œâ”€â”€ mysql
    â”‚   â”‚       â”‚	â”‚   â”‚   â””â”€â”€ <span class="token class-name">UserMysqlRepository</span><span class="token punctuation">.</span>java
    â”‚   â”‚       â”‚	â”‚   â”œâ”€â”€ redis
    â”‚   â”‚       â”‚	â”‚   â”‚   â””â”€â”€ <span class="token class-name">UserRedisRepository</span><span class="token punctuation">.</span>java		
    â”‚   â”‚       â”‚	â”‚   â””â”€â”€ <span class="token class-name">UserRepository</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â””â”€â”€ util
    â”‚   â”‚       â”‚	    â””â”€â”€ <span class="token class-name">RdisUtil</span><span class="token punctuation">.</span>java
    â”‚   â”‚       â”œâ”€â”€ interfaces
    â”‚   â”‚       â”‚	â”œâ”€â”€ dto
    â”‚   â”‚       â”‚	â”‚	â””â”€â”€ <span class="token class-name">UserInfoDto</span><span class="token punctuation">.</span>java	
    â”‚   â”‚       â”‚	â””â”€â”€ facade
    â”‚   â”‚       â”‚		â””â”€â”€ <span class="token class-name">DDDController</span><span class="token punctuation">.</span>java
    â”‚   â”‚       â””â”€â”€ <span class="token class-name">DDDApplication</span><span class="token punctuation">.</span>java
    â”‚   â”œâ”€â”€ resources	
    â”‚   â”‚   â””â”€â”€ application<span class="token punctuation">.</span>yml
    â”‚   â””â”€â”€ webapp	
    â”‚       â””â”€â”€ <span class="token constant">WEB</span><span class="token operator">-</span><span class="token constant">INF</span>
    â”‚        	â””â”€â”€ index<span class="token punctuation">.</span>jsp	
    â””â”€â”€ test
         â””â”€â”€ java
             â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>test
                 â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¼”ç¤ºéƒ¨åˆ†é‡ç‚¹ä»£ç å—ï¼Œå®Œæ•´ä»£ç ä¸‹è½½å…³æ³¨å…¬ä¼—å·ï¼›bugstackè™«æ´æ ˆ | å›å¤DDDè½åœ°</strong></p><blockquote><p>application/UserService.java | åº”ç”¨å±‚ç”¨æˆ·æœåŠ¡ï¼Œé¢†åŸŸå±‚æœåŠ¡åšå…·ä½“å®ç°</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åº”ç”¨å±‚ç”¨æˆ·æœåŠ¡
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token class-name">UserRichInfo</span> <span class="token function">queryUserInfoById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>domain/repository/IuserRepository.java | é¢†åŸŸå±‚èµ„æºåº“ï¼Œç”±åŸºç¡€å±‚å®ç°</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUserRepository</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">UserEntity</span> userEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">UserEntity</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>domain/service/UserServiceImpl.java | åº”ç”¨å±‚å®ç°ç±»ï¼Œåº”ç”¨å±‚æ˜¯å¾ˆè–„çš„ä¸€å±‚å¯ä»¥åªåšæœåŠ¡ç¼–æ’</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;userRepository&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">IUserRepository</span> userRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserRichInfo</span> <span class="token function">queryUserInfoById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token comment">// æŸ¥è¯¢èµ„æºåº“</span>
        <span class="token class-name">UserEntity</span> userEntity <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserInfo</span> userInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userInfo<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// TODO æŸ¥è¯¢å­¦æ ¡ä¿¡æ¯ï¼Œå¤–éƒ¨æ¥å£</span>
        <span class="token class-name">UserSchool</span> userSchool_01 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserSchool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userSchool_01<span class="token punctuation">.</span><span class="token function">setSchoolName</span><span class="token punctuation">(</span><span class="token string">&quot;æŒ¯åé«˜çº§å®éªŒä¸­å­¦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserSchool</span> userSchool_02 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserSchool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userSchool_02<span class="token punctuation">.</span><span class="token function">setSchoolName</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸œåŒ—ç”µåŠ›å¤§å­¦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserSchool</span><span class="token punctuation">&gt;</span></span> userSchoolList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userSchoolList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userSchool_01<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userSchoolList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userSchool_02<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserRichInfo</span> userRichInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserRichInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRichInfo<span class="token punctuation">.</span><span class="token function">setUserInfo</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRichInfo<span class="token punctuation">.</span><span class="token function">setUserSchoolList</span><span class="token punctuation">(</span>userSchoolList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> userRichInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>infrastructure/po/UserEntity.java | æ•°æ®åº“å¯¹è±¡ç±»</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ•°æ®åº“å®ä½“å¯¹è±¡ï¼›ç”¨æˆ·å®ä½“
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserEntity</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    get<span class="token operator">/</span>set <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>infrastructrue/repository/UserRepository.java | é¢†åŸŸå±‚å®šä¹‰æ¥å£ï¼ŒåŸºç¡€å±‚èµ„æºåº“å®ç°</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Repository</span><span class="token punctuation">(</span><span class="token string">&quot;userRepository&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRepository</span> <span class="token keyword">implements</span> <span class="token class-name">IUserRepository</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;userMysqlRepository&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">IUserRepository</span> userMysqlRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;userRedisRepository&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">IUserRepository</span> userRedisRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">UserEntity</span> userEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//ä¿å­˜åˆ°DB</span>
        userMysqlRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä¿å­˜åˆ°Redis</span>
        userRedisRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserEntity</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">UserEntity</span> userEntityRedis <span class="token operator">=</span> userRedisRepository<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> userEntityRedis<span class="token punctuation">)</span> <span class="token keyword">return</span> userEntityRedis<span class="token punctuation">;</span>

        <span class="token class-name">UserEntity</span> userEntityMysql <span class="token operator">=</span> userMysqlRepository<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> userEntityMysql<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//ä¿å­˜åˆ°Redis</span>
            userRedisRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>userEntityMysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> userEntityMysql<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æŸ¥è¯¢ä¸ºNULL</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>interfaces/dto/UserInfoDto.java | DTOå¯¹è±¡ç±»ï¼Œéš”ç¦»æ•°æ®åº“ç±»</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfoDto</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>        <span class="token comment">// ID</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>interfaces/facade/DDDController.java | é—¨é¢æ¥å£</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ¬¢è¿å…³æ³¨å¹¶è·å–æ›´å¤šä¸“é¢˜æ¡ˆä¾‹æºç 
 * Create by fuzhengwei on @2019
 */</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DDDController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/user/queryUserInfo&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UserInfoDto</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">queryUserInfoById</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»¼ä¸Šæ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ç»¼ä¸Šæ€»ç»“" aria-hidden="true">#</a> ç»¼ä¸Šæ€»ç»“</h2><ul><li><strong>ä»¥ä¸ŠåŸºäºDDDä¸€ä¸ªåŸºæœ¬å…¥é—¨çš„ç»“æ„æ¼”ç¤ºå®Œæˆï¼Œå®é™…å¼€å‘å¯ä»¥æŒ‰ç…§æ­¤æ¨¡å¼è¿›è¡Œè°ƒæ•´ã€‚</strong></li><li><strong>ç›®å‰è¿™ä¸ªæ¶æ„åˆ†å±‚è¿˜ä¸èƒ½å¾ˆå¥½çš„è¿›è¡Œåˆ†ç¦»ï¼Œä»¥åŠå±‚çº§å…³ç³»çš„å¼•ç”¨è¿˜ä¸åˆ©äºæ‰©å±•ã€‚</strong></li><li><strong>åç»­ä¼šæŒç»­å®Œå–„ä»¥åŠå¯ä»¥ç»„åˆæ­å»ºRPCæ¡†æ¶ç­‰ï¼Œè®©æ•´ä¸ªæ¶æ„æ›´åˆ©äºäº’è”ç½‘å¼€å‘ã€‚</strong></li></ul>`,31),b=n("strong",null,"bugstackè™«æ´æ ˆ",-1),y=n("strong",null,"DDDè½åœ°æ¡ˆä¾‹",-1),g={href:"https://t.zsxq.com/jAi2nUf",target:"_blank",rel:"noopener noreferrer"};function h(f,D){const a=i("ExternalLinkIcon");return p(),c("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",d,[s("https://bugstack.cn"),e(a)]),v,s("DDDé¡¹ç›®ï¼š"),n("a",k,[s("https://t.zsxq.com/jAi2nUf"),e(a)])]),m,n("p",null,[s("å¾®ä¿¡æœç´¢ã€Œ"),b,s("ã€å…¬ä¼—å·ï¼Œå…³æ³¨åå›å¤ã€Œ"),y,s("ã€è·å–æœ¬æ–‡æºç &æ›´å¤šåŸåˆ›ä¸“é¢˜æ¡ˆä¾‹ï¼æ­¤å¤–æ¨èä½ ä¸€ä¸ªå¯ä»¥ä¸Šæ‰‹å®è·µçš„DDDé¡¹ç›®ï¼Œçœ‹çœ‹å¦‚ä½•ä»æµç¨‹ä¸­æç‚¼é¢†åŸŸè®¾è®¡ä»£ç å®ç°ï¼Œåœ¨åº”ç”¨å±‚ã€é¢†åŸŸå±‚ä»¥åŠåŸºç¡€å±‚çš„ä»“å‚¨å®ç°æ˜¯å¦‚ä½•å®Œæˆå¼€å‘å’Œè°ƒç”¨çš„ï¼Œé¡¹ç›®åœ°å€ï¼š"),n("a",g,[s("https://t.zsxq.com/jAi2nUf"),e(a)])])])}const w=t(o,[["render",h],["__file","2019-10-15-DDDzhuantianliyiã€ŠchushilingyuqudongshejiDDDluodiã€‹.html.vue"]]);export{w as default};
