import{_ as t,r as p,o,c,a as n,b as s,d as e,e as l}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"ã€Šspring-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬-6-ç« -æ°”åå±±æ²³-è®¾è®¡ä¸å®ç°èµ„æºåŠ è½½å™¨-ä»spring-xmlè§£æå’Œæ³¨å†Œbeanå¯¹è±¡",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ã€Šspring-æ‰‹æ’¸ä¸“æ ã€‹ç¬¬-6-ç« -æ°”åå±±æ²³-è®¾è®¡ä¸å®ç°èµ„æºåŠ è½½å™¨-ä»spring-xmlè§£æå’Œæ³¨å†Œbeanå¯¹è±¡","aria-hidden":"true"},"#"),s(" ã€ŠSpring æ‰‹æ’¸ä¸“æ ã€‹ç¬¬ 6 ç« ï¼šæ°”åå±±æ²³ï¼Œè®¾è®¡ä¸å®ç°èµ„æºåŠ è½½å™¨ï¼Œä»Spring.xmlè§£æå’Œæ³¨å†ŒBeanå¯¹è±¡")],-1),r=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("br",null,null,-1),v={href:"https://mp.weixin.qq.com/s/GMcHUL7-oB7T0GWKjNC5Ng",target:"_blank",rel:"noopener noreferrer"},m=l(`<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><h2 id="ä¸€ã€å‰è¨€" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€å‰è¨€" aria-hidden="true">#</a> ä¸€ã€å‰è¨€</h2><p><code>ä½ å†™çš„ä»£ç ï¼Œèƒ½æ¥çš„ä½äº§å“åŠ éœ€æ±‚å—ï¼Ÿ</code></p><p>æ¥ï¼Œæ˜¯èƒ½æ¥çš„ï¼Œæ¥å‡ æ¬¡ä¹Ÿè¡Œï¼Œå“ªæ€•å°±ä¸€ä¸ªç±»ä¸€ç‰‡çš„ if...else ä¹Ÿå¯ä»¥ï¼ä½†æ¥å®Œæˆä»€ä¹ˆæ ·å¯å°±ä¸ä¸€å®šäº†ï¼Œä¼šä¸ä¼šå‡ºäº‹æ•…ä¹Ÿä¸æ˜¯èƒ½æ§åˆ¶ä½çš„ã€‚</p><p>é‚£å‡ºäº‹æ•…æ—¶ï¼Œä½ è¯´å› ä¸ºæˆ‘å†™ if...else å¤šäº†å¯¼è‡´ä»£ç çƒ‚äº†ï¼Œä½†å¯æ˜¯ä½ å…ˆåŠ¨çš„æ‰‹å•Šï¼š<code>ä½ è¯´çš„éœ€æ±‚è¿˜å¾—åŠ </code>ã€<code>ä½ è¯´çš„è€æ¿è®©ä¸Šçº¿</code>ã€<code>ä½ è¯´çš„åˆåŒéƒ½ç­¾äº†</code>ï¼Œæ¬ç –ç å†œçš„æˆ‘æ²¡åŠæ³•ï¼Œæ‰ä»¥å †ä»£ç å¹³éœ€æ±‚ï¼Œéœ€æ±‚å¤ªå¤šä¸å¥½æï¼Œæˆ‘æ‰ä»¥æ¬ç –å¹³éœ€æ±‚ï¼<em>è¯¸ä¾¯ä¸æœï¼Œæˆ‘æ‰ä»¥å…µæœè¯¸ä¾¯ï¼Œä½ ä¸æœï¼Œæˆ‘å°±æ‰“åˆ°ä½ æœï¼</em></p><p>ä½†ä»£ç çƒ‚äº†æœ‰æ—¶å€™å¹¶ä¸æ˜¯å› ä¸ºéœ€æ±‚åŠ çš„å¿«ã€ä¹Ÿä¸æ˜¯ç€æ€¥ä¸Šçº¿ã€‚å› ä¸ºå¾€å¾€åœ¨æ‰¿æ¥äº§å“éœ€æ±‚çš„å‰å‡ æ¬¡ï¼Œä¸€ä¸ªåŠŸèƒ½é€»è¾‘çš„è®¾è®¡å¹¶ä¸ä¼šå¤ªå¤æ‚ï¼Œä¹Ÿä¸ä¼šæœ‰å¤šæ€¥è¿«ï¼Œç”šè‡³ä¼šç•™å‡ºè®©ä½ åšè®¾è®¡ã€åšè¯„å®¡ã€åšå¼€å‘çš„æ—¶é—´ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ä»ä¸èƒ½æŠŠä»¥åå¯èƒ½ä¼šå‘ç”Ÿçš„äº‹æƒ…è¯„ä¼°åˆ°éœ€æ±‚é‡Œï¼Œé‚£ä¹ˆå¯¼è‡´ä»£ç çš„æ··ä¹±ä»ä¸€å¼€å§‹å°±å·²ç»åŸ‹ä¸‹äº†ï¼Œä»¥ååªèƒ½è¶Šæ¥è¶Šä¹±ï¼</p><p>æ‰¿æ¥éœ€æ±‚å¹¶èƒ½æŠŠå®ƒåšå¥½ï¼Œè¿™æ¥è‡ªäºå¯¹éœ€æ±‚çš„ç†è§£ï¼Œäº§å“åœºæ™¯å¼€å‘çš„ç»éªŒä»¥åŠå¯¹ä»£ç å®è·µè½åœ°çš„æŠŠæ§èƒ½åŠ›ç­‰ç»¼åˆå¤šæ–¹é¢å› ç´ çš„ç»“æœã€‚å°±åƒä½ ç°åœ¨åšçš„å¼€å‘ä¸­ï¼Œä½ çš„ä»£ç æœ‰å“ªäº›æ˜¯ç»å¸¸å˜åŒ–çš„ï¼Œæœ‰å“ªäº›æ˜¯å›ºå®šé€šç”¨çš„ï¼Œæœ‰å“ªäº›æ˜¯è´Ÿè´£é€»è¾‘æ‹¼è£…çš„ã€æœ‰å“ªäº›æ˜¯æ¥åšæ ¸å¿ƒå®ç°çš„ã€‚é‚£ä¹ˆç°åœ¨å¦‚æœä½ çš„æ ¸å¿ƒå…±ç”¨å±‚åšäº†é¢‘ç¹å˜åŒ–çš„ä¸šåŠ¡å±‚åŒ…è£…ï¼Œé‚£ä¹ˆè‚¯å®šçš„è¯´ï¼Œä½ çš„ä»£ç å³å°†è¶Šæ¥è¶Šä¹±ï¼Œç”šè‡³å¯èƒ½åŸ‹ä¸‹äº‹æ•…çš„é£é™©ï¼</p><p>åœ¨æˆ‘ä»¬å®ç°çš„ Spring æ¡†æ¶ä¸­ï¼Œæ¯ä¸€ä¸ªç« èŠ‚éƒ½ä¼šç»“åˆä¸Šä¸€ç« èŠ‚ç»§ç»­æ‰©å±•åŠŸèƒ½ï¼Œå°±åƒæ¯ä¸€æ¬¡äº§å“éƒ½åœ¨åŠ éœ€æ±‚ä¸€æ ·ï¼Œé‚£ä¹ˆåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­å¯ä»¥æ‰¿ä¸Šå¯ä¸‹çš„å¯¹ç…§å’Œå‚è€ƒï¼Œçœ‹çœ‹æ¯ä¸€ä¸ªæ¨¡å—çš„æ·»åŠ éƒ½æ˜¯ç”¨ä»€ä¹ˆé€»è¾‘å’ŒæŠ€æœ¯ç»†èŠ‚å®ç°çš„ã€‚è¿™äº›å†…å®¹çš„å­¦ä¹ ï¼Œä¼šéå¸¸æœ‰åˆ©äºä½ ä»¥ååœ¨è®¾è®¡å’Œå®ç°ï¼Œè‡ªå·±æ‰¿æ¥äº§å“éœ€æ±‚æ—¶åšçš„å…·ä½“å¼€å‘ï¼Œä»£ç çš„è´¨é‡ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ï¼Œè¶Šæ¥è¶Šæœ‰æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h2 id="äºŒã€ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç›®æ ‡" aria-hidden="true">#</a> äºŒã€ç›®æ ‡</h2><p>åœ¨å®Œæˆ Spring çš„æ¡†æ¶é›å½¢åï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡å•å…ƒæµ‹è¯•è¿›è¡Œæ‰‹åŠ¨æ“ä½œ Bean å¯¹è±¡çš„å®šä¹‰ã€æ³¨å†Œå’Œå±æ€§å¡«å……ï¼Œä»¥åŠæœ€ç»ˆè·å–å¯¹è±¡è°ƒç”¨æ–¹æ³•ã€‚ä½†è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå®é™…ä½¿ç”¨è¿™ä¸ª Spring æ¡†æ¶ï¼Œæ˜¯ä¸å¤ªå¯èƒ½è®©ç”¨æˆ·é€šè¿‡æ‰‹åŠ¨æ–¹å¼åˆ›å»ºçš„ï¼Œè€Œæ˜¯æœ€å¥½èƒ½é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼ç®€åŒ–åˆ›å»ºè¿‡ç¨‹ã€‚éœ€è¦å®Œæˆå¦‚ä¸‹æ“ä½œï¼š</p><p><img src="https://bugstack.cn/assets/images/spring/spring-6-01.png" alt=""></p><ul><li>å¦‚å›¾ä¸­æˆ‘ä»¬éœ€è¦æŠŠæ­¥éª¤ï¼š2ã€3ã€4æ•´åˆåˆ°Springæ¡†æ¶ä¸­ï¼Œé€šè¿‡ Spring é…ç½®æ–‡ä»¶çš„æ–¹å¼å°† Bean å¯¹è±¡å®ä¾‹åŒ–ã€‚</li><li>æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦åœ¨ç°æœ‰çš„ Spring æ¡†æ¶ä¸­ï¼Œæ·»åŠ èƒ½è§£å†³ Spring é…ç½®çš„è¯»å–ã€è§£æã€æ³¨å†ŒBeançš„æ“ä½œã€‚</li></ul><h2 id="ä¸‰ã€è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€è®¾è®¡" aria-hidden="true">#</a> ä¸‰ã€è®¾è®¡</h2><p>ä¾ç…§æœ¬ç« èŠ‚çš„éœ€æ±‚èƒŒæ™¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç°æœ‰çš„ Spring æ¡†æ¶é›å½¢ä¸­æ·»åŠ ä¸€ä¸ªèµ„æºè§£æå™¨ï¼Œä¹Ÿå°±æ˜¯èƒ½è¯»å–classpathã€æœ¬åœ°æ–‡ä»¶å’Œäº‘æ–‡ä»¶çš„é…ç½®å†…å®¹ã€‚è¿™äº›é…ç½®å†…å®¹å°±æ˜¯åƒä½¿ç”¨ Spring æ—¶é…ç½®çš„ Spring.xml ä¸€æ ·ï¼Œé‡Œé¢ä¼šåŒ…æ‹¬ Bean å¯¹è±¡çš„æè¿°å’Œå±æ€§ä¿¡æ¯ã€‚ åœ¨è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯¹é…ç½®æ–‡ä»¶ä¸­çš„ Bean æè¿°ä¿¡æ¯è§£æåè¿›è¡Œæ³¨å†Œæ“ä½œï¼ŒæŠŠ Bean å¯¹è±¡æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚æ•´ä½“è®¾è®¡ç»“æ„å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://bugstack.cn/assets/images/spring/spring-6-02.png" alt=""></p><ul><li>èµ„æºåŠ è½½å™¨å±äºç›¸å¯¹ç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œå®ƒä½äº Spring æ¡†æ¶æ ¸å¿ƒåŒ…ä¸‹çš„IOå®ç°å†…å®¹ï¼Œä¸»è¦ç”¨äºå¤„ç†Classã€æœ¬åœ°å’Œäº‘ç¯å¢ƒä¸­çš„æ–‡ä»¶ä¿¡æ¯ã€‚</li><li>å½“èµ„æºå¯ä»¥åŠ è½½åï¼Œæ¥ä¸‹æ¥å°±æ˜¯è§£æå’Œæ³¨å†Œ Bean åˆ° Spring ä¸­çš„æ“ä½œï¼Œè¿™éƒ¨åˆ†å®ç°éœ€è¦å’Œ DefaultListableBeanFactory æ ¸å¿ƒç±»ç»“åˆèµ·æ¥ï¼Œå› ä¸ºä½ æ‰€æœ‰çš„è§£æåçš„æ³¨å†ŒåŠ¨ä½œï¼Œéƒ½ä¼šæŠŠ Bean å®šä¹‰ä¿¡æ¯æ”¾å…¥åˆ°è¿™ä¸ªç±»ä¸­ã€‚</li><li>é‚£ä¹ˆåœ¨å®ç°çš„æ—¶å€™å°±è®¾è®¡å¥½æ¥å£çš„å®ç°å±‚çº§å…³ç³»ï¼ŒåŒ…æ‹¬æˆ‘ä»¬éœ€è¦å®šä¹‰å‡º Bean å®šä¹‰çš„è¯»å–æ¥å£ <code>BeanDefinitionReader</code> ä»¥åŠåšå¥½å¯¹åº”çš„å®ç°ç±»ï¼Œåœ¨å®ç°ç±»ä¸­å®Œæˆå¯¹ Bean å¯¹è±¡çš„è§£æå’Œæ³¨å†Œã€‚</li></ul><h2 id="å››ã€å®ç°" tabindex="-1"><a class="header-anchor" href="#å››ã€å®ç°" aria-hidden="true">#</a> å››ã€å®ç°</h2><h3 id="_1-å·¥ç¨‹ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-å·¥ç¨‹ç»“æ„" aria-hidden="true">#</a> 1. å·¥ç¨‹ç»“æ„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>small<span class="token operator">-</span>spring<span class="token operator">-</span>step<span class="token operator">-</span><span class="token number">05</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>springframework  
    â”‚           â”œâ”€â”€ beans
    â”‚           â”‚   â”œâ”€â”€ factory
    â”‚           â”‚   â”‚   â”œâ”€â”€ config
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AutowireCapableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanDefinition</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanReference</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ <span class="token class-name">SingletonBeanRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ support
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AbstractAutowireCapableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AbstractBeanDefinitionReader</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">AbstractBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanDefinitionReader</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanDefinitionRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">CglibSubclassingInstantiationStrategy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">DefaultSingletonBeanRegistry</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">InstantiationStrategy</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ <span class="token class-name">SimpleInstantiationStrategy</span><span class="token punctuation">.</span>java  
    â”‚           â”‚   â”‚   â”œâ”€â”€ xml
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">BeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â”œâ”€â”€ <span class="token class-name">HierarchicalBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”‚   â””â”€â”€ <span class="token class-name">ListableBeanFactory</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">BeansException</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">PropertyValue</span><span class="token punctuation">.</span>java
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">PropertyValues</span><span class="token punctuation">.</span>java 
    â”‚           â”œâ”€â”€ core<span class="token punctuation">.</span>io
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">ClassPathResource</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">FileSystemResource</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">Resource</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â”œâ”€â”€ <span class="token class-name">ResourceLoader</span><span class="token punctuation">.</span>java 
    â”‚           â”‚   â””â”€â”€ <span class="token class-name">UrlResource</span><span class="token punctuation">.</span>java
    â”‚           â””â”€â”€ utils
    â”‚               â””â”€â”€ <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span>java
    â””â”€â”€ test
        â””â”€â”€ java
            â””â”€â”€ cn<span class="token punctuation">.</span>bugstack<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test
                â”œâ”€â”€ bean
                â”‚   â”œâ”€â”€ <span class="token class-name">UserDao</span><span class="token punctuation">.</span>java
                â”‚   â””â”€â”€ <span class="token class-name">UserService</span><span class="token punctuation">.</span>java
                â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å·¥ç¨‹æºç </strong>ï¼š<code>å…¬ä¼—å·ã€Œbugstackè™«æ´æ ˆã€ï¼Œå›å¤ï¼šSpring ä¸“æ ï¼Œè·å–å®Œæ•´æºç </code></p><p>Spring Bean å®¹å™¨èµ„æºåŠ è½½å’Œä½¿ç”¨ç±»å…³ç³»ï¼Œå¦‚å›¾ 6-3</p><p><img src="https://bugstack.cn/assets/images/spring/spring-6-03.png" alt="å›¾ 6-3"></p><ul><li>æœ¬ç« èŠ‚ä¸ºäº†èƒ½æŠŠ Bean çš„å®šä¹‰ã€æ³¨å†Œå’Œåˆå§‹åŒ–äº¤ç»™ Spring.xml é…ç½®åŒ–å¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å®ç°ä¸¤å¤§å—å†…å®¹ï¼Œåˆ†åˆ«æ˜¯ï¼šèµ„æºåŠ è½½å™¨ã€xmlèµ„æºå¤„ç†ç±»ï¼Œå®ç°è¿‡ç¨‹ä¸»è¦ä»¥å¯¹æ¥å£ <code>Resource</code>ã€<code>ResourceLoader</code> çš„å®ç°ï¼Œè€Œå¦å¤– <code>BeanDefinitionReader</code> æ¥å£åˆ™æ˜¯å¯¹èµ„æºçš„å…·ä½“ä½¿ç”¨ï¼Œå°†é…ç½®ä¿¡æ¯æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­å»ã€‚</li><li>åœ¨ Resource çš„èµ„æºåŠ è½½å™¨çš„å®ç°ä¸­åŒ…æ‹¬äº†ï¼ŒClassPathã€ç³»ç»Ÿæ–‡ä»¶ã€äº‘é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸‰éƒ¨åˆ†ä¸ Spring æºç ä¸­çš„è®¾è®¡å’Œå®ç°ä¿æŒä¸€è‡´ï¼Œæœ€ç»ˆåœ¨ DefaultResourceLoader ä¸­åšå…·ä½“çš„è°ƒç”¨ã€‚</li><li>æ¥å£ï¼šBeanDefinitionReaderã€æŠ½è±¡ç±»ï¼šAbstractBeanDefinitionReaderã€å®ç°ç±»ï¼šXmlBeanDefinitionReaderï¼Œè¿™ä¸‰éƒ¨åˆ†å†…å®¹ä¸»è¦æ˜¯åˆç†æ¸…æ™°çš„å¤„ç†äº†èµ„æºè¯»å–åçš„æ³¨å†Œ Bean å®¹å™¨æ“ä½œã€‚<em>æ¥å£ç®¡å®šä¹‰ï¼ŒæŠ½è±¡ç±»å¤„ç†éæ¥å£åŠŸèƒ½å¤–çš„æ³¨å†ŒBeanç»„ä»¶å¡«å……ï¼Œæœ€ç»ˆå®ç°ç±»å³å¯åªå…³å¿ƒå…·ä½“çš„ä¸šåŠ¡å®ç°</em></li></ul><p>å¦å¤–æœ¬ç« èŠ‚è¿˜å‚è€ƒ Spring æºç ï¼Œåšäº†ç›¸åº”æ¥å£çš„é›†æˆå’Œå®ç°çš„å…³ç³»ï¼Œè™½ç„¶è¿™äº›æ¥å£ç›®å‰è¿˜å¹¶æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼Œä½†éšç€æ¡†æ¶çš„é€æ­¥å®Œå–„ï¼Œå®ƒä»¬ä¹Ÿä¼šå‘æŒ¥ä½œç”¨ã€‚å¦‚å›¾ 6-4</p><p><img src="https://bugstack.cn/assets/images/spring/spring-6-04.png" alt="å›¾ 6-4"></p><ul><li>BeanFactoryï¼Œå·²ç»å­˜åœ¨çš„ Bean å·¥å‚æ¥å£ç”¨äºè·å– Bean å¯¹è±¡ï¼Œè¿™æ¬¡æ–°å¢åŠ äº†æŒ‰ç…§ç±»å‹è·å– Bean çš„æ–¹æ³•ï¼š<code>&lt;T&gt; T getBean(String name, Class&lt;T&gt; requiredType)</code></li><li>ListableBeanFactoryï¼Œæ˜¯ä¸€ä¸ªæ‰©å±• Bean å·¥å‚æ¥å£çš„æ¥å£ï¼Œæ–°å¢åŠ äº† <code>getBeansOfType</code>ã€<code>getBeanDefinitionNames()</code> æ–¹æ³•ï¼Œåœ¨ Spring æºç ä¸­è¿˜æœ‰å…¶ä»–æ‰©å±•æ–¹æ³•ã€‚</li><li>HierarchicalBeanFactoryï¼Œåœ¨ Spring æºç ä¸­å®ƒæä¾›äº†å¯ä»¥è·å–çˆ¶ç±» BeanFactory æ–¹æ³•ï¼Œå±äºæ˜¯ä¸€ç§æ‰©å±•å·¥å‚çš„å±‚æ¬¡å­æ¥å£ã€‚<em>Sub-interface implemented by bean factories that can be part of a hierarchy.</em></li><li>AutowireCapableBeanFactoryï¼Œæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å¤„ç†Beanå·¥å‚é…ç½®çš„æ¥å£ï¼Œç›®å‰æ¡ˆä¾‹å·¥ç¨‹ä¸­è¿˜æ²¡æœ‰åšç›¸åº”çš„å®ç°ï¼Œåç»­é€æ­¥å®Œå–„ã€‚</li><li>ConfigurableBeanFactoryï¼Œå¯è·å– BeanPostProcessorã€BeanClassLoaderç­‰çš„ä¸€ä¸ªé…ç½®åŒ–æ¥å£ã€‚</li><li>ConfigurableListableBeanFactoryï¼Œæä¾›åˆ†æå’Œä¿®æ”¹Beanä»¥åŠé¢„å…ˆå®ä¾‹åŒ–çš„æ“ä½œæ¥å£ï¼Œä¸è¿‡ç›®å‰åªæœ‰ä¸€ä¸ª getBeanDefinition æ–¹æ³•ã€‚</li></ul><h3 id="_2-èµ„æºåŠ è½½æ¥å£å®šä¹‰å’Œå®ç°" tabindex="-1"><a class="header-anchor" href="#_2-èµ„æºåŠ è½½æ¥å£å®šä¹‰å’Œå®ç°" aria-hidden="true">#</a> 2. èµ„æºåŠ è½½æ¥å£å®šä¹‰å’Œå®ç°</h3><p><strong>cn.bugstack.springframework.core.io.Resource</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Resource</span> <span class="token punctuation">{</span>

    <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ Spring æ¡†æ¶ä¸‹åˆ›å»º core.io æ ¸å¿ƒåŒ…ï¼Œåœ¨è¿™ä¸ªåŒ…ä¸­ä¸»è¦ç”¨äºå¤„ç†èµ„æºåŠ è½½æµã€‚</li><li>å®šä¹‰ Resource æ¥å£ï¼Œæä¾›è·å– InputStream æµçš„æ–¹æ³•ï¼Œæ¥ä¸‹æ¥å†åˆ†åˆ«å®ç°ä¸‰ç§ä¸åŒçš„æµæ–‡ä»¶æ“ä½œï¼šclassPathã€FileSystemã€URL</li></ul><p><strong>ClassPath</strong>ï¼šcn.bugstack.springframework.core.io.ClassPathResource</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassPathResource</span> <span class="token keyword">implements</span> <span class="token class-name">Resource</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> path<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">)</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">,</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">&quot;Path must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>path <span class="token operator">=</span> path<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>classLoader <span class="token operator">=</span> <span class="token punctuation">(</span>classLoader <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> classLoader <span class="token operator">:</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>is <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">FileNotFoundException</span><span class="token punctuation">(</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>path <span class="token operator">+</span> <span class="token string">&quot; cannot be opened because it does not exist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> is<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸€éƒ¨åˆ†çš„å®ç°æ˜¯ç”¨äºé€šè¿‡ <code>ClassLoader</code> è¯»å–<code> ClassPath</code> ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼Œå…·ä½“çš„è¯»å–è¿‡ç¨‹ä¸»è¦æ˜¯ï¼š<code>classLoader.getResourceAsStream(path)</code></li></ul><p><strong>FileSystem</strong>ï¼šcn.bugstack.springframework.core.io.FileSystemResource</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileSystemResource</span> <span class="token keyword">implements</span> <span class="token class-name">Resource</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">File</span> file<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> path<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>file <span class="token operator">=</span> file<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>path <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>path <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€šè¿‡æŒ‡å®šæ–‡ä»¶è·¯å¾„çš„æ–¹å¼è¯»å–æ–‡ä»¶ä¿¡æ¯ï¼Œè¿™éƒ¨åˆ†å¤§å®¶è‚¯å®šè¿˜æ˜¯éå¸¸ç†Ÿæ‚‰çš„ï¼Œç»å¸¸ä¼šè¯»å–ä¸€äº›txtã€excelæ–‡ä»¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</li></ul><p><strong>Url</strong>ï¼šcn.bugstack.springframework.core.io.UrlResource</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UrlResource</span> <span class="token keyword">implements</span> <span class="token class-name">Resource</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">URL</span> url<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span><span class="token class-name">URL</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token string">&quot;URL must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">URLConnection</span> con <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">openConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>con <span class="token keyword">instanceof</span> <span class="token class-name">HttpURLConnection</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpURLConnection</span><span class="token punctuation">)</span> con<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€šè¿‡ HTTP çš„æ–¹å¼è¯»å–äº‘æœåŠ¡çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠé…ç½®æ–‡ä»¶æ”¾åˆ° GitHub æˆ–è€… Gitee ä¸Šã€‚</li></ul><h3 id="_3-åŒ…è£…èµ„æºåŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_3-åŒ…è£…èµ„æºåŠ è½½å™¨" aria-hidden="true">#</a> 3. åŒ…è£…èµ„æºåŠ è½½å™¨</h3><p>æŒ‰ç…§èµ„æºåŠ è½½çš„ä¸åŒæ–¹å¼ï¼Œèµ„æºåŠ è½½å™¨å¯ä»¥æŠŠè¿™äº›æ–¹å¼é›†ä¸­åˆ°ç»Ÿä¸€çš„ç±»æœåŠ¡ä¸‹è¿›è¡Œå¤„ç†ï¼Œå¤–éƒ¨ç”¨æˆ·åªéœ€è¦ä¼ é€’èµ„æºåœ°å€å³å¯ï¼Œç®€åŒ–ä½¿ç”¨ã€‚</p><p><strong>å®šä¹‰æ¥å£</strong>ï¼šcn.bugstack.springframework.core.io.ResourceLoader</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * Pseudo URL prefix for loading from the class path: &quot;classpath:&quot;
     */</span>
    <span class="token class-name">String</span> <span class="token constant">CLASSPATH_URL_PREFIX</span> <span class="token operator">=</span> <span class="token string">&quot;classpath:&quot;</span><span class="token punctuation">;</span>

    <span class="token class-name">Resource</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å®šä¹‰è·å–èµ„æºæ¥å£ï¼Œé‡Œé¢ä¼ é€’ location åœ°å€å³å¯ã€‚</li></ul><p><strong>å®ç°æ¥å£</strong>ï¼šcn.bugstack.springframework.core.io.DefaultResourceLoader</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultResourceLoader</span> <span class="token keyword">implements</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Resource</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token string">&quot;Location must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_URL_PREFIX</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MalformedURLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨è·å–èµ„æºçš„å®ç°ä¸­ï¼Œä¸»è¦æ˜¯æŠŠä¸‰ç§ä¸åŒç±»å‹çš„èµ„æºå¤„ç†æ–¹å¼è¿›è¡Œäº†åŒ…è£…ï¼Œåˆ†ä¸ºï¼šåˆ¤æ–­æ˜¯å¦ä¸ºClassPathã€URLä»¥åŠæ–‡ä»¶ã€‚</li><li>è™½ç„¶ DefaultResourceLoader ç±»å®ç°çš„è¿‡ç¨‹ç®€å•ï¼Œä½†è¿™ä¹Ÿæ˜¯è®¾è®¡æ¨¡å¼çº¦å®šçš„å…·ä½“ç»“æœï¼Œåƒæ˜¯è¿™é‡Œä¸ä¼šè®©å¤–éƒ¨è°ƒç”¨æ”¾çŸ¥é“è¿‡å¤šçš„ç»†èŠ‚ï¼Œè€Œæ˜¯ä»…å…³å¿ƒå…·ä½“è°ƒç”¨ç»“æœå³å¯ã€‚</li></ul><h3 id="_4-beanå®šä¹‰è¯»å–æ¥å£" tabindex="-1"><a class="header-anchor" href="#_4-beanå®šä¹‰è¯»å–æ¥å£" aria-hidden="true">#</a> 4. Beanå®šä¹‰è¯»å–æ¥å£</h3><p><strong>cn.bugstack.springframework.beans.factory.support.BeanDefinitionReader</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanDefinitionReader</span> <span class="token punctuation">{</span>

    <span class="token class-name">BeanDefinitionRegistry</span> <span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ResourceLoader</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> resources<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™æ˜¯ä¸€ä¸ª <em>Simple interface for bean definition readers.</em> å…¶å®é‡Œé¢æ— éå®šä¹‰äº†å‡ ä¸ªæ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼šgetRegistry()ã€getResourceLoader()ï¼Œä»¥åŠä¸‰ä¸ªåŠ è½½Beanå®šä¹‰çš„æ–¹æ³•ã€‚</li><li>è¿™é‡Œéœ€è¦æ³¨æ„ getRegistry()ã€getResourceLoader()ï¼Œéƒ½æ˜¯ç”¨äºæä¾›ç»™åé¢ä¸‰ä¸ªæ–¹æ³•çš„å·¥å…·ï¼ŒåŠ è½½å’Œæ³¨å†Œï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ä¼šåŒ…è£…åˆ°æŠ½è±¡ç±»ä¸­ï¼Œä»¥å…æ±¡æŸ“å…·ä½“çš„æ¥å£å®ç°æ–¹æ³•ã€‚</li></ul><h3 id="_5-beanå®šä¹‰æŠ½è±¡ç±»å®ç°" tabindex="-1"><a class="header-anchor" href="#_5-beanå®šä¹‰æŠ½è±¡ç±»å®ç°" aria-hidden="true">#</a> 5. Beanå®šä¹‰æŠ½è±¡ç±»å®ç°</h3><p><strong>cn.bugstack.springframework.beans.factory.support.AbstractBeanDefinitionReader</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractBeanDefinitionReader</span> <span class="token keyword">implements</span> <span class="token class-name">BeanDefinitionReader</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token class-name">AbstractBeanDefinitionReader</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">AbstractBeanDefinitionReader</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">,</span> <span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>registry <span class="token operator">=</span> registry<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">=</span> resourceLoader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanDefinitionRegistry</span> <span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> registry<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ResourceLoader</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> resourceLoader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æŠ½è±¡ç±»æŠŠ BeanDefinitionReader æ¥å£çš„å‰ä¸¤ä¸ªæ–¹æ³•å…¨éƒ¨å®ç°å®Œäº†ï¼Œå¹¶æä¾›äº†æ„é€ å‡½æ•°ï¼Œè®©å¤–éƒ¨çš„è°ƒç”¨ä½¿ç”¨æ–¹ï¼ŒæŠŠBeanå®šä¹‰æ³¨å…¥ç±»ï¼Œä¼ é€’è¿›æ¥ã€‚</li><li>è¿™æ ·åœ¨æ¥å£ BeanDefinitionReader çš„å…·ä½“å®ç°ç±»ä¸­ï¼Œå°±å¯ä»¥æŠŠè§£æåçš„ XML æ–‡ä»¶ä¸­çš„ Bean ä¿¡æ¯ï¼Œæ³¨å†Œåˆ° Spring å®¹å™¨å»äº†ã€‚<em>ä»¥å‰æˆ‘ä»¬æ˜¯é€šè¿‡å•å…ƒæµ‹è¯•ä½¿ç”¨ï¼Œè°ƒç”¨ BeanDefinitionRegistry å®ŒæˆBeançš„æ³¨å†Œï¼Œç°åœ¨å¯ä»¥æ”¾åˆ° XMl ä¸­æ“ä½œäº†</em></li></ul><h3 id="_6-è§£æxmlå¤„ç†beanæ³¨å†Œ" tabindex="-1"><a class="header-anchor" href="#_6-è§£æxmlå¤„ç†beanæ³¨å†Œ" aria-hidden="true">#</a> 6. è§£æXMLå¤„ç†Beanæ³¨å†Œ</h3><p><strong>cn.bugstack.springframework.beans.factory.xml.XmlBeanDefinitionReader</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XmlBeanDefinitionReader</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBeanDefinitionReader</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">,</span> <span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> resourceLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">doLoadBeanDefinitions</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeansException</span><span class="token punctuation">(</span><span class="token string">&quot;IOException parsing XML document from &quot;</span> <span class="token operator">+</span> resource<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> resources<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> resource <span class="token operator">:</span> resources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ResourceLoader</span> resourceLoader <span class="token operator">=</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Resource</span> resource <span class="token operator">=</span> resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doLoadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token class-name">XmlUtil</span><span class="token punctuation">.</span><span class="token function">readXML</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Element</span> root <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getDocumentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">NodeList</span> childNodes <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> childNodes<span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ¤æ–­å…ƒç´ </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Element</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token comment">// åˆ¤æ–­å¯¹è±¡</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;bean&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            
            <span class="token comment">// è§£ææ ‡ç­¾</span>
            <span class="token class-name">Element</span> bean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">)</span> childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> id <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> className <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;class&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è·å– Classï¼Œæ–¹ä¾¿è·å–ç±»ä¸­çš„åç§°</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ä¼˜å…ˆçº§ id &gt; name</span>
            <span class="token class-name">String</span> beanName <span class="token operator">=</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">?</span> id <span class="token operator">:</span> name<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                beanName <span class="token operator">=</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">lowerFirst</span><span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// å®šä¹‰Bean</span>
            <span class="token class-name">BeanDefinition</span> beanDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è¯»å–å±æ€§å¹¶å¡«å……</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> bean<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Element</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;property&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token comment">// è§£ææ ‡ç­¾ï¼šproperty</span>
                <span class="token class-name">Element</span> property <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">)</span> bean<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> attrName <span class="token operator">=</span> property<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> attrValue <span class="token operator">=</span> property<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> attrRef <span class="token operator">=</span> property<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;ref&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è·å–å±æ€§å€¼ï¼šå¼•å…¥å¯¹è±¡ã€å€¼å¯¹è±¡</span>
                <span class="token class-name">Object</span> value <span class="token operator">=</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>attrRef<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">BeanReference</span><span class="token punctuation">(</span>attrRef<span class="token punctuation">)</span> <span class="token operator">:</span> attrValue<span class="token punctuation">;</span>
                <span class="token comment">// åˆ›å»ºå±æ€§ä¿¡æ¯</span>
                <span class="token class-name">PropertyValue</span> propertyValue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                beanDefinition<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPropertyValue</span><span class="token punctuation">(</span>propertyValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">containsBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeansException</span><span class="token punctuation">(</span><span class="token string">&quot;Duplicate beanName[&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span> <span class="token string">&quot;] is not allowed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// æ³¨å†Œ BeanDefinition</span>
            <span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>XmlBeanDefinitionReader ç±»æœ€æ ¸å¿ƒçš„å†…å®¹å°±æ˜¯å¯¹ XML æ–‡ä»¶çš„è§£æï¼ŒæŠŠæˆ‘ä»¬æœ¬æ¥åœ¨ä»£ç ä¸­çš„æ“ä½œæ”¾åˆ°äº†é€šè¿‡è§£æ XML è‡ªåŠ¨æ³¨å†Œçš„æ–¹å¼ã€‚</p><ul><li>loadBeanDefinitions æ–¹æ³•ï¼Œå¤„ç†èµ„æºåŠ è½½ï¼Œè¿™é‡Œæ–°å¢åŠ äº†ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ï¼š<code>doLoadBeanDefinitions</code>ï¼Œå®ƒä¸»è¦è´Ÿè´£è§£æ xml</li><li>åœ¨ doLoadBeanDefinitions æ–¹æ³•ä¸­ï¼Œä¸»è¦æ˜¯å¯¹xmlçš„è¯»å– <code>XmlUtil.readXML(inputStream)</code> å’Œå…ƒç´  Element è§£æã€‚åœ¨è§£æçš„è¿‡ç¨‹ä¸­é€šè¿‡å¾ªç¯æ“ä½œï¼Œä»¥æ­¤è·å– Bean é…ç½®ä»¥åŠé…ç½®ä¸­çš„ idã€nameã€classã€valueã€ref ä¿¡æ¯ã€‚</li><li>æœ€ç»ˆæŠŠè¯»å–å‡ºæ¥çš„é…ç½®ä¿¡æ¯ï¼Œåˆ›å»ºæˆ BeanDefinition ä»¥åŠ PropertyValueï¼Œæœ€ç»ˆæŠŠå®Œæ•´çš„ Bean å®šä¹‰å†…å®¹æ³¨å†Œåˆ° Bean å®¹å™¨ï¼š<code>getRegistry().registerBeanDefinition(beanName, beanDefinition)</code></li></ul><h2 id="äº”ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#äº”ã€æµ‹è¯•" aria-hidden="true">#</a> äº”ã€æµ‹è¯•</h2><h3 id="_1-äº‹å…ˆå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-äº‹å…ˆå‡†å¤‡" aria-hidden="true">#</a> 1. äº‹å…ˆå‡†å¤‡</h3><p><strong>cn.bugstack.springframework.test.bean.UserDao</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å‚…å“¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10002&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å…«æ¯æ°´&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;10003&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é˜¿æ¯›&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queryUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>cn.bugstack.springframework.test.bean.UserService</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> uId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">queryUserName</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...get/set</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Daoã€Serviceï¼Œæ˜¯æˆ‘ä»¬å¹³å¸¸å¼€å‘ç»å¸¸ä½¿ç”¨çš„åœºæ™¯ã€‚åœ¨ UserService ä¸­æ³¨å…¥ UserDaoï¼Œè¿™æ ·å°±èƒ½ä½“ç°å‡ºBeanå±æ€§çš„ä¾èµ–äº†ã€‚</li></ul><h3 id="_2-é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 2. é…ç½®æ–‡ä»¶</h3><p><strong>important.properties</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code># <span class="token class-name">Config</span> <span class="token class-name">File</span>
system<span class="token punctuation">.</span>key<span class="token operator">=</span><span class="token class-name">OLpj9823dZ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>spring.xml</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDao<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.bugstack.springframework.test.bean.UserDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.bugstack.springframework.test.bean.UserService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>uId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10001<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDao<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™é‡Œæœ‰ä¸¤ä»½é…ç½®æ–‡ä»¶ï¼Œä¸€ä»½ç”¨äºæµ‹è¯•èµ„æºåŠ è½½å™¨ï¼Œå¦å¤– spring.xml ç”¨äºæµ‹è¯•æ•´ä½“çš„ Bean æ³¨å†ŒåŠŸèƒ½ã€‚</li></ul><h3 id="_3-å•å…ƒæµ‹è¯•-èµ„æºåŠ è½½" tabindex="-1"><a class="header-anchor" href="#_3-å•å…ƒæµ‹è¯•-èµ„æºåŠ è½½" aria-hidden="true">#</a> 3. å•å…ƒæµ‹è¯•(èµ„æºåŠ è½½)</h3><p><strong>æ¡ˆä¾‹</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">DefaultResourceLoader</span> resourceLoader<span class="token punctuation">;</span>      

<span class="token annotation punctuation">@Before</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    resourceLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>   

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_classpath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Resource</span> resource <span class="token operator">=</span> resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:important.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">readUtf8</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>   

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Resource</span> resource <span class="token operator">=</span> resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;src/test/resources/important.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">readUtf8</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>    

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç½‘ç»œåŸå› å¯èƒ½å¯¼è‡´GitHubä¸èƒ½è¯»å–ï¼Œå¯ä»¥æ”¾åˆ°è‡ªå·±çš„Giteeä»“åº“ã€‚è¯»å–åå¯ä»¥ä»å†…å®¹ä¸­æœç´¢å…³é”®å­—ï¼›OLpj9823dZ</span>
    <span class="token class-name">Resource</span> resource <span class="token operator">=</span> resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;https://github.com/fuzhengwei/small-spring/blob/main/important.properties&quot;</span><span class="token punctuation">)</span> 
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">readUtf8</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code># <span class="token class-name">Config</span> <span class="token class-name">File</span>
system<span class="token punctuation">.</span>key<span class="token operator">=</span><span class="token class-name">OLpj9823dZ</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸‰ä¸ªæ–¹æ³•ï¼štest_classpathã€test_fileã€test_urlï¼Œåˆ†åˆ«ç”¨äºæµ‹è¯•åŠ è½½ ClassPathã€FileSystemã€Url æ–‡ä»¶ï¼Œ<em>URLæ–‡ä»¶åœ¨Githubï¼Œå¯èƒ½åŠ è½½æ—¶ä¼šæ…¢</em></li></ul><h3 id="_4-å•å…ƒæµ‹è¯•-é…ç½®æ–‡ä»¶æ³¨å†Œbean" tabindex="-1"><a class="header-anchor" href="#_4-å•å…ƒæµ‹è¯•-é…ç½®æ–‡ä»¶æ³¨å†Œbean" aria-hidden="true">#</a> 4. å•å…ƒæµ‹è¯•(é…ç½®æ–‡ä»¶æ³¨å†ŒBean)</h3><p><strong>æ¡ˆä¾‹</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_xml</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.åˆå§‹åŒ– BeanFactory</span>
    <span class="token class-name">DefaultListableBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. è¯»å–é…ç½®æ–‡ä»¶&amp;æ³¨å†ŒBean</span>
    <span class="token class-name">XmlBeanDefinitionReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:spring.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. è·å–Beanå¯¹è±¡è°ƒç”¨æ–¹æ³•</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">,</span> <span class="token class-name">UserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> result <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•ç»“æœï¼š&quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>æµ‹è¯•ç»“æœï¼šå°å‚…å“¥

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨ä¸Šé¢çš„æµ‹è¯•æ¡ˆä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠä»¥å‰é€šè¿‡æ‰‹åŠ¨æ³¨å†Œ Bean ä»¥åŠé…ç½®å±æ€§ä¿¡æ¯çš„å†…å®¹ï¼Œäº¤ç»™äº† <code>new XmlBeanDefinitionReader(beanFactory)</code> ç±»è¯»å– Spring.xml çš„æ–¹å¼æ¥å¤„ç†ï¼Œå¹¶é€šè¿‡äº†æµ‹è¯•éªŒè¯ã€‚</li></ul><h2 id="å…­ã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å…­ã€æ€»ç»“" aria-hidden="true">#</a> å…­ã€æ€»ç»“</h2><ul><li>æ­¤æ—¶çš„å·¥ç¨‹ç»“æ„å·²ç»è¶Šæ¥è¶Šæœ‰ Spring æ¡†æ¶çš„å‘³é“äº†ï¼Œä»¥é…ç½®æ–‡ä»¶ä¸ºå…¥å£è§£æå’Œæ³¨å†Œ Bean ä¿¡æ¯ï¼Œæœ€ç»ˆå†é€šè¿‡ Bean å·¥å‚è·å– Bean ä»¥åŠåšç›¸åº”çš„è°ƒç”¨æ“ä½œã€‚</li><li>å…³äºæ¡ˆä¾‹ä¸­æ¯ä¸€ä¸ªæ­¥éª¤çš„å®ç°å°å‚…å“¥è¿™é‡Œéƒ½ä¼šå°½å¯èƒ½å‚ç…§ Spring æºç çš„æ¥å£å®šä¹‰ã€æŠ½è±¡ç±»å®ç°ã€åç§°è§„èŒƒã€ä»£ç ç»“æ„ç­‰ï¼Œåšç›¸åº”çš„ç®€åŒ–å¤„ç†ã€‚è¿™æ ·å¤§å®¶åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ç±»åæˆ–è€…æ¥å£å’Œæ•´ä¸ªç»“æ„ä½“å­¦ä¹  Spring æºç ï¼Œè¿™æ ·å­¦ä¹ èµ·æ¥å°±å®¹æ˜“å¤šäº†ã€‚</li><li>çœ‹å®Œç»å¯¹ä¸ç­‰äºä¼šï¼Œä½ åªæœ‰åŠ¨èµ·æ‰‹æ¥ä»ä¸€ä¸ªå°å°çš„å·¥ç¨‹æ¡†æ¶ç»“æ„ï¼Œæ•²åˆ°ç°åœ¨ä»¥åŠä»¥åä¸æ–­çš„å˜å¤§ã€å˜å¤šã€å˜å¼ºæ—¶ï¼Œæ‰èƒ½çœŸçš„æŒæ¡è¿™é‡Œé¢çš„çŸ¥è¯†ã€‚å¦å¤–æ¯ä¸€ä¸ªç« èŠ‚çš„åŠŸèƒ½å®ç°éƒ½ä¼šæ¶‰åŠåˆ°å¾ˆå¤šçš„ä»£ç è®¾è®¡æ€è·¯ï¼Œè¦è®¤çœŸå»é¢†æ‚Ÿã€‚<em>å½“ç„¶å®è·µèµ·æ¥æ˜¯æœ€å¥½çš„é¢†æ‚Ÿæ–¹å¼ï¼</em></li></ul><h2 id="ä¸ƒã€ä¼˜ç§€ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€ä¼˜ç§€ä½œä¸š" aria-hidden="true">#</a> ä¸ƒã€ä¼˜ç§€ä½œä¸š</h2>`,88),b={href:"https://t.zsxq.com/05e2z7uNV",target:"_blank",rel:"noopener noreferrer"},g={href:"https://t.zsxq.com/05FeqVJiy",target:"_blank",rel:"noopener noreferrer"},f={href:"https://t.zsxq.com/07u3XPzSY",target:"_blank",rel:"noopener noreferrer"},h={href:"https://t.zsxq.com/07vGffvF9",target:"_blank",rel:"noopener noreferrer"},y={href:"https://t.zsxq.com/07KONGKAH",target:"_blank",rel:"noopener noreferrer"},w={href:"https://t.zsxq.com/08AepNIhn",target:"_blank",rel:"noopener noreferrer"},B={href:"https://t.zsxq.com/098CtQxzE",target:"_blank",rel:"noopener noreferrer"},S={href:"https://t.zsxq.com/095PDEcLv",target:"_blank",rel:"noopener noreferrer"},R={href:"https://t.zsxq.com/0aeHfY69U",target:"_blank",rel:"noopener noreferrer"},x={href:"https://t.zsxq.com/0bHOnbjl9",target:"_blank",rel:"noopener noreferrer"},q={href:"https://t.zsxq.com/0bPFcugeY",target:"_blank",rel:"noopener noreferrer"};function j(L,_){const a=p("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),e(a)]),d,s("åŸæ–‡ï¼š"),n("a",v,[s("https://mp.weixin.qq.com/s/GMcHUL7-oB7T0GWKjNC5Ng"),e(a)])]),m,n("ul",null,[n("li",null,[n("a",b,[s("å…³äºBeanFactoryè¿™é‡Œå¤šäº†å¾ˆå¤šæ¥å£ï¼Œæ„Ÿè§‰é©¬ä¸Šå¤æ‚åº¦è¦é£™å‡ï¼ @W"),e(a)])]),n("li",null,[n("a",g,[s("èµ„æºæ³¨å…¥æµç¨‹å­¦ä¹  @Chin"),e(a)])]),n("li",null,[n("a",f,[s("åœ¨ä¸Šé¢çš„ç« èŠ‚çš„æµ‹è¯•ç±»ä¸­ï¼ŒBeançš„æ³¨å†Œã€å±æ€§ç»‘å®šéƒ½æ˜¯é€šè¿‡ä»£ç çš„æ–¹å¼å®Œæˆçš„ @åˆ˜å°ç™½"),e(a)])]),n("li",null,[n("a",h,[s("ä»Spring.xmlè§£æå’Œæ³¨å†ŒBeanå¯¹è±¡ @å‚…å“¥åæ´ä¼šä¼šé•¿"),e(a)])]),n("li",null,[n("a",y,[s("æ¥å£å’Œå¯¹åº”ç›¸å…³ç±»çš„å¢åŠ äº†ä¸å°‘ï¼Œç†æ¸…å…³ç³»æœ‰éš¾åº¦ï¼Œç†è§£è®¾è®¡æ€æƒ³æ›´æœ‰éš¾åº¦ @Homage"),e(a)])]),n("li",null,[n("a",w,[s("å¯¹ Spring çš„é…ç½®æ–‡ä»¶è§£ææ³¨å†ŒBeanï¼ŒSpring åº”ç”¨ä¸Šä¸‹æ–‡ @å¾®é£"),e(a)])]),n("li",null,[n("a",B,[s("å®ç°åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œæ„Ÿè§‰æœ¬ç« æ‰æ˜¯SpringåŸºæœ¬æ¡†æ¶æ­å»ºå¥½çš„ä¸€ç«  @Liuliuliu"),e(a)])]),n("li",null,[n("a",S,[s("å®ç°ä»Spring.xmlè§£æå’Œæ³¨å†ŒBeanå¯¹è±¡ @åœ¨ä¹æœˆ"),e(a)])]),n("li",null,[n("a",R,[s("é€šè¿‡ DefaultResourceLoaderæ¥ä½¿ç”¨ä¸åŒçš„è§£ææ–¹å¼è§£æèµ„æº @å°æ±¤å“¥"),e(a)])]),n("li",null,[n("a",x,[s("å®ç°èµ„æºåŠ è½½ç±»å’Œå®ç°èµ„æºè§£æå’Œæ³¨å†Œ @Keendy"),e(a)])]),n("li",null,[n("a",q,[s("å®ç° Bean åˆå§‹åŒ–ä»¥åŠé”€æ¯ï¼Œè™šæ‹Ÿæœºæ³¨å†Œé’©å­ @çˆ±å¥‹æ–—çš„å°é²¨é±¼"),e(a)])])])])}const U=t(i,[["render",j],["__file","2021-06-09-di6zhangï¼šqitunshanheï¼Œshejiyushixianziyuanjiazaiqiï¼ŒcongSpring.xmljiexihezhuceBeanduixiang.html.vue"]]);export{U as default};
