import{_ as e,r as o,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"nettyæ¡ˆä¾‹-netty4-1ä¸­çº§æ‹“å±•ç¯‡åä¸‰ã€ŠnettyåŸºäºsslå®ç°ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­åŒå‘åŠ å¯†éªŒè¯ã€‹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#nettyæ¡ˆä¾‹-netty4-1ä¸­çº§æ‹“å±•ç¯‡åä¸‰ã€ŠnettyåŸºäºsslå®ç°ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­åŒå‘åŠ å¯†éªŒè¯ã€‹","aria-hidden":"true"},"#"),s(" nettyæ¡ˆä¾‹ï¼Œnetty4.1ä¸­çº§æ‹“å±•ç¯‡åä¸‰ã€ŠNettyåŸºäºSSLå®ç°ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­åŒå‘åŠ å¯†éªŒè¯ã€‹")],-1),k=n("br",null,null,-1),r={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=p(`<blockquote><p>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„</p></blockquote><h2 id="å‰è¨€ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#å‰è¨€ä»‹ç»" aria-hidden="true">#</a> å‰è¨€ä»‹ç»</h2><blockquote><p>SSL(Secure Sockets Layer å®‰å…¨å¥—æ¥å±‚),åŠå…¶ç»§ä»»è€…ä¼ è¾“å±‚å®‰å…¨ï¼ˆTransport Layer Securityï¼ŒTLSï¼‰æ˜¯ä¸ºç½‘ç»œé€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§çš„ä¸€ç§å®‰å…¨åè®®ã€‚TLSä¸SSLåœ¨ä¼ è¾“å±‚å¯¹ç½‘ç»œè¿æ¥è¿›è¡ŒåŠ å¯†ã€‚</p></blockquote><p>åœ¨å®é™…é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸ä½¿ç”¨SSLé‚£ä¹ˆä¿¡æ¯å°±æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä»è€Œç»™éæ³•åˆ†å­ä¸€äº›å¯ä¹˜ä¹‹æœºï¼›</p><ul><li>çªƒå¬é£é™©[eavesdropping]ï¼šç¬¬ä¸‰æ–¹å¯ä»¥è·çŸ¥é€šä¿¡å†…å®¹ã€‚</li><li>ç¯¡æ”¹é£é™©[tampering]ï¼šç¬¬ä¸‰æ–¹å¯ä»¥ä¿®æ”¹é€šä¿¡å†…å®¹ã€‚</li><li>å†’å……é£é™©[pretending]ï¼šç¬¬ä¸‰æ–¹å¯ä»¥å†’å……ä»–äººèº«ä»½å‚ä¸é€šä¿¡ã€‚</li></ul><p>SSL/TLSåè®®å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸‰å¤§é£é™©è€Œè®¾è®¡çš„ï¼›</p><ul><li>ä¿å¯†ï¼šåœ¨æ¡æ‰‹åè®®ä¸­å®šä¹‰äº†ä¼šè¯å¯†é’¥åï¼Œæ‰€æœ‰çš„æ¶ˆæ¯éƒ½è¢«åŠ å¯†ã€‚</li><li>é‰´åˆ«ï¼šå¯é€‰çš„å®¢æˆ·ç«¯è®¤è¯ï¼Œå’Œå¼ºåˆ¶çš„æœåŠ¡å™¨ç«¯è®¤è¯ã€‚</li><li>å®Œæ•´æ€§ï¼šä¼ é€çš„æ¶ˆæ¯åŒ…æ‹¬æ¶ˆæ¯å®Œæ•´æ€§æ£€æŸ¥ï¼ˆä½¿ç”¨MACï¼‰ã€‚</li></ul><p>é‚£ä¹ˆæœ¬ç« èŠ‚æˆ‘ä»¬é€šè¿‡åœ¨nettyçš„channHandlerä¸­æ·»åŠ SSLå®‰å…¨æ¨¡å—{sslContext.newHandler(channel.alloc())}ï¼Œæ¥å®ç°åŠ å¯†ä¼ è¾“çš„æ•ˆæœã€‚</p><p><strong>æµ‹è¯•æ³¨é‡Šæ‰å®¢æˆ·ç«¯SSLå®‰å…¨æ¨¡å—ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span>NotSslRecordException</span><span class="token operator">:</span> not an <span class="token constant">SSL</span><span class="token operator">/</span><span class="token constant">TLS</span> record<span class="token operator">:</span> cea2d0c5b9abd6dabac5a3ba627567737461636bb3e6b6b4d5bb207c20cda8d6aab7fecef1b6cbc1b4bdd3bda8c1a2b3c9b9a6204d6f6e205365702032332031333a35303a3535204353542032303139203132372e302e302e310d0a
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç¯¡æ”¹æœåŠ¡ç«¯æ—¶é—´ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span>SSLHandshakeException</span><span class="token operator">:</span> <span class="token class-name">General</span> <span class="token class-name">SSLEngine</span> problem
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="å¼€å‘ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#å¼€å‘ç¯å¢ƒ" aria-hidden="true">#</a> å¼€å‘ç¯å¢ƒ</h2>`,13),m=n("li",null,"jdk1.8ã€jdk1.7ä»¥ä¸‹åªèƒ½éƒ¨åˆ†æ”¯æŒnettyã€‘",-1),v=n("li",null,"Netty4.1.36.Finalã€netty3.x 4.x 5æ¯æ¬¡çš„å˜åŒ–è¾ƒå¤§ï¼Œæ¥å£ç±»åä¹Ÿéšç€å˜åŒ–ã€‘",-1),b={href:"http://slproweb.com/products/Win32OpenSSL.html",target:"_blank",rel:"noopener noreferrer"},y=n("h2",{id:"ç”Ÿæˆè¯ä¹¦-è¿‡ç¨‹è¾ƒé•¿-è€å¿ƒå®Œæˆ",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ç”Ÿæˆè¯ä¹¦-è¿‡ç¨‹è¾ƒé•¿-è€å¿ƒå®Œæˆ","aria-hidden":"true"},"#"),s(" ç”Ÿæˆè¯ä¹¦ | è¿‡ç¨‹è¾ƒé•¿ï¼Œè€å¿ƒå®Œæˆ")],-1),g=n("p",null,[n("img",{src:"https://bugstack.cn/assets/images/pic-content/2019/09/netty-2-13-2.png",alt:"å¾®ä¿¡å…¬ä¼—å·ï¼šbustackè™«æ´æ ˆ | ç”Ÿæˆè¯ä¹¦"})],-1),h=n("blockquote",null,[n("p",null,"1ã€å®‰è£…OpenSSL")],-1),S={href:"https://stackoverflow.com/questions/22906927/openssl-windows-error-in-req/27918971",target:"_blank",rel:"noopener noreferrer"},f=n("img",{src:"https://bugstack.cn/assets/images/pic-content/2019/09/netty-2-13-1.png",alt:"OpenSSL Windows: error in req"},null,-1),w=p(`<blockquote><p>2ã€ç”ŸæˆæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç§é’¥ | å‘½ä»¤ä¸­éœ€è¦è¾“å…¥å¯†ç æµ‹è¯•å¯ä»¥éƒ½è¾“å…¥123456</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>openssl genrsa <span class="token operator">-</span>des3 <span class="token operator">-</span>out server<span class="token punctuation">.</span>key <span class="token number">1024</span>
openssl genrsa <span class="token operator">-</span>des3 <span class="token operator">-</span>out client<span class="token punctuation">.</span>key <span class="token number">1024</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>3ã€æ ¹æ®keyç”Ÿæˆcsræ–‡ä»¶ | -config openssl.cnf é»˜è®¤åœ¨cnfæ–‡ä»¶å¤¹ï¼Œå¦‚æœæœªå¤åˆ¶å‡ºæ¥ï¼Œéœ€è¦æŒ‡å®šè·¯å¾„â€œD://..cnf//openssl.cnfâ€</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>openssl req <span class="token operator">-</span><span class="token keyword">new</span> <span class="token operator">-</span>key server<span class="token punctuation">.</span>key <span class="token operator">-</span>out server<span class="token punctuation">.</span>csr <span class="token operator">-</span>config openssl<span class="token punctuation">.</span>cnf
openssl req <span class="token operator">-</span><span class="token keyword">new</span> <span class="token operator">-</span>key client<span class="token punctuation">.</span>key <span class="token operator">-</span>out client<span class="token punctuation">.</span>csr <span class="token operator">-</span>config openssl<span class="token punctuation">.</span>cnf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>4ã€æ ¹æ®caè¯ä¹¦server.csrã€client.csrç”Ÿæˆ<strong>x509</strong>è¯ä¹¦</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span>days <span class="token number">3650</span> <span class="token operator">-</span>in server<span class="token punctuation">.</span>csr <span class="token operator">-</span><span class="token constant">CA</span> ca<span class="token punctuation">.</span>crt <span class="token operator">-</span><span class="token class-name">CAkey</span> ca<span class="token punctuation">.</span>key <span class="token operator">-</span><span class="token class-name">CAcreateserial</span> <span class="token operator">-</span>out server<span class="token punctuation">.</span>crt
openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span>days <span class="token number">3650</span> <span class="token operator">-</span>in client<span class="token punctuation">.</span>csr <span class="token operator">-</span><span class="token constant">CA</span> ca<span class="token punctuation">.</span>crt <span class="token operator">-</span><span class="token class-name">CAkey</span> ca<span class="token punctuation">.</span>key <span class="token operator">-</span><span class="token class-name">CAcreateserial</span> <span class="token operator">-</span>out client<span class="token punctuation">.</span>crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>5ã€å°†keyæ–‡ä»¶è¿›è¡Œ<strong>PKCS#8</strong>ç¼–ç </p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>openssl pkcs8 <span class="token operator">-</span>topk8 <span class="token operator">-</span>in server<span class="token punctuation">.</span>key <span class="token operator">-</span>out pkcs8_server<span class="token punctuation">.</span>key <span class="token operator">-</span>nocrypt
openssl pkcs8 <span class="token operator">-</span>topk8 <span class="token operator">-</span>in client<span class="token punctuation">.</span>key <span class="token operator">-</span>out pkcs8_client<span class="token punctuation">.</span>key <span class="token operator">-</span>nocrypt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>6ã€æœ€ç»ˆå°†binæ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚ä¸‹æ–‡ä»¶å¤åˆ¶å‡ºæ¥ï¼›</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>serverç«¯ï¼šca<span class="token punctuation">.</span>crtã€server<span class="token punctuation">.</span>crtã€pkcs8_server<span class="token punctuation">.</span>key
clientç«¯ï¼šca<span class="token punctuation">.</span>crtã€client<span class="token punctuation">.</span>crtã€pkcs8_client<span class="token punctuation">.</span>key
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹" aria-hidden="true">#</a> ä»£ç ç¤ºä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>netty<span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">13</span>
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>netty
    â”‚           â”œâ”€â”€ client
    â”‚           â”‚	â”œâ”€â”€ <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">.</span>java
    â”‚           â”‚	â”œâ”€â”€ <span class="token class-name">MyClientHandler</span><span class="token punctuation">.</span>java
    â”‚           â”‚	â””â”€â”€ <span class="token class-name">NettyClient</span><span class="token punctuation">.</span>java
    â”‚           â”œâ”€â”€ server
    â”‚           â”‚	â”œâ”€â”€ <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">.</span>java
    â”‚           â”‚	â”œâ”€â”€ <span class="token class-name">MyServerHandler</span><span class="token punctuation">.</span>java	
    â”‚           â”‚	â””â”€â”€ <span class="token class-name">NettyServer</span><span class="token punctuation">.</span>java
    â”‚           â””â”€â”€ ssl
    â”‚           	â”œâ”€â”€ client
    â”‚           	â”‚	â”œâ”€â”€ ca<span class="token punctuation">.</span>crt
    â”‚           	â”‚	â”œâ”€â”€ client<span class="token punctuation">.</span>crt	
    â”‚           	â”‚	â””â”€â”€ pkcs8_client<span class="token punctuation">.</span>key	
    â”‚           	â””â”€â”€ server
    â”‚           		â”œâ”€â”€ ca<span class="token punctuation">.</span>crt
    â”‚           		â”œâ”€â”€ pkcs8_server<span class="token punctuation">.</span>key
    â”‚           		â””â”€â”€ server<span class="token punctuation">.</span>crt
    â”‚
    â””â”€â”€ test
         â””â”€â”€ java
             â””â”€â”€ org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>test
                 â””â”€â”€ <span class="token class-name">ApiTest</span><span class="token punctuation">.</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä»¥ä¸‹é‡ç‚¹ä»£ç å—è®²è§£ï¼Œå®Œæ•´ä»£ç ï¼Œå…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | å›å¤Nettyæºç è·å–</strong></p><h3 id="å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯" aria-hidden="true">#</a> å®¢æˆ·ç«¯ï¼š</h3><blockquote><p>client/NettyClient.java | å¼•å…¥SSLè®¤è¯</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyClient</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SSLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">NettyClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">7398</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">String</span> inetHost<span class="token punctuation">,</span> <span class="token keyword">int</span> inetPort<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SSLException</span> <span class="token punctuation">{</span>

        <span class="token comment">//å¼•å…¥SSLå®‰å…¨éªŒè¯</span>
        <span class="token class-name">File</span> certChainFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\client\\\\client.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> keyFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\client\\\\pkcs8_client.key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> rootFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\client\\\\ca.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SslContext</span> sslCtx <span class="token operator">=</span> <span class="token class-name">SslContextBuilder</span><span class="token punctuation">.</span><span class="token function">forClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keyManager</span><span class="token punctuation">(</span>certChainFile<span class="token punctuation">,</span> keyFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trustManager</span><span class="token punctuation">(</span>rootFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é…ç½®å®¢æˆ·ç«¯NIOçº¿ç¨‹ç»„</span>
        <span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Bootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>workerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">AUTO_READ</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">(</span>sslCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ChannelFuture</span> f <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>inetHost<span class="token punctuation">,</span> inetPort<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty client start done. {å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | è·å–ä¸“é¢˜æºç }&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            workerGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>client/NettyClient.java | æ·»åŠ SSLè®¤è¯æ¨¡å—ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å¯ä»¥å°è¯•æ³¨é‡Šæ‰</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyChannelInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">SslContext</span> sslContext<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">(</span><span class="token class-name">SslContext</span> sslContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sslContext <span class="token operator">=</span> sslContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> channel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ·»åŠ SSLå®‰å…¨éªŒè¯</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>sslContext<span class="token punctuation">.</span><span class="token function">newHandler</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŸºäºæ¢è¡Œç¬¦å·</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LineBasedFrameDecoder</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£ç è½¬Stringï¼Œæ³¨æ„è°ƒæ•´è‡ªå·±çš„ç¼–ç æ ¼å¼GBKã€UTF-8</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringDecoder</span><span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;GBK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£ç è½¬Stringï¼Œæ³¨æ„è°ƒæ•´è‡ªå·±çš„ç¼–ç æ ¼å¼GBKã€UTF-8</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringEncoder</span><span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;GBK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åœ¨ç®¡é“ä¸­æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„æ¥æ”¶æ•°æ®å®ç°æ–¹æ³•</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyClientHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æœåŠ¡ç«¯" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡ç«¯" aria-hidden="true">#</a> æœåŠ¡ç«¯ï¼š</h3><blockquote><p>server/NettyServer.java | å¼•å…¥SSLå®‰å…¨éªŒè¯</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™«æ´æ ˆï¼šhttps://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 * Create by fuzhengwei on 2019
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyServer</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SSLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">NettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bing</span><span class="token punctuation">(</span><span class="token number">7398</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">bing</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SSLException</span> <span class="token punctuation">{</span>

        <span class="token comment">//å¼•å…¥SSLå®‰å…¨éªŒè¯</span>
        <span class="token class-name">File</span> certChainFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\server\\\\server.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> keyFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\server\\\\pkcs8_server.key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> rootFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\\\itstack\\\\GIT\\\\itstack.org\\\\itstack-demo-netty\\\\itstack-demo-netty-2-13\\\\src\\\\main\\\\java\\\\org\\\\itstack\\\\demo\\\\netty\\\\ssl\\\\server\\\\ca.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SslContext</span> sslCtx <span class="token operator">=</span> <span class="token class-name">SslContextBuilder</span><span class="token punctuation">.</span><span class="token function">forServer</span><span class="token punctuation">(</span>certChainFile<span class="token punctuation">,</span> keyFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trustManager</span><span class="token punctuation">(</span>rootFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clientAuth</span><span class="token punctuation">(</span><span class="token class-name">ClientAuth</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é…ç½®æœåŠ¡ç«¯NIOçº¿ç¨‹ç»„</span>
        <span class="token class-name">EventLoopGroup</span> parentGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//NioEventLoopGroup extends MultithreadEventLoopGroup Math.max(1, SystemPropertyUtil.getInt(&quot;io.netty.eventLoopThreads&quot;, NettyRuntime.availableProcessors() * 2));</span>
        <span class="token class-name">EventLoopGroup</span> childGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ServerBootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>parentGroup<span class="token punctuation">,</span> childGroup<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token comment">//éé˜»å¡æ¨¡å¼</span>
                    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_BACKLOG</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">(</span>sslCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ChannelFuture</span> f <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;itstack-demo-netty server start done. {å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | è·å–ä¸“é¢˜æºç }&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            childGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parentGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>server/NettyServer.java | æ·»åŠ SSLè®¤è¯æ¨¡å—</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> è™«æ´æ ˆï¼šhttps<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>bugstack<span class="token punctuation">.</span>cn
 <span class="token operator">*</span> å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ  ï½›è·å–å­¦ä¹ æºç ï½
 <span class="token operator">*</span> <span class="token class-name">Create</span> by fuzhengwei on <span class="token number">2019</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyChannelInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">SslContext</span> sslContext<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyChannelInitializer</span><span class="token punctuation">(</span><span class="token class-name">SslContext</span> sslContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sslContext <span class="token operator">=</span> sslContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ·»åŠ SSLå®‰è£…éªŒè¯</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>sslContext<span class="token punctuation">.</span><span class="token function">newHandler</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŸºäºæ¢è¡Œç¬¦å·</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LineBasedFrameDecoder</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£ç è½¬Stringï¼Œæ³¨æ„è°ƒæ•´è‡ªå·±çš„ç¼–ç æ ¼å¼GBKã€UTF-8</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringDecoder</span><span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;GBK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£ç è½¬Stringï¼Œæ³¨æ„è°ƒæ•´è‡ªå·±çš„ç¼–ç æ ¼å¼GBKã€UTF-8</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringEncoder</span><span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;GBK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åœ¨ç®¡é“ä¸­æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„æ¥æ”¶æ•°æ®å®ç°æ–¹æ³•</span>
        channel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyServerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> æµ‹è¯•ç»“æœ</h2><blockquote><p>å¯åŠ¨æœåŠ¡ç«¯NettyServer</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>itstack<span class="token operator">-</span>demo<span class="token operator">-</span>netty server start done<span class="token punctuation">.</span> <span class="token punctuation">{</span>å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> è·å–ä¸“é¢˜æºç <span class="token punctuation">}</span>
é“¾æ¥æŠ¥å‘Šå¼€å§‹
é“¾æ¥æŠ¥å‘Šä¿¡æ¯ï¼šæœ‰ä¸€å®¢æˆ·ç«¯é“¾æ¥åˆ°æœ¬æœåŠ¡ç«¯
é“¾æ¥æŠ¥å‘Š<span class="token constant">IP</span><span class="token operator">:</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
é“¾æ¥æŠ¥å‘Š<span class="token class-name">Port</span><span class="token operator">:</span><span class="token number">7399</span>
é“¾æ¥æŠ¥å‘Šå®Œæ¯•
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> é€šçŸ¥æœåŠ¡ç«¯é“¾æ¥å»ºç«‹æˆåŠŸ <span class="token class-name">Mon</span> <span class="token class-name">Sep</span> <span class="token number">23</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> <span class="token constant">CST</span> <span class="token number">2019</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">51</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>å®¢æˆ·ç«¯å‘é€ï¼ŒæœåŠ¡ç«¯ä½ åœ¨å—ï¼Ÿ

å¼‚å¸¸ä¿¡æ¯ï¼š
è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥ã€‚
å®¢æˆ·ç«¯æ–­å¼€é“¾æ¥<span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">7399</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token operator">-</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å¯åŠ¨å®¢æˆ·ç«¯NettyClient</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>é“¾æ¥æŠ¥å‘Šå¼€å§‹
é“¾æ¥æŠ¥å‘Šä¿¡æ¯ï¼šæœ¬å®¢æˆ·ç«¯é“¾æ¥åˆ°æœåŠ¡ç«¯ã€‚channelIdï¼š<span class="token number">3</span>ad375e9
é“¾æ¥æŠ¥å‘Š<span class="token constant">IP</span><span class="token operator">:</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
é“¾æ¥æŠ¥å‘Š<span class="token class-name">Port</span><span class="token operator">:</span><span class="token number">51656</span>
é“¾æ¥æŠ¥å‘Šå®Œæ¯•
itstack<span class="token operator">-</span>demo<span class="token operator">-</span>netty client start done<span class="token punctuation">.</span> <span class="token punctuation">{</span>å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> è·å–ä¸“é¢˜æºç <span class="token punctuation">}</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> é€šçŸ¥å®¢æˆ·ç«¯é“¾æ¥å»ºç«‹æˆåŠŸ <span class="token class-name">Mon</span> <span class="token class-name">Sep</span> <span class="token number">23</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> <span class="token constant">CST</span> <span class="token number">2019</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span><span class="token number">50</span> æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token constant">SSL</span><span class="token punctuation">]</span>æœåŠ¡ç«¯å‘é€ï¼Œå®¢æˆ·ç«¯æˆ‘åœ¨ã€‚

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token operator">-</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¾®ä¿¡æœç´¢ã€Œ<strong>bugstackè™«æ´æ ˆ</strong>ã€å…¬ä¼—å·ï¼Œå…³æ³¨åå›å¤ã€Œ<strong>Nettyä¸“é¢˜æ¡ˆä¾‹</strong>ã€è·å–æœ¬æ–‡æºç &amp;æ›´å¤šåŸåˆ›ä¸“é¢˜æ¡ˆä¾‹ï¼</p>`,29);function x(C,L){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),k,s("åšå®¢ï¼š"),n("a",r,[s("https://bugstack.cn"),t(a)])]),d,n("ol",null,[m,v,n("li",null,[s("OpenSSL-Win64 å¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€è¦è¿›è¡Œä¸‹è½½ï¼›"),n("a",b,[s("http://slproweb.com/products/Win32OpenSSL.html"),t(a)])])]),y,g,h,n("p",null,[s("å®‰è£…å®ŒæˆåD:\\Program Files\\OpenSSL-Win64\\binç›®å½•ä¸‹ï¼Œcnfæ–‡ä»¶å¤åˆ¶åˆ°binç›®å½•é‡Œï¼Œå¦åˆ™åœ¨æ“ä½œå·¥ç¨‹ä¸­å¦‚æœæœªæŒ‡å®šè·¯å¾„ï¼Œä¼šæŠ¥é”™ï¼› "),n("a",S,[s("https://stackoverflow.com/questions/22906927/openssl-windows-error-in-req/27918971"),t(a)]),f]),w])}const q=e(i,[["render",x],["__file","2019-08-28-nettyanliï¼Œnetty4.1zhongjituozhanpianshisanã€ŠNettyjiyuSSLshixianxinxichuanshuguochengzhongshuangxiangjiamiyanzhengã€‹.html.vue"]]);export{q as default};
