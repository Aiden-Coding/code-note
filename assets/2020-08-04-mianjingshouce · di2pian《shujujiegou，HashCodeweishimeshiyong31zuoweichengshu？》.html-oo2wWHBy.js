import{_ as e,r as o,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-3RcBQnkC.js";const i={},u=n("h1",{id:"é¢ç»æ‰‹å†Œ-Â·-ç¬¬2ç¯‡ã€Šæ•°æ®ç»“æ„-hashcodeä¸ºä»€ä¹ˆä½¿ç”¨31ä½œä¸ºä¹˜æ•°-ã€‹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#é¢ç»æ‰‹å†Œ-Â·-ç¬¬2ç¯‡ã€Šæ•°æ®ç»“æ„-hashcodeä¸ºä»€ä¹ˆä½¿ç”¨31ä½œä¸ºä¹˜æ•°-ã€‹","aria-hidden":"true"},"#"),s(" é¢ç»æ‰‹å†Œ Â· ç¬¬2ç¯‡ã€Šæ•°æ®ç»“æ„ï¼ŒHashCodeä¸ºä»€ä¹ˆä½¿ç”¨31ä½œä¸ºä¹˜æ•°ï¼Ÿã€‹")],-1),r=n("br",null,null,-1),k={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},d=n("blockquote",null,[n("p",null,"æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")],-1),m=n("h2",{id:"ä¸€ã€å‰è¨€",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ä¸€ã€å‰è¨€","aria-hidden":"true"},"#"),s(" ä¸€ã€å‰è¨€")],-1),h={href:"https://bugstack.cn/interview/2020/07/28/%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C-%E5%BC%80%E7%AF%87-%E9%9D%A2%E8%AF%95%E5%AE%98%E9%83%BD%E9%97%AE%E6%88%91%E5%95%A5.html",target:"_blank",rel:"noopener noreferrer"},v=n("strong",null,"ã€Šé¢è¯•å®˜éƒ½é—®æˆ‘å•¥ã€‹",-1),b={href:"https://bugstack.cn/interview/2020/07/30/%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C-%E7%AC%AC1%E7%AF%87-%E8%AE%A4%E7%9F%A5%E8%87%AA%E5%B7%B1%E7%9A%84%E6%8A%80%E6%9C%AF%E6%A0%88%E7%9B%B2%E5%8C%BA.html",target:"_blank",rel:"noopener noreferrer"},g=n("strong",null,"ã€Šè®¤çŸ¥è‡ªå·±çš„æŠ€æœ¯æ ˆç›²åŒºã€‹",-1),f=p('<p>åœ¨è¿›å…¥æ•°æ®ç»“æ„ç« èŠ‚è®²è§£ä¹‹å‰å¯ä»¥å…ˆäº†è§£ä¸‹ï¼Œæ•°æ®ç»“æ„éƒ½æœ‰å“ªäº›ï¼ŒåŸºæœ¬å¯ä»¥åŒ…æ‹¬ï¼›<code>æ•°ç»„(Array)</code>ã€<code>æ ˆ(Stack)</code>ã€<code>é˜Ÿåˆ—(Queue)</code>ã€<code>é“¾è¡¨(LinkList)</code>ã€<code>æ ‘(Tree)</code>ã€<code>æ•£åˆ—è¡¨(Hash)</code>ã€<code>å †(Heap)</code>ã€<code>å›¾(Graph)</code>ã€‚</p><p>è€Œæœ¬æ–‡ä¸»è¦è®²è§£çš„å°±æ˜¯ä¸æ•£åˆ—è¡¨ç›¸å…³çš„<code>HashCode</code>ï¼Œæœ¬æ¥æƒ³å…ˆè®²<code>HashMap</code>ï¼Œä½†éšç€æ•´ç†èµ„æ–™å‘ç°ä¸<code>HashMap</code>çš„å®ç°ä¸­ï¼Œ<code>HashCode</code>çš„æ•£åˆ—å äº†å¾ˆé‡è¦çš„ä¸€è®¾è®¡æ€è·¯ï¼Œæ‰€ä»¥æœ€å¥½æŠŠè¿™éƒ¨åˆ†çŸ¥è¯†è¡¥å…¨ï¼Œå†å¾€ä¸‹è®²è§£ã€‚</p><h2 id="äºŒã€é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#äºŒã€é¢è¯•é¢˜" aria-hidden="true">#</a> äºŒã€é¢è¯•é¢˜</h2><p>è¯´åˆ°HashCodeçš„é¢è¯•é¢˜ï¼Œå¯èƒ½è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„äº†ã€‚å…¶ä»–è€ƒç‚¹ï¼›æ€ä¹ˆå®ç°æ•£åˆ—ã€è®¡ç®—é€»è¾‘ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™é“é¢˜çš„å­¦ä¹ äº†è§£ç›¸å…³çŸ¥è¯†ã€‚</p><p><strong>Why does Java&#39;s hashCode() in String use 31 as a multiplier?</strong></p><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-01.png" alt=""></p><p><strong>è¿™ä¸ªé—®é¢˜å…¶å®â˜æŒ‡çš„å°±æ˜¯ï¼ŒhashCodeçš„è®¡ç®—é€»è¾‘ä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯31ä½œä¸ºä¹˜æ•°ã€‚</strong></p><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-02.png" alt=""></p><h2 id="ä¸‰ã€èµ„æºä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€èµ„æºä¸‹è½½" aria-hidden="true">#</a> ä¸‰ã€èµ„æºä¸‹è½½</h2>',9),w={href:"https://bugstack.cn/assets/images/qrcode.png",target:"_blank",rel:"noopener noreferrer"},_=n("code",null,"bugstackè™«æ´æ ˆ",-1),y=n("em",null,"å›å¤ä¸‹è½½åæ‰“å¼€è·å¾—çš„é“¾æ¥ï¼Œæ‰¾åˆ°ç¼–å·IDï¼š19",-1),E=p(`<ol><li>HashCode æºç æµ‹è¯•éªŒè¯å·¥ç¨‹ï¼Œ<code>interview-03</code></li><li><strong>103976ä¸ªè‹±è¯­å•è¯åº“.txt</strong>ï¼ŒéªŒè¯HashCodeå€¼</li><li><strong>HashCodeæ•£åˆ—åˆ†å¸ƒ.xlsx</strong>ï¼Œæ•£åˆ—å’Œç¢°æ’å›¾è¡¨</li></ol><h2 id="å››ã€æºç è®²è§£" tabindex="-1"><a class="header-anchor" href="#å››ã€æºç è®²è§£" aria-hidden="true">#</a> å››ã€æºç è®²è§£</h2><h3 id="_1-å›ºå®šä¹˜ç§¯31åœ¨è¿™ç”¨åˆ°äº†" tabindex="-1"><a class="header-anchor" href="#_1-å›ºå®šä¹˜ç§¯31åœ¨è¿™ç”¨åˆ°äº†" aria-hidden="true">#</a> 1. å›ºå®šä¹˜ç§¯31åœ¨è¿™ç”¨åˆ°äº†</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// è·å–hashCode &quot;abc&quot;.hashCode();</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h <span class="token operator">=</span> hash<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>h <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">char</span> val<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            h <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> h <span class="token operator">+</span> val<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        hash <span class="token operator">=</span> h<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> h<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è·å–<code>hashCode</code>çš„æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªå›ºå®šå€¼<code>31</code>ï¼Œåœ¨forå¾ªç¯æ¯æ¬¡æ‰§è¡Œæ—¶è¿›è¡Œä¹˜ç§¯è®¡ç®—ï¼Œå¾ªç¯åçš„å…¬å¼å¦‚ä¸‹ï¼› <code>s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1]</code></p><p><strong>é‚£ä¹ˆè¿™é‡Œä¸ºä»€ä¹ˆé€‰æ‹©31ä½œä¸ºä¹˜ç§¯å€¼å‘¢ï¼Ÿ</strong></p><h3 id="_2-æ¥è‡ªstackoverflowçš„å›ç­”" tabindex="-1"><a class="header-anchor" href="#_2-æ¥è‡ªstackoverflowçš„å›ç­”" aria-hidden="true">#</a> 2. æ¥è‡ªstackoverflowçš„å›ç­”</h3>`,7),A=n("code",null,"stackoverflow",-1),x={href:"https://stackoverflow.com/questions/299304/why-does-javas-hashcode-in-string-use-31-as-a-multiplier",target:"_blank",rel:"noopener noreferrer"},C=p(`<p><strong>413ä¸ªèµğŸ‘çš„å›ç­”</strong></p><p>æœ€å¤šçš„è¿™ä¸ªå›ç­”æ˜¯æ¥è‡ªã€ŠEffective Javaã€‹çš„å†…å®¹ï¼›</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">The</span> value <span class="token number">31</span> was chosen because it is an odd <span class="token class-name"><span class="token namespace">prime<span class="token punctuation">.</span></span> If</span> it were even and the multiplication overflowed<span class="token punctuation">,</span> information would be lost<span class="token punctuation">,</span> as multiplication by <span class="token number">2</span> is equivalent <span class="token keyword">to</span> <span class="token namespace">shifting<span class="token punctuation">.</span></span> <span class="token class-name">The</span> advantage of using a prime is less clear<span class="token punctuation">,</span> but it is <span class="token class-name"><span class="token namespace">traditional<span class="token punctuation">.</span></span> A</span> nice property of <span class="token number">31</span> is that the multiplication can be replaced by a shift and a subtraction <span class="token keyword">for</span> better performance<span class="token operator">:</span> <span class="token number">31</span> <span class="token operator">*</span> i <span class="token operator">==</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name"><span class="token namespace">i<span class="token punctuation">.</span></span> Modern</span> <span class="token class-name">VMs</span> <span class="token keyword">do</span> <span class="token keyword">this</span> sort of optimization automatically<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™æ®µå†…å®¹ä¸»è¦é˜è¿°çš„è§‚ç‚¹åŒ…æ‹¬ï¼›</p><ol><li>31 æ˜¯ä¸€ä¸ªå¥‡è´¨æ•°ï¼Œå¦‚æœé€‰æ‹©å¶æ•°ä¼šå¯¼è‡´ä¹˜ç§¯è¿ç®—æ—¶æ•°æ®æº¢å‡ºã€‚</li><li>å¦å¤–åœ¨äºŒè¿›åˆ¶ä¸­ï¼Œ2ä¸ª5æ¬¡æ–¹æ˜¯32ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯ <code>31 * i == (i &lt;&lt; 5) - i</code>ã€‚è¿™ä¸»è¦æ˜¯è¯´ä¹˜ç§¯è¿ç®—å¯ä»¥ä½¿ç”¨ä½ç§»æå‡æ€§èƒ½ï¼ŒåŒæ—¶ç›®å‰çš„JVMè™šæ‹Ÿæœºä¹Ÿä¼šè‡ªåŠ¨æ”¯æŒæ­¤ç±»çš„ä¼˜åŒ–ã€‚</li></ol><p><strong>80ä¸ªèµğŸ‘çš„å›ç­”</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">As</span> <span class="token class-name">Goodrich</span> and <span class="token class-name">Tamassia</span> point out<span class="token punctuation">,</span> <span class="token class-name">If</span> you take over <span class="token number">50</span><span class="token punctuation">,</span><span class="token number">000</span> <span class="token class-name">English</span> words <span class="token punctuation">(</span>formed as the union of the word lists provided in two variants of <span class="token class-name">Unix</span><span class="token punctuation">)</span><span class="token punctuation">,</span> using the constants <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> and <span class="token number">41</span> will produce less than <span class="token number">7</span> collisions in each <span class="token class-name"><span class="token namespace">case<span class="token punctuation">.</span></span> Knowing</span> <span class="token keyword">this</span><span class="token punctuation">,</span> it should come as no surprise that many <span class="token class-name">Java</span> implementations choose one of these constants<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>è¿™ä¸ªå›ç­”å°±å¾ˆæœ‰å®æˆ˜æ„ä¹‰äº†ï¼Œå‘Šè¯‰ä½ ç”¨è¶…è¿‡5ä¸‡ä¸ªå•è¯è®¡ç®—hashCodeï¼Œè¿™ä¸ªhashCodeçš„è¿ç®—ä½¿ç”¨31ã€33ã€37ã€39å’Œ41ä½œä¸ºä¹˜ç§¯ï¼Œå¾—åˆ°çš„ç¢°æ’ç»“æœï¼Œ31è¢«ä½¿ç”¨å°±å¾ˆæ­£å¸¸äº†ã€‚</li><li><strong>ä»–è¿™å¥è¯å°±å°±å¯ä»¥ä½œä¸ºæˆ‘ä»¬å®è·µçš„æŒ‡å‘äº†ã€‚</strong></li></ul><h3 id="_3-hashå€¼ç¢°æ’æ¦‚ç‡ç»Ÿè®¡" tabindex="-1"><a class="header-anchor" href="#_3-hashå€¼ç¢°æ’æ¦‚ç‡ç»Ÿè®¡" aria-hidden="true">#</a> 3. Hashå€¼ç¢°æ’æ¦‚ç‡ç»Ÿè®¡</h3><p>æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…å¹¶ä¸éš¾ï¼Œåªæ˜¯æ ¹æ®<code>stackoverflow</code>çš„å›ç­”ï¼Œç»Ÿè®¡å‡ºä¸åŒçš„ä¹˜ç§¯æ•°å¯¹10ä¸‡ä¸ªå•è¯çš„hashè®¡ç®—ç»“æœã€‚<em>10ä¸ªå•è¯è¡¨å·²æä¾›ï¼Œå¯ä»¥é€šè¿‡å…³æ³¨å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆè¿›è¡Œä¸‹è½½</em></p><h4 id="_3-1-è¯»å–å•è¯å­—å…¸è¡¨" tabindex="-1"><a class="header-anchor" href="#_3-1-è¯»å–å•è¯å­—å…¸è¡¨" aria-hidden="true">#</a> 3.1 è¯»å–å•è¯å­—å…¸è¡¨</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">1</span>	a	<span class="token string">&quot;n.(A)As æˆ– A&#39;s  å®‰(ampere(a) art.ä¸€;n.å­—æ¯A /[å†›] Analog.Digital,æ¨¡æ‹Ÿ/æ•°å­— /(=account of) å¸ä¸Š&quot;</span>
<span class="token number">2</span>	aaal	<span class="token class-name">American</span> <span class="token class-name">Academy</span> of <span class="token class-name">Arts</span> and <span class="token class-name">Letters</span> ç¾å›½è‰ºæœ¯å’Œæ–‡å­¦å­¦ä¼š
<span class="token number">3</span>	aachen	 äºšç›<span class="token punctuation">[</span>å¾·æ„å¿—è”é‚¦å…±å’Œå›½è¥¿éƒ¨åŸå¸‚<span class="token punctuation">]</span>
<span class="token number">4</span>	aacs	<span class="token class-name">Airways</span> and <span class="token class-name">Air</span> <span class="token class-name">Communications</span> <span class="token class-name">Service</span> <span class="token punctuation">(</span>ç¾å›½<span class="token punctuation">)</span>èˆªè·¯ä¸èˆªç©ºé€šè®¯è”ç»œå¤„
<span class="token number">5</span>	aah	<span class="token string">&quot; [å†›]Armored Artillery Howitzer,è£…ç”²æ¦´å¼¹ç‚®;[å†›]Advanced Attack Helicopter,å…ˆè¿›æ”»å‡»ç›´å‡æœº&quot;</span>
<span class="token number">6</span>	aal	<span class="token string">&quot;ATM Adaptation Layer,ATMé€‚åº”å±‚&quot;</span>
<span class="token number">7</span>	aapamoor	<span class="token string">&quot;n.[ç”Ÿ]ä¸˜æ³½,é«˜ä½ä½é•¶åµŒæ²¼æ³½&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å•è¯è¡¨çš„æ–‡ä»¶æ ¼å¼å¦‚ä¸Šï¼Œå¯ä»¥è‡ªè¡Œè§£æ</li><li>è¯»å–æ–‡ä»¶çš„ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸å±•ç¤ºäº†ï¼Œå¯ä»¥é€šè¿‡<code>èµ„æºä¸‹è½½</code>è¿›è¡Œè·å–</li></ul><h4 id="_3-2-hashè®¡ç®—å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_3-2-hashè®¡ç®—å‡½æ•°" aria-hidden="true">#</a> 3.2 Hashè®¡ç®—å‡½æ•°</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token class-name">Integer</span> multiplier<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        hash <span class="token operator">=</span> multiplier <span class="token operator">*</span> hash <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä¸åŸhashå‡½æ•°å¯¹æ¯”åªæ˜¯æ›¿æ¢äº†å¯å˜å‚æ•°ï¼Œç”¨äºæˆ‘ä»¬ç»Ÿè®¡ä¸åŒä¹˜ç§¯æ•°çš„è®¡ç®—ç»“æœã€‚</li></ul><h4 id="_3-3-hashç¢°æ’æ¦‚ç‡è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_3-3-hashç¢°æ’æ¦‚ç‡è®¡ç®—" aria-hidden="true">#</a> 3.3 Hashç¢°æ’æ¦‚ç‡è®¡ç®—</h4><p>æƒ³è®¡ç®—ç¢°æ’å¾ˆç®€å•ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—é‚£äº›å‡ºç°ç›¸åŒå“ˆå¸Œå€¼çš„æ•°é‡ï¼Œè®¡ç®—å‡ºç¢°æ’æ€»é‡å³å¯ã€‚è¿™é‡Œçš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¯ä»¥ä½¿ç”¨<code>set</code>ã€<code>map</code>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>java8</code>çš„<code>stream</code>æµç»Ÿè®¡<code>distinct</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">RateInfo</span> <span class="token function">hashCollisionRate</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> multiplier<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> hashCodeList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> maxHash <span class="token operator">=</span> hashCodeList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">compareTo</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> minHash <span class="token operator">=</span> hashCodeList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">compareTo</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> collisionCount <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>hashCodeList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> hashCodeList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> collisionRate <span class="token operator">=</span> <span class="token punctuation">(</span>collisionCount <span class="token operator">*</span> <span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> hashCodeList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RateInfo</span><span class="token punctuation">(</span>maxHash<span class="token punctuation">,</span> minHash<span class="token punctuation">,</span> multiplier<span class="token punctuation">,</span> collisionCount<span class="token punctuation">,</span> collisionRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™é‡Œè®°å½•äº†æœ€å¤§hashå’Œæœ€å°hashå€¼ï¼Œä»¥åŠæœ€ç»ˆè¿”å›ç¢°æ’æ•°é‡çš„ç»Ÿè®¡ç»“æœã€‚</li></ul><h4 id="_3-4-å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3-4-å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 3.4 å•å…ƒæµ‹è¯•</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Before</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;abc&quot;</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¯»å–æ–‡ä»¶ï¼Œ103976ä¸ªè‹±è¯­å•è¯åº“.txt</span>
    words <span class="token operator">=</span> <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readWordList</span><span class="token punctuation">(</span><span class="token string">&quot;E:/itstack/git/github.com/interview/interview-01/103976ä¸ªè‹±è¯­å•è¯åº“.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_collisionRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RateInfo</span><span class="token punctuation">&gt;</span></span> rateInfoList <span class="token operator">=</span> <span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">collisionRateList</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">RateInfo</span> rate <span class="token operator">:</span> rateInfoList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;ä¹˜æ•° = %4d, æœ€å°Hash = %11d, æœ€å¤§Hash = %10d, ç¢°æ’æ•°é‡ =%6d, ç¢°æ’æ¦‚ç‡ = %.4f%%&quot;</span><span class="token punctuation">,</span> rate<span class="token punctuation">.</span><span class="token function">getMultiplier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rate<span class="token punctuation">.</span><span class="token function">getMinHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rate<span class="token punctuation">.</span><span class="token function">getMaxHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rate<span class="token punctuation">.</span><span class="token function">getCollisionCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rate<span class="token punctuation">.</span><span class="token function">getCollisionRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä»¥ä¸Šå…ˆè®¾å®šè¯»å–è‹±æ–‡å•è¯è¡¨ä¸­çš„10ä¸ªå•è¯ï¼Œä¹‹ååšhashè®¡ç®—ã€‚</li><li>åœ¨hashè®¡ç®—ä¸­æŠŠå•è¯è¡¨ä¼ é€’è¿›å»ï¼ŒåŒæ—¶è¿˜æœ‰ä¹˜ç§¯æ•°ï¼›<code>2, 3, 5, 7, 17, 31, 32, 33, 39, 41, 199</code>ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªlistç»“æœå¹¶è¾“å‡ºã€‚</li><li>è¿™é‡Œä¸»è¦éªŒè¯åŒä¸€æ‰¹å•è¯ï¼Œå¯¹äºä¸åŒä¹˜ç§¯æ•°ä¼šæœ‰æ€ä¹ˆæ ·çš„hashç¢°æ’ç»“æœã€‚</li></ul><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>å•è¯æ•°é‡ï¼š<span class="token number">103976</span>
ä¹˜æ•° <span class="token operator">=</span>    <span class="token number">2</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span>          <span class="token number">97</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">1842581979</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span> <span class="token number">60382</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">58.0730</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>    <span class="token number">3</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147308825</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2146995420</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span> <span class="token number">24300</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">23.3708</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>    <span class="token number">5</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147091606</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147227581</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>  <span class="token number">7994</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">7.6883</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>    <span class="token number">7</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147431389</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147226363</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>  <span class="token number">3826</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">3.6797</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">17</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147238638</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147101452</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>   <span class="token number">576</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.5540</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">31</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147461248</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147444544</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>     <span class="token number">2</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.0019</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">32</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2007883634</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2074238226</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span> <span class="token number">34947</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">33.6106</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">33</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147469046</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147378587</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>     <span class="token number">1</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.0010</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">39</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147463635</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147443239</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>     <span class="token number">0</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.0000</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>   <span class="token number">41</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147423916</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147441721</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>     <span class="token number">1</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.0010</span><span class="token operator">%</span>
ä¹˜æ•° <span class="token operator">=</span>  <span class="token number">199</span><span class="token punctuation">,</span> æœ€å°<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2147459902</span><span class="token punctuation">,</span> æœ€å¤§<span class="token class-name">Hash</span> <span class="token operator">=</span> <span class="token number">2147480320</span><span class="token punctuation">,</span> ç¢°æ’æ•°é‡ <span class="token operator">=</span>     <span class="token number">0</span><span class="token punctuation">,</span> ç¢°æ’æ¦‚ç‡ <span class="token operator">=</span> <span class="token number">0.0000</span><span class="token operator">%</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-03.png" alt="å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆï¼Œhashç¢°æ’å›¾è¡¨"></p><p>ä»¥ä¸Šå°±æ˜¯ä¸åŒçš„ä¹˜æ•°ä¸‹çš„hashç¢°æ’ç»“æœå›¾æ ‡å±•ç¤ºï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºå¦‚ä¸‹ä¿¡æ¯ï¼›</p><ol><li>ä¹˜æ•°æ˜¯2æ—¶ï¼Œhashçš„å–å€¼èŒƒå›´æ¯”è¾ƒå°ï¼ŒåŸºæœ¬æ˜¯å †ç§¯åˆ°ä¸€ä¸ªèŒƒå›´å†…äº†ï¼Œåé¢å†…å®¹ä¼šçœ‹åˆ°è¿™å—çš„å±•ç¤ºã€‚</li><li>ä¹˜æ•°æ˜¯3ã€5ã€7ã€17ç­‰ï¼Œéƒ½æœ‰è¾ƒå¤§çš„ç¢°æ’æ¦‚ç‡</li><li><strong>ä¹˜æ•°æ˜¯31çš„æ—¶å€™ï¼Œç¢°æ’çš„æ¦‚ç‡å·²ç»å¾ˆå°äº†ï¼ŒåŸºæœ¬ç¨³å®šã€‚</strong></li><li>é¡ºç€å¾€ä¸‹çœ‹ï¼Œä½ ä¼šå‘ç°199çš„ç¢°æ’æ¦‚ç‡æ›´å°ï¼Œè¿™å°±ç›¸å½“äºä¸€æ’å¥‡æ•°çš„èŒ…å‘é‡å¤šï¼Œè‡ªç„¶ä¼šå‡å°‘ç¢°æ’ã€‚<strong>ä½†è¿™ä¸ªèŒƒå›´å€¼å·²ç»è¿œè¶…è¿‡intçš„å–å€¼èŒƒå›´äº†ï¼Œå¦‚æœç”¨æ­¤æ•°ä½œä¸ºä¹˜æ•°ï¼Œåˆè¿”å›intå€¼ï¼Œå°±ä¼šä¸¢å¤±æ•°æ®ä¿¡æ¯</strong>ã€‚</li></ol><h3 id="_4-hashå€¼æ•£åˆ—åˆ†å¸ƒ" tabindex="-1"><a class="header-anchor" href="#_4-hashå€¼æ•£åˆ—åˆ†å¸ƒ" aria-hidden="true">#</a> 4. Hashå€¼æ•£åˆ—åˆ†å¸ƒ</h3><p>é™¤äº†ä»¥ä¸Šçœ‹åˆ°å“ˆå¸Œå€¼åœ¨ä¸åŒä¹˜æ•°çš„ä¸€ä¸ªç¢°æ’æ¦‚ç‡åï¼Œå…³äºæ•£åˆ—è¡¨ä¹Ÿå°±æ˜¯hashï¼Œè¿˜æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ç‚¹ï¼Œé‚£å°±æ˜¯è¦å°½å¯èƒ½çš„è®©æ•°æ®æ•£åˆ—åˆ†å¸ƒã€‚åªæœ‰è¿™æ ·æ‰èƒ½å‡å°‘hashç¢°æ’æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯åé¢ç« èŠ‚è¦è®²åˆ°çš„hashMapæºç ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆçœ‹æ•£åˆ—åˆ†å¸ƒå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬èƒ½æŠŠ10ä¸‡ä¸ªhashå€¼é“ºåˆ°å›¾è¡¨ä¸Šï¼Œå½¢æˆçš„ä¸€å¼ å›¾ï¼Œå°±å¯ä»¥çœ‹å‡ºæ•´ä¸ªæ•£åˆ—åˆ†å¸ƒã€‚ä½†æ˜¯è¿™æ ·çš„å›¾ä¼šæ¯”è¾ƒå¤§ï¼Œå½“æˆ‘ä»¬ç¼©å°çœ‹åï¼Œå°±æˆä¸€ä¸ªäº†å¤§é»‘ç‚¹ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é‡‡å–åˆ†æ®µç»Ÿè®¡ï¼ŒæŠŠ2 ^ 32æ–¹åˆ†64ä¸ªæ ¼å­è¿›è¡Œå­˜æ”¾ï¼Œæ¯ä¸ªæ ¼å­éƒ½ä¼šæœ‰å¯¹åº”çš„æ•°é‡çš„hashå€¼ï¼Œæœ€ç»ˆæŠŠè¿™äº›æ•°æ®å±•ç¤ºåœ¨å›¾è¡¨ä¸Šã€‚</p><h4 id="_4-1-å“ˆå¸Œå€¼åˆ†æ®µå­˜æ”¾" tabindex="-1"><a class="header-anchor" href="#_4-1-å“ˆå¸Œå€¼åˆ†æ®µå­˜æ”¾" aria-hidden="true">#</a> 4.1 å“ˆå¸Œå€¼åˆ†æ®µå­˜æ”¾</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">hashArea</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> hashCodeList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> statistics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0x80000000</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">0x7fffffff</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">67108864</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> min <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">long</span> max <span class="token operator">=</span> min <span class="token operator">+</span> <span class="token number">67108864</span><span class="token punctuation">;</span>
        <span class="token comment">// ç­›é€‰å‡ºæ¯ä¸ªæ ¼å­é‡Œçš„å“ˆå¸Œå€¼æ•°é‡ï¼Œjava8æµç»Ÿè®¡ï¼›https://bugstack.cn/itstack-demo-any/2019/12/10/%E6%9C%89%E7%82%B9%E5%B9%B2%E8%B4%A7-Jdk1.8%E6%96%B0%E7%89%B9%E6%80%A7%E5%AE%9E%E6%88%98%E7%AF%87(41%E4%B8%AA%E6%A1%88%E4%BE%8B).html</span>
        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> hashCodeList<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> x <span class="token operator">&gt;=</span> min <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        statistics<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>start<span class="token operator">++</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> statistics<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™ä¸ªè¿‡ç¨‹ä¸»è¦ç»Ÿè®¡<code>int</code>å–å€¼èŒƒå›´å†…ï¼Œæ¯ä¸ªå“ˆå¸Œå€¼å­˜æ”¾åˆ°ä¸åŒæ ¼å­é‡Œçš„æ•°é‡ã€‚</li><li>è¿™é‡Œä¹Ÿæ˜¯ä½¿ç”¨äº†java8çš„æ–°ç‰¹æ€§è¯­æ³•ï¼Œç»Ÿè®¡èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚</li></ul><h4 id="_4-2-å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4-2-å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 4.2 å•å…ƒæµ‹è¯•</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_hashArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">hashArea</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">hashArea</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">hashArea</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">hashArea</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">HashCode</span><span class="token punctuation">.</span><span class="token function">hashArea</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿™é‡Œåˆ—å‡ºæˆ‘ä»¬è¦ç»Ÿè®¡çš„ä¹˜æ•°å€¼ï¼Œæ¯ä¸€ä¸ªä¹˜æ•°ä¸‹éƒ½ä¼šæœ‰å¯¹åº”çš„å“ˆå¸Œå€¼æ•°é‡æ±‡æ€»ï¼Œä¹Ÿå°±æ˜¯64ä¸ªæ ¼å­é‡Œçš„æ•°é‡ã€‚</li><li>æœ€ç»ˆæŠŠè¿™äº›ç»Ÿè®¡å€¼æ”¾å…¥åˆ°excelä¸­è¿›è¡Œå›¾è¡¨åŒ–å±•ç¤ºã€‚</li></ul><p><strong>ç»Ÿè®¡å›¾è¡¨</strong></p><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-04.png" alt="å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆï¼Œhashæ•£åˆ—è¡¨"></p><ul><li>ä»¥ä¸Šæ˜¯ä¸€ä¸ªå †ç§¯ç™¾åˆ†æ¯”ç»Ÿè®¡å›¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹æ–¹æ˜¯ä¸åŒä¹˜æ•°ä¸‹çš„ï¼Œæ¯ä¸ªæ ¼å­é‡Œçš„æ•°æ®ç»Ÿè®¡ã€‚</li><li>é™¤äº†199ä¸èƒ½ç”¨ä»¥å¤–ï¼Œ31çš„æ•£åˆ—ç»“æœç›¸å¯¹æ¥è¯´æ¯”è¾ƒå‡åŒ€ã€‚</li></ul><h5 id="_4-2-1-ä¹˜æ•°2æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_4-2-1-ä¹˜æ•°2æ•£åˆ—" aria-hidden="true">#</a> 4.2.1 ä¹˜æ•°2æ•£åˆ—</h5><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-05.png" alt=""></p><ul><li>ä¹˜æ•°æ˜¯2çš„æ—¶å€™ï¼Œæ•£åˆ—çš„ç»“æœåŸºæœ¬éƒ½å †ç§¯åœ¨ä¸­é—´ï¼Œæ²¡æœ‰å¾ˆå¥½çš„æ•£åˆ—ã€‚</li></ul><h5 id="_4-2-2-ä¹˜æ•°31æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_4-2-2-ä¹˜æ•°31æ•£åˆ—" aria-hidden="true">#</a> 4.2.2 ä¹˜æ•°31æ•£åˆ—</h5><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-06.png" alt=""></p><ul><li>ä¹˜æ•°æ˜¯31çš„æ—¶å€™ï¼Œæ•£åˆ—çš„æ•ˆæœå°±éå¸¸æ˜æ˜¾äº†ï¼ŒåŸºæœ¬åœ¨æ¯ä¸ªèŒƒå›´éƒ½æœ‰æ•°æ®å­˜æ”¾ã€‚</li></ul><h5 id="_4-2-3-ä¹˜æ•°199æ•£åˆ—" tabindex="-1"><a class="header-anchor" href="#_4-2-3-ä¹˜æ•°199æ•£åˆ—" aria-hidden="true">#</a> 4.2.3 ä¹˜æ•°199æ•£åˆ—</h5><p><img src="https://bugstack.cn/assets/images/2020/interview/interview-3-07.png" alt=""></p><ul><li>ä¹˜æ•°æ˜¯199æ˜¯ä¸èƒ½ç”¨çš„æ•£åˆ—ç»“æœï¼Œä½†æ˜¯å®ƒçš„æ•°æ®æ˜¯æ›´åŠ åˆ†æ•£çš„ï¼Œä»å›¾ä¸Šèƒ½çœ‹åˆ°æœ‰ä¸¤ä¸ªå°å±±åŒ…ã€‚ä½†å› ä¸ºæ•°æ®åŒºé—´é—®é¢˜ä¼šæœ‰æ•°æ®ä¸¢å¤±é—®é¢˜ï¼Œæ‰€ä»¥ä¸èƒ½é€‰æ‹©ã€‚</li></ul><p><strong>æ–‡ä¸­å¼•ç”¨</strong></p><ul><li>http://www.tianxiaobo.com/2018/01/18/String-hashCode-%E6%96%B9%E6%B3%95%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9%E6%95%B0%E5%AD%9731%E4%BD%9C%E4%B8%BA%E4%B9%98%E5%AD%90/</li><li>https://stackoverflow.com/questions/299304/why-does-javas-hashcode-in-string-use-31-as-a-multiplier</li></ul><h2 id="äº”ã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#äº”ã€æ€»ç»“" aria-hidden="true">#</a> äº”ã€æ€»ç»“</h2><ul><li>ä»¥ä¸Šä¸»è¦ä»‹ç»äº†hashCodeé€‰æ‹©31ä½œä¸ºä¹˜æ•°çš„ä¸»è¦åŸå› å’Œå®éªŒæ•°æ®éªŒè¯ï¼Œç®—æ˜¯ä¸€ä¸ªæ•£åˆ—çš„æ•°æ®ç»“æ„çš„æ¡ˆä¾‹è®²è§£ï¼Œåœ¨åç»­çš„ç±»ä¼¼æŠ€æœ¯ä¸­ï¼Œå°±å¯ä»¥è§£é‡Šå…¶ä»–çš„æºç è®¾è®¡æ€è·¯äº†ã€‚</li><li>çœ‹è¿‡æœ¬æ–‡è‡³å°‘åº”è¯¥è®©ä½ å¯ä»¥ä»æ ¹æœ¬ä¸Šè§£é‡Šäº†hashCodeçš„è®¾è®¡ï¼Œå…³äºä»–çš„æ‰€æœ‰é—®é¢˜ä¹Ÿå°±ä¸éœ€è¦æ­»è®°ç¡¬èƒŒäº†ï¼Œå­¦ä¹ ç¼–ç¨‹å†…å®¹é™¤äº†æœ€å¼€å§‹çš„æ¨¡ä»¿åˆ°æ·±å…¥ä»¥åå°±éœ€è¦ä¸æ–­çš„ç ”ç©¶æ•°å­¦é€»è¾‘å’Œæ•°æ®ç»“æ„ã€‚</li><li>æ–‡ä¸­å‚è€ƒäº†ä¼˜ç§€çš„hashCodeèµ„æ–™å’Œstackoverflowï¼Œå¹¶äº²è‡ªåšå®éªŒéªŒè¯ç»“æœï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ä¸‹è½½æœ¬æ–‡ä¸­èµ„æºå†…å®¹ï¼›è‹±æ–‡å­—å…¸ã€æºç ã€excelå›¾è¡¨ç­‰å†…å®¹ã€‚</li></ul>`,53);function H(j,B){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("ä½œè€…ï¼šå°å‚…å“¥ "),r,s("åšå®¢ï¼š"),n("a",k,[s("https://bugstack.cn"),t(a)])]),d,m,n("p",null,[s("åœ¨é¢ç»æ‰‹å†Œçš„å‰ä¸¤ç¯‡ä»‹ç»äº†"),n("a",h,[v,t(a)]),s("å’Œ"),n("a",b,[g,t(a)]),s("ï¼Œè¿™ä¸¤ç¯‡å†…å®¹ä¸»è¦ä¸ºäº†è¯´æ˜é¢è¯•è¿‡ç¨‹çš„è€ƒæŸ¥èŒƒå›´ï¼ŒåŒ…æ‹¬ä¸ªäººçš„è‡ªæˆ‘ä»‹ç»ã€æŠ€æœ¯æ ˆç§¯ç´¯ã€é¡¹ç›®ç»éªŒç­‰ï¼Œä»¥åŠåœ¨æŠ€æœ¯æ ˆç›²åŒºç¯‡ç« ä¸­ä»‹ç»äº†ä¸€ä¸ªæ•´å¥—æŠ€æœ¯æ ˆåœ¨ç³»ç»Ÿæ¶æ„ç”¨çš„åº”ç”¨ï¼Œä»¥æ­¤å…¨æ–¹é¢çš„æ‰«æè‡ªå·±æœ‰å“ªäº›ç›²åŒºè¿˜éœ€è¦è¡¥å……ã€‚è€Œæ¥ä¸‹æ¥çš„ç« èŠ‚ä¼šä»¥å„ä¸ªç³»åˆ—çš„æŠ€æœ¯æ ˆä¸­é‡åˆ°çš„é¢è¯•é¢˜ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œè®²è§£æŠ€æœ¯è¦ç‚¹ï¼Œäº†è§£æŠ€æœ¯åŸç†ï¼ŒåŒ…æ‹¬ï¼›æ•°æ®ç»“æ„ã€æ•°æ®ç®—æ³•ã€æŠ€æœ¯æ ˆã€æ¡†æ¶ç­‰è¿›è¡Œé€æ­¥å±•å¼€å­¦ä¹ ã€‚")]),f,n("p",null,[s("æœ¬æ–‡è®²è§£çš„è¿‡ç¨‹ä¸­æ¶‰åŠéƒ¨åˆ†æºç ç­‰èµ„æºï¼Œå¯ä»¥é€šè¿‡å…³æ³¨å…¬ä¼—å·ï¼š"),n("a",w,[_,t(a)]),s("ï¼Œå›å¤ä¸‹è½½è¿›è¡Œè·å–{"),y,s("}ï¼ŒåŒ…æ‹¬ï¼›")]),E,n("p",null,[s("åœ¨"),A,s("å…³äºä¸ºä»€ä¹ˆé€‰æ‹©31ä½œä¸ºå›ºå®šä¹˜ç§¯å€¼ï¼Œæœ‰ä¸€ç¯‡è®¨è®ºæ–‡ç« ï¼Œ"),n("a",x,[s("Why does Java's hashCode() in String use 31 as a multiplier?"),t(a)]),s(" è¿™æ˜¯ä¸€ä¸ªæ—¶é—´æ¯”è¾ƒä¹…çš„é—®é¢˜äº†ï¼Œæ‘˜å–ä¸¤ä¸ªå›ç­”ç‚¹èµæœ€å¤šçš„ï¼›")]),C])}const L=e(i,[["render",H],["__file","2020-08-04-mianjingshouce Â· di2pianã€Šshujujiegouï¼ŒHashCodeweishimeshiyong31zuoweichengshuï¼Ÿã€‹.html.vue"]]);export{L as default};
