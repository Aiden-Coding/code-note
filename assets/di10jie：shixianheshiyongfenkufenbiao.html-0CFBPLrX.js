import{_ as n,r as l,o as s,c as a,a as e,b as r,d as o,f as i,e as h}from"./app-3RcBQnkC.js";const _={},c=e("h1",{id:"第10节-实现和使用分库分表",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#第10节-实现和使用分库分表","aria-hidden":"true"},"#"),r(" 第10节：实现和使用分库分表")],-1),d=e("br",null,null,-1),p={href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"},u=e("blockquote",null,[e("p",null,"沉淀、分享、成长，让自己和他人都能有所收获！")],-1),f={href:"https://gitcode.net/KnowledgePlanet/Lottery/-/tree/210922_xfg_dbRouter",target:"_blank",rel:"noopener noreferrer"},b={href:"https://gitcode.net/KnowledgePlanet/db-router-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"},g=e("li",null,"描述：开发一个基于 HashMap 核心设计原理，使用哈希散列+扰动函数的方式，把数据散列到多个库表中的组件，并验证使用。",-1),x=e("h2",{id:"零、优秀作业",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#零、优秀作业","aria-hidden":"true"},"#"),r(" 零、优秀作业")],-1),m={href:"https://t.zsxq.com/066qNRjqf",target:"_blank",rel:"noopener noreferrer"},k={href:"https://t.zsxq.com/06VbuBUfY",target:"_blank",rel:"noopener noreferrer"},q={href:"https://t.zsxq.com/067myZrvf",target:"_blank",rel:"noopener noreferrer"},z={href:"https://t.zsxq.com/06vv76UVr",target:"_blank",rel:"noopener noreferrer"},y={href:"https://t.zsxq.com/063nu3jyV",target:"_blank",rel:"noopener noreferrer"},v={href:"https://t.zsxq.com/06eQZVvFE",target:"_blank",rel:"noopener noreferrer"},V={href:"https://t.zsxq.com/067euNz7y",target:"_blank",rel:"noopener noreferrer"},B={href:"https://t.zsxq.com/06amAmEau",target:"_blank",rel:"noopener noreferrer"},C={href:"https://t.zsxq.com/06rfQ33bU",target:"_blank",rel:"noopener noreferrer"},L={href:"https://t.zsxq.com/06MrzvVz7",target:"_blank",rel:"noopener noreferrer"},N={href:"https://t.zsxq.com/07VrNjMZn",target:"_blank",rel:"noopener noreferrer"},R={href:"https://t.zsxq.com/08LJZl91a",target:"_blank",rel:"noopener noreferrer"},j={href:"https://t.zsxq.com/09LVJcja0",target:"_blank",rel:"noopener noreferrer"},E={href:"https://t.zsxq.com/0ck1H9qRq",target:"_blank",rel:"noopener noreferrer"},D={href:"https://t.zsxq.com/0cLlPhvrt",target:"_blank",rel:"noopener noreferrer"},P={href:"https://t.zsxq.com/0cmnJ7zNZ",target:"_blank",rel:"noopener noreferrer"},T={href:"https://t.zsxq.com/0cDj2xmzB",target:"_blank",rel:"noopener noreferrer"},J={href:"https://t.zsxq.com/0cy6nh6gB",target:"_blank",rel:"noopener noreferrer"},M={href:"https://t.zsxq.com/0cSeFxyi8",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://t.zsxq.com/0dKxVQDri",target:"_blank",rel:"noopener noreferrer"},w={href:"https://t.zsxq.com/0dCcY5F1T",target:"_blank",rel:"noopener noreferrer"},F={href:"https://t.zsxq.com/0dtJdw4bi",target:"_blank",rel:"noopener noreferrer"},S={href:"https://t.zsxq.com/0ezh7FlF0",target:"_blank",rel:"noopener noreferrer"},A={href:"https://t.zsxq.com/0edCGCzyn",target:"_blank",rel:"noopener noreferrer"},O={href:"https://t.zsxq.com/0fZELdch7",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://t.zsxq.com/10Oc7MlOe",target:"_blank",rel:"noopener noreferrer"},I={href:"https://t.zsxq.com/10i1fQb5q",target:"_blank",rel:"noopener noreferrer"},K={href:"https://t.zsxq.com/14WTMsyv0",target:"_blank",rel:"noopener noreferrer"},U=h('<h2 id="一、开发日志" tabindex="-1"><a class="header-anchor" href="#一、开发日志" aria-hidden="true">#</a> 一、开发日志</h2><ul><li>9月22日，新增数据库路由组件开发工程 db-router-spring-boot-starter 这是一个自研的分库分表组件。主要用到的技术点包括：散列算法、数据源切换、AOP切面、SpringBoot Starter 开发等</li><li>9月22日，完善分库中表信息，user_take_activity、user_take_activity_count、user_strategy_export_001~004，用于测试验证数据库路由组件</li><li>9月30日，基于Mybatis拦截器对数据库路由分表使用方式进行优化，减少用户在使用过程中需要对数据库语句进行硬编码处理</li></ul><h2 id="二、需求分析" tabindex="-1"><a class="header-anchor" href="#二、需求分析" aria-hidden="true">#</a> 二、需求分析</h2><p><code>如果要做一个数据库路由，都需要做什么技术点？</code></p><p>首先我们要知道为什么要用分库分表，其实就是由于业务体量较大，数据增长较快，所以需要把用户数据拆分到不同的库表中去，减轻数据库压力。</p><p>分库分表操作主要有垂直拆分和水平拆分：</p><ul><li>垂直拆分：指按照业务将表进行分类，分布到不同的数据库上，这样也就将数据的压力分担到不同的库上面。最终一个数据库由很多表的构成，每个表对应着不同的业务，也就是专库专用。</li><li>水平拆分：如果垂直拆分后遇到单机瓶颈，可以使用水平拆分。相对于垂直拆分的区别是：垂直拆分是把不同的表拆到不同的数据库中，而水平拆分是把同一个表拆到不同的数据库中。如：user_001、user_002</li></ul><p>而本章节我们要实现的也是水平拆分的路由设计，如图 1-1</p>',8),G=e("p",null,"那么，这样的一个数据库路由设计要包括哪些技术知识点呢？",-1);function H(Y,W){const t=l("ExternalLinkIcon");return s(),a("div",null,[c,e("p",null,[r("作者：小傅哥 "),d,r("博客："),e("a",p,[r("https://bugstack.cn"),o(t)])]),u,e("ul",null,[e("li",null,[r("分支："),e("a",f,[r("210922_xfg_dbRouter"),o(t)])]),e("li",null,[r("组件："),e("a",b,[r("db-router-spring-boot-starter"),o(t)])]),g]),x,e("ul",null,[e("li",null,[e("a",m,[r("计算数据库位置的时候，用【int dbIdx = idx / dbRouterConfig.getTbCount() + 1】为什么是【dbRouterConfig.getTbCount()】标的数量呢？@拿笔小星"),o(t)])]),e("li",null,[e("a",k,[r("问题排查 Error creating bean with name 'db-router-point' @归斯"),o(t)])]),e("li",null,[e("a",q,[r("实现和使用分库分表 @一点江南"),o(t)])]),e("li",null,[e("a",z,[r("DB路由组件 @L、m"),o(t)])]),e("li",null,[e("a",y,[r("实现和使用分库分表 @BerserkD"),o(t)])]),e("li",null,[e("a",v,[r("实现和使用分库分表，开发自研数据库路由 @奥斯卡最佳配角"),o(t)])]),e("li",null,[e("a",V,[r("实现自定义路由组件，学会springboot组件开发 @杨杨得亿🙉"),o(t)])]),e("li",null,[e("a",B,[r("这章的目的是自定义路由实现分库分表 @Chin"),o(t)])]),e("li",null,[e("a",C,[r("数据路由组件的实现和引入组件实现分库分表 @Geroge Liu"),o(t)])]),e("li",null,[e("a",L,[r("实现和使用分库分表 @liuc"),o(t)])]),e("li",null,[e("a",N,[r("通过注解实现数据分散到不同库不同表的操作 @xbhog"),o(t)])]),e("li",null,[e("a",R,[r("领取整体流程(图一)和奖品领取信息的操作流程。@xbhog"),o(t)])]),e("li",null,[e("a",j,[r("分库分表路由组件开发细节流程梳理 @爱奋斗的小鲨鱼"),o(t)])]),e("li",null,[e("a",E,[r("DBRouter注解写好后，肯定要配备切面类DBRouterJoinPoint @SEN"),o(t)])]),e("li",null,[e("a",D,[r("因为一个用户表包含了几十甚至上百个字段，管理混乱所以需要分表，将该表拆分成多个表 @霍der～"),o(t)])]),e("li",null,[e("a",P,[r("分析分库分表实现原理分析 @布丁迪厄"),o(t)])]),e("li",null,[e("a",T,[r("主要对于分库分表路由组件进行了学习，跟着敲并尽力理解了所有的类与接口，理清楚它们之间的流程 @AD钙奶"),o(t)])]),e("li",null,[e("a",J,[r("动态数据源切换的原理 @圈"),o(t)])]),e("li",null,[e("a",M,[r("项目过程中遇到的bug以及经验总结 @锚"),o(t)])]),e("li",null,[e("a",Z,[r("在这一章节我们会学习到的技术：AOP、数据源切换、散列算法、哈希寻址、ThreadLocal @星期一"),o(t)])]),e("li",null,[e("a",w,[r("总结一下db-Router，不得不说。太牛了。尤其是Java反射。真的是刷新了认知。@陈晓川"),o(t)])]),e("li",null,[e("a",F,[r("路由组件执行流程分析 @twinkler"),o(t)])]),e("li",null,[e("a",S,[r("通过debug理清了路由组件的执行流程 @T"),o(t)])]),e("li",null,[e("a",A,[r("一个简单的路由组件的开发，将之前很多理论落实到了实际中，涉及面很广，但逻辑却不复杂，很是舒服。@错否"),o(t)])]),e("li",null,[e("a",O,[r("一张组件执行sql路由的流程图和组件里的bean实例化顺序图 @double"),o(t)])]),e("li",null,[e("a",Q,[r("dbRouter实现分库分表，现在跟着代码一套做下来，很少会有bug， 或者说有bug也能快速地解决。相比于刚开始，一个bug卡半天算是小小的进步啦。"),o(t)])]),e("li",null,[e("a",I,[r("扩展和完善数据库路由组件中编程式事务 @素质男孩"),o(t)])]),e("li",null,[e("a",K,[r("梳理了两天路由组件的运行流程和相关的知识，感觉提升很大，提升主要是在架构和基础知识上，其中设计了大量的反射知识和aop的理论 @1"),o(t)])])]),U,i(" ![图 1-1](/images/article/project/lottery/Part-2/10-01.png) "),G])}const $=n(_,[["render",H],["__file","di10jie：shixianheshiyongfenkufenbiao.html.vue"]]);export{$ as default};
